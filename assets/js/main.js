var Zepto=function(){function u(t){return null==t?String(t):U[W.call(t)]||"object"}function s(t){return"function"==u(t)}function o(t){return null!=t&&t==t.window}function a(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function r(t){return"object"==u(t)}function c(t){return r(t)&&!o(t)&&Object.getPrototypeOf(t)==Object.prototype}function h(t){return"number"==typeof t.length}function l(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function n(t){return t in e?e[t]:e[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function p(t,e){return"number"!=typeof e||T[l(t)]?e:e+"px"}function i(t){return"children"in t?S.call(t.children):b.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function f(t,e){return null==e?b(t):b(t).filter(e)}function d(t,e,n,r){return s(e)?e.call(t,n,r):e}function v(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function y(t,e){var n=t.className||"",r=n&&n.baseVal!==m;return e===m?r?n.baseVal:n:void(r?n.baseVal=e:t.className=e)}function g(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?b.parseJSON(e):e):e}catch(t){return e}}var m,E,b,C,_,N,w=[],S=w.slice,O=w.filter,P=window.document,I={},e={},T={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},A=/^\s*<(\w+|!)[^>]*>/,R=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,D=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,L=/^(?:body|html)$/i,M=/([A-Z])/g,k=["val","css","html","text","data","width","height","offset"],t=P.createElement("table"),F=P.createElement("tr"),x={tr:P.createElement("tbody"),tbody:t,thead:t,tfoot:t,td:F,th:F,"*":P.createElement("div")},j=/complete|loaded|interactive/,B=/^[\w-]*$/,U={},W=U.toString,V={},H=P.createElement("div"),q={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},K=Array.isArray||function(t){return t instanceof Array};return V.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var r,i=t.parentNode,o=!i;return o&&(i=H).appendChild(t),r=~V.qsa(i,e).indexOf(t),o&&H.removeChild(t),r},_=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},N=function(n){return O.call(n,function(t,e){return n.indexOf(t)==e})},V.fragment=function(t,e,n){var r,i,o;return R.test(t)&&(r=b(P.createElement(RegExp.$1))),r||(t.replace&&(t=t.replace(D,"<$1></$2>")),e===m&&(e=A.test(t)&&RegExp.$1),e in x||(e="*"),(o=x[e]).innerHTML=""+t,r=b.each(S.call(o.childNodes),function(){o.removeChild(this)})),c(n)&&(i=b(r),b.each(n,function(t,e){-1<k.indexOf(t)?i[t](e):i.attr(t,e)})),r},V.Z=function(t,e){return(t=t||[]).__proto__=b.fn,t.selector=e||"",t},V.isZ=function(t){return t instanceof V.Z},V.init=function(t,e){var n;if(!t)return V.Z();if("string"==typeof t)if("<"==(t=t.trim())[0]&&A.test(t))n=V.fragment(t,RegExp.$1,e),t=null;else{if(e!==m)return b(e).find(t);n=V.qsa(P,t)}else{if(s(t))return b(P).ready(t);if(V.isZ(t))return t;if(K(t))n=function(t){return O.call(t,function(t){return null!=t})}(t);else if(r(t))n=[t],t=null;else if(A.test(t))n=V.fragment(t.trim(),RegExp.$1,e),t=null;else{if(e!==m)return b(e).find(t);n=V.qsa(P,t)}}return V.Z(n,t)},(b=function(t,e){return V.init(t,e)}).extend=function(e){var n,t=S.call(arguments,1);return"boolean"==typeof e&&(n=e,e=t.shift()),t.forEach(function(t){!function t(e,n,r){for(E in n)r&&(c(n[E])||K(n[E]))?(c(n[E])&&!c(e[E])&&(e[E]={}),K(n[E])&&!K(e[E])&&(e[E]=[]),t(e[E],n[E],r)):n[E]!==m&&(e[E]=n[E])}(e,t,n)}),e},V.qsa=function(t,e){var n,r="#"==e[0],i=!r&&"."==e[0],o=r||i?e.slice(1):e,s=B.test(o);return a(t)&&s&&r?(n=t.getElementById(o))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:S.call(s&&!r?i?t.getElementsByClassName(o):t.getElementsByTagName(e):t.querySelectorAll(e))},b.contains=P.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},b.type=u,b.isFunction=s,b.isWindow=o,b.isArray=K,b.isPlainObject=c,b.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},b.inArray=function(t,e,n){return w.indexOf.call(e,t,n)},b.camelCase=_,b.trim=function(t){return null==t?"":String.prototype.trim.call(t)},b.uuid=0,b.support={},b.expr={},b.map=function(t,e){var n,r,i,o=[];if(h(t))for(r=0;r<t.length;r++)null!=(n=e(t[r],r))&&o.push(n);else for(i in t)null!=(n=e(t[i],i))&&o.push(n);return function(t){return 0<t.length?b.fn.concat.apply([],t):t}(o)},b.each=function(t,e){var n,r;if(h(t)){for(n=0;n<t.length;n++)if(!1===e.call(t[n],n,t[n]))return t}else for(r in t)if(!1===e.call(t[r],r,t[r]))return t;return t},b.grep=function(t,e){return O.call(t,e)},window.JSON&&(b.parseJSON=JSON.parse),b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){U["[object "+e+"]"]=e.toLowerCase()}),b.fn={forEach:w.forEach,reduce:w.reduce,push:w.push,sort:w.sort,indexOf:w.indexOf,concat:w.concat,map:function(n){return b(b.map(this,function(t,e){return n.call(t,e,t)}))},slice:function(){return b(S.apply(this,arguments))},ready:function(t){return j.test(P.readyState)&&P.body?t(b):P.addEventListener("DOMContentLoaded",function(){t(b)},!1),this},get:function(t){return t===m?S.call(this):this[0<=t?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(n){return w.every.call(this,function(t,e){return!1!==n.call(t,e,t)}),this},filter:function(e){return s(e)?this.not(this.not(e)):b(O.call(this,function(t){return V.matches(t,e)}))},add:function(t,e){return b(N(this.concat(b(t,e))))},is:function(t){return 0<this.length&&V.matches(this[0],t)},not:function(e){var n=[];if(s(e)&&e.call!==m)this.each(function(t){e.call(this,t)||n.push(this)});else{var r="string"==typeof e?this.filter(e):h(e)&&s(e.item)?S.call(e):b(e);this.forEach(function(t){r.indexOf(t)<0&&n.push(t)})}return b(n)},has:function(t){return this.filter(function(){return r(t)?b.contains(this,t):b(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!r(t)?t:b(t)},last:function(){var t=this[this.length-1];return t&&!r(t)?t:b(t)},find:function(t){var n=this;return t?"object"==typeof t?b(t).filter(function(){var e=this;return w.some.call(n,function(t){return b.contains(t,e)})}):1==this.length?b(V.qsa(this[0],t)):this.map(function(){return V.qsa(this,t)}):b()},closest:function(t,e){var n=this[0],r=!1;for("object"==typeof t&&(r=b(t));n&&!(r?0<=r.indexOf(n):V.matches(n,t));)n=n!==e&&!a(n)&&n.parentNode;return b(n)},parents:function(t){for(var e=[],n=this;0<n.length;)n=b.map(n,function(t){return(t=t.parentNode)&&!a(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return f(e,t)},parent:function(t){return f(N(this.pluck("parentNode")),t)},children:function(t){return f(this.map(function(){return i(this)}),t)},contents:function(){return this.map(function(){return S.call(this.childNodes)})},siblings:function(t){return f(this.map(function(t,e){return O.call(i(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return b.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=function(t){var e,n;return I[t]||(e=P.createElement(t),P.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),I[t]=n),I[t]}(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(e){var n=s(e);if(this[0]&&!n)var r=b(e).get(0),i=r.parentNode||1<this.length;return this.each(function(t){b(this).wrapAll(n?e.call(this,t):i?r.cloneNode(!0):r)})},wrapAll:function(t){if(this[0]){b(this[0]).before(t=b(t));for(var e;(e=t.children()).length;)t=e.first();b(t).append(this)}return this},wrapInner:function(i){var o=s(i);return this.each(function(t){var e=b(this),n=e.contents(),r=o?i.call(this,t):i;n.length?n.wrapAll(r):e.append(r)})},unwrap:function(){return this.parent().each(function(){b(this).replaceWith(b(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=b(this);(e===m?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(t){return b(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return b(this.pluck("nextElementSibling")).filter(t||"*")},html:function(n){return 0 in arguments?this.each(function(t){var e=this.innerHTML;b(this).empty().append(d(this,n,t,e))}):0 in this?this[0].innerHTML:null},text:function(n){return 0 in arguments?this.each(function(t){var e=d(this,n,t,this.textContent);this.textContent=null==e?"":""+e}):0 in this?this[0].textContent:null},attr:function(e,n){var t;return"string"!=typeof e||1 in arguments?this.each(function(t){if(1===this.nodeType)if(r(e))for(E in e)v(this,E,e[E]);else v(this,e,d(this,n,t,this.getAttribute(e)))}):this.length&&1===this[0].nodeType?!(t=this[0].getAttribute(e))&&e in this[0]?this[0][e]:t:m},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){v(this,t)},this)})},prop:function(e,n){return e=q[e]||e,1 in arguments?this.each(function(t){this[e]=d(this,n,t,this[e])}):this[0]&&this[0][e]},data:function(t,e){var n="data-"+t.replace(M,"-$1").toLowerCase(),r=1 in arguments?this.attr(n,e):this.attr(n);return null!==r?g(r):m},val:function(e){return 0 in arguments?this.each(function(t){this.value=d(this,e,t,this.value)}):this[0]&&(this[0].multiple?b(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(o){if(o)return this.each(function(t){var e=b(this),n=d(this,o,t,e.offset()),r=e.offsetParent().offset(),i={top:n.top-r.top,left:n.left-r.left};"static"==e.css("position")&&(i.position="relative"),e.css(i)});if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,e){if(arguments.length<2){var n,r=this[0];if(!r)return;if(n=getComputedStyle(r,""),"string"==typeof t)return r.style[_(t)]||n.getPropertyValue(t);if(K(t)){var i={};return b.each(t,function(t,e){i[e]=r.style[_(e)]||n.getPropertyValue(e)}),i}}var o="";if("string"==u(t))e||0===e?o=l(t)+":"+p(t,e):this.each(function(){this.style.removeProperty(l(t))});else for(E in t)t[E]||0===t[E]?o+=l(E)+":"+p(E,t[E])+";":this.each(function(){this.style.removeProperty(l(E))});return this.each(function(){this.style.cssText+=";"+o})},index:function(t){return t?this.indexOf(b(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&w.some.call(this,function(t){return this.test(y(t))},n(t))},addClass:function(n){return n?this.each(function(t){if("className"in this){C=[];var e=y(this);d(this,n,t,e).split(/\s+/g).forEach(function(t){b(this).hasClass(t)||C.push(t)},this),C.length&&y(this,e+(e?" ":"")+C.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===m)return y(this,"");C=y(this),d(this,e,t,C).split(/\s+/g).forEach(function(t){C=C.replace(n(t)," ")}),y(this,C.trim())}})},toggleClass:function(n,r){return n?this.each(function(t){var e=b(this);d(this,n,t,y(this)).split(/\s+/g).forEach(function(t){(r===m?!e.hasClass(t):r)?e.addClass(t):e.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===m?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===m?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),r=L.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(b(t).css("margin-top"))||0,n.left-=parseFloat(b(t).css("margin-left"))||0,r.top+=parseFloat(b(e[0]).css("border-top-width"))||0,r.left+=parseFloat(b(e[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||P.body;t&&!L.test(t.nodeName)&&"static"==b(t).css("position");)t=t.offsetParent;return t})}},b.fn.detach=b.fn.remove,["width","height"].forEach(function(r){var i=r.replace(/./,function(t){return t[0].toUpperCase()});b.fn[r]=function(e){var t,n=this[0];return e===m?o(n)?n["inner"+i]:a(n)?n.documentElement["scroll"+i]:(t=this.offset())&&t[r]:this.each(function(t){(n=b(this)).css(r,d(this,e,t,n[r]()))})}}),["after","prepend","before","append"].forEach(function(e,s){var a=s%2;b.fn[e]=function(){var e,r,i=b.map(arguments,function(t){return"object"==(e=u(t))||"array"==e||null==t?t:V.fragment(t)}),o=1<this.length;return i.length<1?this:this.each(function(t,e){r=a?e:e.parentNode,e=0==s?e.nextSibling:1==s?e.firstChild:2==s?e:null;var n=b.contains(P.documentElement,r);i.forEach(function(t){if(o)t=t.cloneNode(!0);else if(!r)return b(t).remove();r.insertBefore(t,e),n&&function t(e,n){n(e);for(var r=0,i=e.childNodes.length;r<i;r++)t(e.childNodes[r],n)}(t,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},b.fn[a?e+"To":"insert"+(s?"Before":"After")]=function(t){return b(t)[e](this),this}}),V.Z.prototype=b.fn,V.uniq=N,V.deserializeValue=g,b.zepto=V,b}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(h){function l(t){return t._zid||(t._zid=e++)}function s(t,e,n,r){if((e=p(e)).ns)var i=function(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}(e.ns);return(_[l(t)]||[]).filter(function(t){return!(!t||e.e&&t.e!=e.e||e.ns&&!i.test(t.ns)||n&&l(t.fn)!==l(n)||r&&t.sel!=r)})}function p(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function f(t,e){return t.del&&!n&&t.e in r||!!e}function d(t){return N[t]||n&&r[t]||t}function c(i,t,e,o,s,a,u){var n=l(i),c=_[n]||(_[n]=[]);t.split(/\s/).forEach(function(t){if("ready"==t)return h(document).ready(e);var n=p(t);n.fn=e,n.sel=s,n.e in N&&(e=function(t){var e=t.relatedTarget;return!e||e!==this&&!h.contains(this,e)?n.fn.apply(this,arguments):void 0});var r=(n.del=a)||e;n.proxy=function(t){if(!(t=y(t)).isImmediatePropagationStopped()){t.data=o;var e=r.apply(i,t._args==m?[t]:[t].concat(t._args));return!1===e&&(t.preventDefault(),t.stopPropagation()),e}},n.i=c.length,c.push(n),"addEventListener"in i&&i.addEventListener(d(n.e),n.proxy,f(n,u))})}function v(e,t,n,r,i){var o=l(e);(t||"").split(/\s/).forEach(function(t){s(e,t,n,r).forEach(function(t){delete _[o][t.i],"removeEventListener"in e&&e.removeEventListener(d(t.e),t.proxy,f(t,i))})})}function y(r,i){return(i||!r.isDefaultPrevented)&&(i||(i=r),h.each(t,function(t,e){var n=i[t];r[t]=function(){return this[e]=a,n&&n.apply(i,arguments)},r[e]=w}),(i.defaultPrevented!==m?i.defaultPrevented:"returnValue"in i?!1===i.returnValue:i.getPreventDefault&&i.getPreventDefault())&&(r.isDefaultPrevented=a)),r}function g(t){var e,n={originalEvent:t};for(e in t)i.test(e)||t[e]===m||(n[e]=t[e]);return y(n,t)}var m,e=1,E=Array.prototype.slice,b=h.isFunction,C=function(t){return"string"==typeof t},_={},o={},n="onfocusin"in window,r={focus:"focusin",blur:"focusout"},N={mouseenter:"mouseover",mouseleave:"mouseout"};o.click=o.mousedown=o.mouseup=o.mousemove="MouseEvents",h.event={add:c,remove:v},h.proxy=function(t,e){var n=2 in arguments&&E.call(arguments,2);if(b(t)){var r=function(){return t.apply(e,n?n.concat(E.call(arguments)):arguments)};return r._zid=l(t),r}if(C(e))return n?(n.unshift(t[e],t),h.proxy.apply(null,n)):h.proxy(t[e],t);throw new TypeError("expected function")},h.fn.bind=function(t,e,n){return this.on(t,e,n)},h.fn.unbind=function(t,e){return this.off(t,e)},h.fn.one=function(t,e,n,r){return this.on(t,e,n,r,1)};var a=function(){return!0},w=function(){return!1},i=/^([A-Z]|returnValue$|layer[XY]$)/,t={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};h.fn.delegate=function(t,e,n){return this.on(e,t,n)},h.fn.undelegate=function(t,e,n){return this.off(e,t,n)},h.fn.live=function(t,e){return h(document.body).delegate(this.selector,t,e),this},h.fn.die=function(t,e){return h(document.body).undelegate(this.selector,t,e),this},h.fn.on=function(e,i,n,o,s){var a,u,r=this;return e&&!C(e)?(h.each(e,function(t,e){r.on(t,i,n,e,s)}),r):(C(i)||b(o)||!1===o||(o=n,n=i,i=m),(b(n)||!1===n)&&(o=n,n=m),!1===o&&(o=w),r.each(function(t,r){s&&(a=function(t){return v(r,t.type,o),o.apply(this,arguments)}),i&&(u=function(t){var e,n=h(t.target).closest(i,r).get(0);return n&&n!==r?(e=h.extend(g(t),{currentTarget:n,liveFired:r}),(a||o).apply(n,[e].concat(E.call(arguments,1)))):void 0}),c(r,e,o,n,i,u||a)}))},h.fn.off=function(t,n,e){var r=this;return t&&!C(t)?(h.each(t,function(t,e){r.off(t,n,e)}),r):(C(n)||b(e)||!1===e||(e=n,n=m),!1===e&&(e=w),r.each(function(){v(this,t,e,n)}))},h.fn.trigger=function(t,e){return(t=C(t)||h.isPlainObject(t)?h.Event(t):y(t))._args=e,this.each(function(){t.type in r&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):h(this).triggerHandler(t,e)})},h.fn.triggerHandler=function(n,r){var i,o;return this.each(function(t,e){(i=g(C(n)?h.Event(n):n))._args=r,i.target=e,h.each(s(e,n.type||n),function(t,e){return o=e.proxy(i),!i.isImmediatePropagationStopped()&&void 0})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){h.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),h.Event=function(t,e){C(t)||(t=(e=t).type);var n=document.createEvent(o[t]||"Events"),r=!0;if(e)for(var i in e)"bubbles"==i?r=!!e[i]:n[i]=e[i];return n.initEvent(t,r,!0),y(n)}}(Zepto),function(dh){function fh(t,e,n,r){return t.global?function(t,e,n){var r=dh.Event(e);return dh(t).trigger(r,n),!r.isDefaultPrevented()}(e||vh,n,r):void 0}function ih(t,e){var n=e.context;return!1!==e.beforeSend.call(n,t,e)&&!1!==fh(e,n,"ajaxBeforeSend",[t,e])&&void fh(e,n,"ajaxSend",[t,e])}function jh(t,e,n,r){var i=n.context,o="success";n.success.call(i,t,o,e),r&&r.resolveWith(i,[t,o,e]),fh(n,i,"ajaxSuccess",[e,n,t]),lh(o,e,n)}function kh(t,e,n,r,i){var o=r.context;r.error.call(o,n,e,t),i&&i.rejectWith(o,[n,e,t]),fh(r,o,"ajaxError",[n,r,t||e]),lh(e,n,r)}function lh(t,e,n){var r=n.context;n.complete.call(r,e,t),fh(n,r,"ajaxComplete",[e,n]),function(t){t.global&&!--dh.active&&fh(t,null,"ajaxStop")}(n)}function mh(){}function oh(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function qh(t,e,n,r){return dh.isFunction(e)&&(r=n,n=e,e=void 0),dh.isFunction(n)||(r=n,n=void 0),{url:t,data:e,success:n,dataType:r}}var sh,th,uh=0,vh=window.document,wh=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,xh=/^(?:text|application)\/javascript/i,yh=/^(?:text|application)\/xml/i,zh="application/json",Ah="text/html",Bh=/^\s*$/,Ch=vh.createElement("a");Ch.href=window.location.href,dh.active=0,dh.ajaxJSONP=function(n,r){if(!("type"in n))return dh.ajax(n);var i,o,t=n.jsonpCallback,s=(dh.isFunction(t)?t():t)||"jsonp"+ ++uh,a=vh.createElement("script"),u=window[s],e=function(t){dh(a).triggerHandler("error",t||"abort")},c={abort:e};return r&&r.promise(c),dh(a).on("load error",function(t,e){clearTimeout(o),dh(a).off().remove(),"error"!=t.type&&i?jh(i[0],c,n,r):kh(null,e||"error",c,n,r),window[s]=u,i&&dh.isFunction(u)&&u(i[0]),u=i=void 0}),!1===ih(c,n)?e("abort"):(window[s]=function(){i=arguments},a.src=n.url.replace(/\?(.+)=\?/,"?$1="+s),vh.head.appendChild(a),0<n.timeout&&(o=setTimeout(function(){e("timeout")},n.timeout))),c},dh.ajaxSettings={type:"GET",beforeSend:mh,success:mh,error:mh,complete:mh,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:zh,xml:"application/xml, text/xml",html:Ah,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},dh.ajax=function(Ji){var Ki,Li=dh.extend({},Ji||{}),Mi=dh.Deferred&&dh.Deferred();for(sh in dh.ajaxSettings)void 0===Li[sh]&&(Li[sh]=dh.ajaxSettings[sh]);(function(t){t.global&&0==dh.active++&&fh(t,null,"ajaxStart")})(Li),Li.crossDomain||((Ki=vh.createElement("a")).href=Li.url,Ki.href=Ki.href,Li.crossDomain=Ch.protocol+"//"+Ch.host!=Ki.protocol+"//"+Ki.host),Li.url||(Li.url=window.location.toString()),function(t){t.processData&&t.data&&"string"!=dh.type(t.data)&&(t.data=dh.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=oh(t.url,t.data),t.data=void 0)}(Li);var Ni=Li.dataType,Oi=/\?.+=\?/.test(Li.url);if(Oi&&(Ni="jsonp"),!1!==Li.cache&&(Ji&&!0===Ji.cache||"script"!=Ni&&"jsonp"!=Ni)||(Li.url=oh(Li.url,"_="+Date.now())),"jsonp"==Ni)return Oi||(Li.url=oh(Li.url,Li.jsonp?Li.jsonp+"=?":!1===Li.jsonp?"":"callback=?")),dh.ajaxJSONP(Li,Mi);var Pi,Qi=Li.accepts[Ni],Ri={},Si=function(t,e){Ri[t.toLowerCase()]=[t,e]},Ti=/^([\w-]+:)\/\//.test(Li.url)?RegExp.$1:window.location.protocol,Ui=Li.xhr(),Vi=Ui.setRequestHeader;if(Mi&&Mi.promise(Ui),Li.crossDomain||Si("X-Requested-With","XMLHttpRequest"),Si("Accept",Qi||"*/*"),(Qi=Li.mimeType||Qi)&&(-1<Qi.indexOf(",")&&(Qi=Qi.split(",",2)[0]),Ui.overrideMimeType&&Ui.overrideMimeType(Qi)),(Li.contentType||!1!==Li.contentType&&Li.data&&"GET"!=Li.type.toUpperCase())&&Si("Content-Type",Li.contentType||"application/x-www-form-urlencoded"),Li.headers)for(th in Li.headers)Si(th,Li.headers[th]);if(Ui.setRequestHeader=Si,!(Ui.onreadystatechange=function(){if(4==Ui.readyState){Ui.onreadystatechange=mh,clearTimeout(Pi);var Zi,$i=!1;if(200<=Ui.status&&Ui.status<300||304==Ui.status||0==Ui.status&&"file:"==Ti){Ni=Ni||function(t){return t&&(t=t.split(";",2)[0]),t&&(t==Ah?"html":t==zh?"json":xh.test(t)?"script":yh.test(t)&&"xml")||"text"}(Li.mimeType||Ui.getResponseHeader("content-type")),Zi=Ui.responseText;try{"script"==Ni?eval(Zi):"xml"==Ni?Zi=Ui.responseXML:"json"==Ni&&(Zi=Bh.test(Zi)?null:dh.parseJSON(Zi))}catch(t){$i=t}$i?kh($i,"parsererror",Ui,Li,Mi):jh(Zi,Ui,Li,Mi)}else kh(Ui.statusText||null,Ui.status?"error":"abort",Ui,Li,Mi)}})===ih(Ui,Li))return Ui.abort(),kh(null,"abort",Ui,Li,Mi),Ui;if(Li.xhrFields)for(th in Li.xhrFields)Ui[th]=Li.xhrFields[th];var Wi=!("async"in Li)||Li.async;for(th in Ui.open(Li.type,Li.url,Wi,Li.username,Li.password),Ri)Vi.apply(Ui,Ri[th]);return 0<Li.timeout&&(Pi=setTimeout(function(){Ui.onreadystatechange=mh,Ui.abort(),kh(null,"timeout",Ui,Li,Mi)},Li.timeout)),Ui.send(Li.data?Li.data:null),Ui},dh.get=function(){return dh.ajax(qh.apply(null,arguments))},dh.post=function(){var t=qh.apply(null,arguments);return t.type="POST",dh.ajax(t)},dh.getJSON=function(){var t=qh.apply(null,arguments);return t.dataType="json",dh.ajax(t)},dh.fn.load=function(t,e,n){if(!this.length)return this;var r,i=this,o=t.split(/\s/),s=qh(t,e,n),a=s.success;return 1<o.length&&(s.url=o[0],r=o[1]),s.success=function(t){i.html(r?dh("<div>").html(t.replace(wh,"")).find(r):t),a&&a.apply(i,arguments)},dh.ajax(s),this};var Dh=encodeURIComponent;dh.param=function(t,e){var n=[];return n.add=function(t,e){dh.isFunction(e)&&(e=e()),null==e&&(e=""),this.push(Dh(t)+"="+Dh(e))},function n(r,t,i,o){var s,a=dh.isArray(t),u=dh.isPlainObject(t);dh.each(t,function(t,e){s=dh.type(e),o&&(t=i?o:o+"["+(u||"object"==s||"array"==s?t:"")+"]"),!o&&a?r.add(e.name,e.value):"array"==s||!i&&"object"==s?n(r,e,i,t):r.add(t,e)})}(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(o){o.fn.serializeArray=function(){var n,r,e=[],i=function(t){return t.forEach?t.forEach(i):void e.push({name:n,value:t})};return this[0]&&o.each(this[0].elements,function(t,e){r=e.type,(n=e.name)&&"fieldset"!=e.nodeName.toLowerCase()&&!e.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&"file"!=r&&("radio"!=r&&"checkbox"!=r||e.checked)&&i(o(e).val())}),e},o.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},o.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var e=o.Event("submit");this.eq(0).trigger(e),e.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(n){"__proto__"in{}||n.extend(n.zepto,{Z:function(t,e){return t=t||[],n.extend(t,n.fn),t.selector=e||"",t.__Z=!0,t},isZ:function(t){return"array"===n.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(t){var e=getComputedStyle;window.getComputedStyle=function(t){try{return e(t)}catch(t){return null}}}}(Zepto),function(t){"use strict";function n(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}var r,i,o;function e(t,e){(r(t,e)?o:i)(t,e)}o="classList"in document.documentElement?(r=function(t,e){return t.classList.contains(e)},i=function(t,e){t.classList.add(e)},function(t,e){t.classList.remove(e)}):(r=function(t,e){return n(e).test(t.className)},i=function(t,e){r(t,e)||(t.className=t.className+" "+e)},function(t,e){t.className=t.className.replace(n(e)," ")});var s={hasClass:r,addClass:i,removeClass:o,toggleClass:e,has:r,add:i,remove:o,toggle:e};"function"==typeof define&&define.amd?define(s):t.classie=s}(window);var firebase=function(){var fk=void 0===fk?self:fk;return function(u){function c(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return u[t].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var h=fk.webpackJsonpFirebase;fk.webpackJsonpFirebase=function(t,e,n){for(var r,i,o,s=0,a=[];s<t.length;s++)i=t[s],l[i]&&a.push(l[i][0]),l[i]=0;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(u[r]=e[r]);for(h&&h(t,e,n);a.length;)a.shift()();if(n)for(s=0;s<n.length;s++)o=c(c.s=n[s]);return o};var n={},l={5:0};return c.e=function(n){function t(){o.onerror=o.onload=null,clearTimeout(s);var t=l[n];0!==t&&(t&&t[1](Error("Loading chunk "+n+" failed.")),l[n]=void 0)}var r=l[n];if(0===r)return new Promise(function(t){t()});if(r)return r[2];var e=new Promise(function(t,e){r=l[n]=[t,e]});r[2]=e;var i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.charset="utf-8",o.async=!0,o.timeout=12e4,c.nc&&o.setAttribute("nonce",c.nc),o.src=c.p+""+n+".js";var s=setTimeout(t,12e4);return o.onerror=o.onload=t,i.appendChild(o),e},c.m=u,c.c=n,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},c.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t},c(c.s=57)}([function(t,n,e){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),r(e(28)),r(e(29)),r(e(20)),r(e(65)),r(e(66)),r(e(67)),r(e(68)),r(e(30)),r(e(69)),r(e(31)),r(e(70)),r(e(71)),r(e(73)),r(e(74)),r(e(75))},,,,,,function(t,e,n){"use strict";function l(t,e){throw i.create(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var p=n(0),f=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},d="[DEFAULT]",r=[],v=function(){function t(t,e,n){this.r=n,this.a=!1,this.u={},this.f=e,this.h=Object(p.deepCopy)(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){r.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(e){r=r.filter(function(t){return t!==e})}}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.v(),this.f},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.v(),this.h},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var r=this;return new Promise(function(t){r.v(),t()}).then(function(){r.r.INTERNAL.removeApp(r.f);var n=[];return Object.keys(r.u).forEach(function(e){Object.keys(r.u[e]).forEach(function(t){n.push(r.u[e][t])})}),Promise.all(n.map(function(t){return t.INTERNAL.delete()}))}).then(function(){r.a=!0,r.u={}})},t.prototype.t=function(t,e){if(void 0===e&&(e=d),this.v(),this.u[t]||(this.u[t]={}),!this.u[t][e]){var n=e!==d?e:void 0,r=this.r.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.u[t][e]=r}return this.u[t][e]},t.prototype.extendApp=function(t){var e=this;Object(p.deepExtend)(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(r.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),r=[])},t.prototype.v=function(){this.a&&l("app-deleted",{name:this.f})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var i=new p.ErrorFactory("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."});n.d(e,"firebase",function(){return o});var o=function t(){function s(t){return f(o,t=t||d)||l("no-app",{name:t}),o[t]}function a(){return Object.keys(o).map(function(t){return o[t]})}function r(n,r){Object.keys(u).forEach(function(t){var e=i(n,t);null!==e&&c[e]&&c[e](r,n)})}function i(t,e){if("serverAuth"===e)return null;var n=e;return t.options,n}var o={},u={},c={},h={__esModule:!0,initializeApp:function(t,e){void 0===e?e=d:"string"==typeof e&&""!==e||l("bad-app-name",{name:e+""}),f(o,e)&&l("duplicate-app",{name:e});var n=new v(t,e,h);return r(o[e]=n,"create"),n},app:s,apps:null,Promise:Promise,SDK_VERSION:"4.8.1",INTERNAL:{registerService:function(n,t,e,r,i){u[n]&&l("duplicate-service",{name:n}),u[n]=t,r&&(c[n]=r,a().forEach(function(t){r("create",t)}));var o=function(t){return void 0===t&&(t=s()),"function"!=typeof t[n]&&l("invalid-app-argument",{name:n}),t[n]()};return void 0!==e&&Object(p.deepExtend)(o,e),h[n]=o,v.prototype[n]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.t.bind(this,n).apply(this,i?t:[])},o},createFirebaseNamespace:t,extendNamespace:function(t){Object(p.deepExtend)(h,t)},createSubscribe:p.createSubscribe,ErrorFactory:p.ErrorFactory,removeApp:function(t){r(o[t],"delete"),delete o[t]},factories:u,useAsService:i,Promise:Promise,deepExtend:p.deepExtend}};return Object(p.patchProperty)(h,"default",h),Object.defineProperty(h,"apps",{get:a}),Object(p.patchProperty)(s,"App",v),h}();e.default=o},,,,,,function(lm,mm){var nm;nm=function(){return this}();try{nm=nm||Function("return this")()||eval("this")}catch(lm){"object"==typeof fk&&(nm=fk)}lm.exports=nm},,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"}},,,,,,,function(t,e){function n(){throw Error("setTimeout has not been defined")}function r(){throw Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(){d&&p&&(d=!1,p.length?f=p.concat(f):v=-1,f.length&&s())}function s(){if(!d){var t=i(o);d=!0;for(var e=f.length;e;){for(p=f,f=[];++v<e;)p&&p[v].run();v=-1,e=f.length}p=null,d=!1,function(e){if(h===clearTimeout)return clearTimeout(e);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function u(){}var c,h,l=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var p,f=[],d=!1,v=-1;l.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new a(t,e)),1!==f.length||d||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.prependListener=u,l.prependOnceListener=u,l.listeners=function(t){return[]},l.binding=function(t){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(20);n.assert=function(t,e){if(!t)throw n.assertionError(e)},n.assertionError=function(t){return Error("Firebase Database ("+r.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e};n.base64={y:null,b:null,_:null,g:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.O();for(var n=e?this._:this.y,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,p=(15&a)<<2|c>>6,f=63&c;u||(f=64,s||(p=64)),r.push(n[h],n[l],n[p],n[f])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(191<i&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.O();for(var n=e?this.g:this.b,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!=a){var h=s<<4&240|a>>2;if(r.push(h),64!=u){var l=a<<6&192|u;r.push(l)}}}return r},O:function(){if(!this.y){this.y={},this.b={},this._={},this.g={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.y[t]=this.ENCODED_VALS.charAt(t),this.b[this.y[t]]=t,this._[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),(this.g[this._[t]]=t)>=this.ENCODED_VALS_BASE.length&&(this.b[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.g[this.ENCODED_VALS.charAt(t)]=t)}}},n.base64Encode=function(t){var e=r(t);return n.base64.encodeByteArray(e,!0)},n.base64Decode=function(t){try{return n.base64.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.jsonEval=function(t){return JSON.parse(t)},e.stringify=function(t){return JSON.stringify(t)}},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},i.forEach=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},i.extend=function(n,t){return i.forEach(t,function(t,e){n[t]=e}),n},i.clone=function(t){return i.extend({},t)},i.isNonNullObject=function(t){return"object"==typeof t&&null!==t},i.isEmpty=function(t){for(var e in t)return!1;return!0},i.getCount=function(t){var e=0;for(var n in t)e++;return e},i.map=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},i.findKey=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},i.findValue=function(t,e,n){var r=i.findKey(t,e,n);return r&&t[r]},i.getAnyKey=function(t){for(var e in t)return e},i.getValues=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},i.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){n(58),t.exports=n(6).default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(59),i=(n.n(r),n(63)),o=(n.n(i),n(64));n.n(o)},function(t,e,n){(function(t){var e=function(){if(void 0!==t)return t;if(void 0!==fk)return fk;if("undefined"!=typeof self)return self;throw Error("unable to locate global object")}();"undefined"==typeof Promise&&(e.Promise=Promise=n(60))}).call(e,n(12))},function(l,t,e){(function(n){!function(t){function r(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this.T=[],h(t,this)}function i(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o.A(function(){var t=1===n._state?r.onFulfilled:r.onRejected;if(null!==t){var e;try{e=t(n._value)}catch(t){return void a(r.promise,t)}s(r.promise,e)}else(1===n._state?s:a)(r.promise,n._value)})):n.T.push(r)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void h(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,u(t)}catch(e){a(t,e)}}function a(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t.T.length&&o.A(function(){t._handled||o.j(t._value)});for(var e=0,n=t.T.length;e<n;e++)i(t,t.T[e]);t.T=null}function c(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function h(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}var e=setTimeout;o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return i(this,new c(t,e,n)),n},o.all=function(t){var a=Array.prototype.slice.call(t);return new o(function(r,i){function o(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void n.call(t,function(t){o(e,t)},i)}a[e]=t,0==--s&&r(a)}catch(t){i(t)}}if(0===a.length)return r([]);for(var s=a.length,t=0;t<a.length;t++)o(t,a[t])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(n){return new o(function(t,e){e(n)})},o.race=function(i){return new o(function(t,e){for(var n=0,r=i.length;n<r;n++)i[n].then(t,e)})},o.A="function"==typeof n&&function(t){n(t)}||function(t){e(t,0)},o.j=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o.S=function(t){o.A=t},o.w=function(t){o.j=t},void 0!==l&&l.exports?l.exports=o:t.Promise||(t.Promise=o)}(this)}).call(t,e(61).setImmediate)},function(t,e,n){function r(t,e){this.P=t,this._clearFn=e}var i=Function.prototype.apply;e.setTimeout=function(){return new r(i.call(setTimeout,fk,arguments),clearTimeout)},e.setInterval=function(){return new r(i.call(setInterval,fk,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(fk,this.P)},e.enroll=function(t,e){clearTimeout(t.N),t.C=e},e.unenroll=function(t){clearTimeout(t.N),t.C=-1},e.k=e.active=function(t){clearTimeout(t.N);var e=t.C;0<=e&&(t.N=setTimeout(function(){t.M&&t.M()},e))},n(62),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){(function(t,d){!function(n,r){"use strict";function i(t){delete u[t]}function o(t){if(c)setTimeout(o,0,t);else{var e=u[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(r,n)}}(e)}finally{i(t),c=!1}}}}if(!n.setImmediate){var s,a=1,u={},c=!1,h=n.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(n);t=t&&t.setTimeout?t:n,"[object process]"==={}.toString.call(n.process)?s=function(t){d.nextTick(function(){o(t)})}:function(){if(n.postMessage&&!n.importScripts){var t=!0,e=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=e,t}}()?(p="setImmediate$"+Math.random()+"$",f=function(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(p)&&o(+t.data.slice(p.length))},n.addEventListener?n.addEventListener("message",f,!1):n.attachEvent("onmessage",f),s=function(t){n.postMessage(p+t,"*")}):n.MessageChannel?((e=new MessageChannel).port1.onmessage=function(t){o(t.data)},s=function(t){e.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(l=h.documentElement,s=function(t){var e=h.createElement("script");e.onreadystatechange=function(){o(t),e.onreadystatechange=null,l.removeChild(e),e=null},l.appendChild(e)}):s=function(t){setTimeout(o,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=Function(""+t));for(var e=Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return u[a]=r,s(a),a++},t.clearImmediate=i}var l,e,p,f}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(12),n(27))},function(t,e){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return o;i++}}})},function(t,e){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return i;i++}return-1}})},function(t,e,n){"use strict";function r(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=r(t[n],e[n]));return t}Object.defineProperty(e,"__esModule",{value:!0}),e.deepCopy=function(t){return r(void 0,t)},e.deepExtend=r,e.patchProperty=function(t,e,n){t[e]=n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}return t.prototype.wrapCallback=function(n){var r=this;return function(t,e){t?r.reject(t):r.resolve(e),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(t):n(t,e))}},t}();e.Deferred=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(20);e.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},e.isMobileCordova=function(){return void 0!==fk&&!!(fk.cordova||fk.phonegap||fk.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(e.getUA())},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isNodeSdk=function(){return!0===r.CONSTANTS.NODE_CLIENT||!0===r.CONSTANTS.NODE_ADMIN}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="FirebaseError",i=Error.captureStackTrace;e.patchCapture=function(t){var e=i;return i=t,e};var a=function(t,e){if(this.code=t,this.message=e,i)i(this,o.prototype.create);else{var n=Error.apply(this,arguments);this.name=r,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}};(e.FirebaseError=a).prototype=Object.create(Error.prototype),(a.prototype.constructor=a).prototype.name=r;var o=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,r){void 0===r&&(r={});var e,n=this.errors[t],i=this.service+"/"+t;e=void 0===n?"Error":n.replace(this.pattern,function(t,e){var n=r[e];return void 0!==n?""+n:"<"+e+"?>"}),e=this.serviceName+": "+e+" ("+i+").";var o=new a(i,e);for(var s in r)r.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(o[s]=r[s]);return o},t}();e.ErrorFactory=o},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=e(29),a=e(30);o.decode=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=a.jsonEval(s.base64Decode(o[0])||""),n=a.jsonEval(s.base64Decode(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},o.isValidTimestamp=function(t){var e,n,r=o.decode(t).claims,i=Math.floor((new Date).getTime()/1e3);return"object"==typeof r&&(r.hasOwnProperty("nbf")?e=r.nbf:r.hasOwnProperty("iat")&&(e=r.iat),n=r.hasOwnProperty("exp")?r.exp:e+86400),i&&e&&n&&e<=i&&i<=n},o.issuedAtTime=function(t){var e=o.decode(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},o.isValidFormat=function(t){var e=o.decode(t),n=e.claims;return!!e.signature&&!!n&&"object"==typeof n&&n.hasOwnProperty("iat")},o.isAdmin=function(t){var e=o.decode(t).claims;return"object"==typeof e&&!0===e.admin}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(31);e.querystring=function(t){var n=[];return r.forEach(t,function(e,t){Array.isArray(t)?t.forEach(function(t){n.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):n.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}),n.length?"&"+n.join("&"):""},e.querystringDecode=function(t){var n={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var e=t.split("=");n[e[0]]=e[1]}}),n}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(n){function t(){var t=n.call(this)||this;t.D=[],t.I=[],t.x=[],t.F=[],t.L=0,t.R=0,t.blockSize=64,t.F[0]=128;for(var e=1;e<t.blockSize;++e)t.F[e]=0;return t.reset(),t}return i(t,n),t.prototype.reset=function(){this.D[0]=1732584193,this.D[1]=4023233417,this.D[2]=2562383102,this.D[3]=271733878,this.D[4]=3285377520,this.L=0,this.R=0},t.prototype.B=function(t,e){e||(e=0);var n=this.x;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.D[0],u=this.D[1],c=this.D[2],h=this.D[3],l=this.D[4];for(r=0;r<80;r++){s=r<40?r<20?(o=h^u&(c^h),1518500249):(o=u^c^h,1859775393):r<60?(o=u&c|h&(u|c),2400959708):(o=u^c^h,3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.D[0]=this.D[0]+a&4294967295,this.D[1]=this.D[1]+u&4294967295,this.D[2]=this.D[2]+c&4294967295,this.D[3]=this.D[3]+h&4294967295,this.D[4]=this.D[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.I,o=this.L;r<e;){if(0==o)for(;r<=n;)this.B(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o==this.blockSize){this.B(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o==this.blockSize){this.B(i),o=0;break}}this.L=o,this.R+=e}},t.prototype.digest=function(){var t=[],e=8*this.R;this.L<56?this.update(this.F,56-this.L):this.update(this.F,this.blockSize-(this.L-56));for(var n=this.blockSize-1;56<=n;n--)this.I[n]=255&e,e/=256;this.B(this.I);var r=0;for(n=0;n<5;n++)for(var i=24;0<=i;i-=8)t[r]=this.D[n]>>i&255,++r;return t},t}(n(72).Hash);e.Sha1=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){this.blockSize=-1};e.Hash=r},function(t,e,n){"use strict";function s(){}Object.defineProperty(e,"__esModule",{value:!0}),e.createSubscribe=function(t,e){var n=new r(t,e);return n.subscribe.bind(n)};var r=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},t.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=s),void 0===r.error&&(r.error=s),void 0===r.complete&&(r.complete=s);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();e.async=function(n,r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Promise.resolve(!0).then(function(){n.apply(void 0,t)}).catch(function(t){r&&r(t)})}}},function(t,e,n){"use strict";function i(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(r+" argument ")}Object.defineProperty(e,"__esModule",{value:!0}),e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:n<r&&(i=0===n?"none":"no more than "+n),i)throw Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.errorPrefix=i,e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw Error(i(t,e,r)+"must be a valid firebase namespace.")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw Error(i(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw Error(i(t,e,r)+"must be a valid context object.")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(28);e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(55296<=i&&i<=56319){var o=i-55296;r++,s.assert(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(i<65536?e[n++]=i>>12|224:(e[n++]=i>>18|240,e[n++]=i>>12&63|128),e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:55296<=r&&r<=56319?(e+=4,n++):e+=3}return e}}])}().default;try{webpackJsonpFirebase([0],[,function(t,h,e){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var n,l=e(0),r=e(0),i=e(0),o=e(0),s=e(0),a=e(0),u=e(13),c=e(0);h.LUIDGenerator=(n=1,function(){return n++}),h.sha1=function(t){var e=s.stringToByteArray(t),n=new o.Sha1;n.update(e);var r=n.digest();return i.base64.encodeByteArray(r)};var p=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"==typeof t[r]&&"number"==typeof t[r].length?n+=p.apply(null,t[r]):"object"==typeof t[r]?n+=a.stringify(t[r]):n+=t[r],n+=" ";return n},f=!(h.logger=null);h.enableLogging=function(t,e){l.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?("undefined"!=typeof console&&("function"==typeof console.log?h.logger=console.log.bind(console):"object"==typeof console.log&&(h.logger=function(t){console.log(t)})),e&&u.SessionStorage.set("logging_enabled",!0)):"function"==typeof t?h.logger=t:(h.logger=null,u.SessionStorage.remove("logging_enabled"))},h.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===f&&(f=!1,null===h.logger&&!0===u.SessionStorage.get("logging_enabled")&&h.enableLogging(!0)),h.logger){var n=p.apply(null,t);h.logger(n)}},h.logWrapper=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];h.log.apply(void 0,[n].concat(t))}},h.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE INTERNAL ERROR: "+p.apply(void 0,t);void 0!==console.error?console.error(n):console.log(n)}},h.fatal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=p.apply(void 0,t);throw Error("FIREBASE FATAL ERROR: "+n)},h.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE WARNING: "+p.apply(void 0,t);void 0!==console.warn?console.warn(n):console.log(n)}},h.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&h.warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},h.warnAboutUnsupportedMethod=function(t){h.warn(t+" is unsupported and will likely change soon.  Please do not use.")},h.isInvalidJSONNumber=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},h.executeWhenDOMReady=function(t){if(c.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},h.MIN_NAME="[MIN_NAME]",h.MAX_NAME="[MAX_NAME]",h.nameCompare=function(t,e){if(t===e)return 0;if(t===h.MIN_NAME||e===h.MAX_NAME)return-1;if(e===h.MIN_NAME||t===h.MAX_NAME)return 1;var n=h.tryParseInt(t),r=h.tryParseInt(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},h.stringCompare=function(t,e){return t===e?0:t<e?-1:1},h.requireKey=function(t,e){if(e&&t in e)return e[t];throw Error("Missing required key ("+t+") in object: "+a.stringify(e))},h.ObjectToUniqueKey=function(t){if("object"!=typeof t||null===t)return a.stringify(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=a.stringify(e[i]),r+=":",r+=h.ObjectToUniqueKey(t[e[i]]);return r+"}"},h.splitStringBySize=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)n<i+e?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},h.each=function(t,n){if(Array.isArray(t))for(var e=0;e<t.length;++e)n(e,t[e]);else r.forEach(t,function(t,e){return n(e,t)})},h.bindCallback=function(t,e){return e?t.bind(e):t},h.doubleToIEEE754String=function(t){var e,n,r,i,o,s,a;for(l.assert(!h.isInvalidJSONNumber(t),"Invalid JSON number"),0===t?e=1/t==-1/(r=n=0)?1:0:(e=t<0,r=(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(t/Math.pow(2,-1074)))),s=[],o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse(),a=s.join("");var u="";for(o=0;o<64;o+=8){var c=parseInt(a.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},h.isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},h.isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},h.errorForServerCode=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=Error(t+" at "+e.path+": "+n);return r.code=t.toUpperCase(),r},h.e=RegExp("^-?\\d{1,10}$"),h.tryParseInt=function(t){if(h.e.test(t)){var e=+t;if(-2147483648<=e&&e<=2147483647)return e}return null},h.exceptionGuard=function(e){try{e()}catch(e){setTimeout(function(){var t=e.stack||"";throw h.warn("Exception was thrown by user callback.",t),e},Math.floor(0))}},h.callUserCallback=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];"function"==typeof t&&h.exceptionGuard(function(){t.apply(void 0,e)})},h.beingCrawled=function(){return 0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)},h.exportPropGetter=function(t,e,n){Object.defineProperty(t,e,{get:n})},h.setTimeoutNonBlocking=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=n(0),i=function(){function i(t,e){if(void 0===e){this.n=t.split("/");for(var n=0,r=0;r<this.n.length;r++)0<this.n[r].length&&(this.n[n]=this.n[r],n++);this.n.length=n,this.i=0}else this.n=t,this.i=e}return Object.defineProperty(i,"Empty",{get:function(){return new i("")},enumerable:!0,configurable:!0}),i.prototype.getFront=function(){return this.i>=this.n.length?null:this.n[this.i]},i.prototype.getLength=function(){return this.n.length-this.i},i.prototype.popFront=function(){var t=this.i;return t<this.n.length&&t++,new i(this.n,t)},i.prototype.getBack=function(){return this.i<this.n.length?this.n[this.n.length-1]:null},i.prototype.toString=function(){for(var t="",e=this.i;e<this.n.length;e++)""!==this.n[e]&&(t+="/"+this.n[e]);return t||"/"},i.prototype.toUrlEncodedString=function(){for(var t="",e=this.i;e<this.n.length;e++)""!==this.n[e]&&(t+="/"+encodeURIComponent(this.n[e]+""));return t||"/"},i.prototype.slice=function(t){return void 0===t&&(t=0),this.n.slice(this.i+t)},i.prototype.parent=function(){if(this.i>=this.n.length)return null;for(var t=[],e=this.i;e<this.n.length-1;e++)t.push(this.n[e]);return new i(t,0)},i.prototype.child=function(t){for(var e=[],n=this.i;n<this.n.length;n++)e.push(this.n[n]);if(t instanceof i)for(n=t.i;n<t.n.length;n++)e.push(t.n[n]);else{var r=t.split("/");for(n=0;n<r.length;n++)0<r[n].length&&e.push(r[n])}return new i(e,0)},i.prototype.isEmpty=function(){return this.i>=this.n.length},i.relativePath=function(t,e){var n=t.getFront(),r=e.getFront();if(null===n)return e;if(n===r)return i.relativePath(t.popFront(),e.popFront());throw Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")},i.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=s.nameCompare(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},i.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.i,n=t.i;e<=this.n.length;e++,n++)if(this.n[e]!==t.n[n])return!1;return!0},i.prototype.contains=function(t){var e=this.i,n=t.i;if(this.getLength()>t.getLength())return!1;for(;e<this.n.length;){if(this.n[e]!==t.n[n])return!1;++e,++n}return!0},i}();e.Path=i;var o=function(){function t(t,e){this.o=e,this.u=t.slice(),this.l=Math.max(1,this.u.length);for(var n=0;n<this.u.length;n++)this.l+=r.stringLength(this.u[n]);this.f()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){0<this.u.length&&(this.l+=1),this.u.push(t),this.l+=r.stringLength(t),this.f()},t.prototype.pop=function(){var t=this.u.pop();this.l-=r.stringLength(t),0<this.u.length&&(this.l-=1)},t.prototype.f=function(){if(this.l>t.MAX_PATH_LENGTH_BYTES)throw Error(this.o+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.l+").");if(this.u.length>t.MAX_PATH_DEPTH)throw Error(this.o+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.u.length?"":"in property '"+this.u.join(".")+"'"},t}();e.ValidationPath=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o,s,a=n(15),u=n(1),c=n(5),h=n(16);e.setNodeFromJSON=function(t){o=t},e.setMaxNode=function(t){s=t};var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?u.nameCompare(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return c.NamedNode.MIN},e.prototype.maxPost=function(){return new c.NamedNode(u.MAX_NAME,new h.LeafNode("[PRIORITY-POST]",s))},e.prototype.makePost=function(t,e){var n=o(t);return new c.NamedNode(e,new h.LeafNode("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(a.Index);e.PriorityIndex=l,e.PRIORITY_INDEX=new l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s,u=n(0),o=n(1),c=n(17),h=n(5),l=n(37),p=n(3),f=n(10),d=n(39),a=n(16),v=n(41),y=function(){function a(t,e,n){this._=t,this.y=e,this.g=n,this.m=null,this.y&&l.validatePriorityNode(this.y),this._.isEmpty()&&u.assert(!this.y||this.y.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(a,"EMPTY_NODE",{get:function(){return s||(s=new a(new c.SortedMap(v.NAME_COMPARATOR),null,d.IndexMap.Default))},enumerable:!0,configurable:!0}),a.prototype.isLeafNode=function(){return!1},a.prototype.getPriority=function(){return this.y||s},a.prototype.updatePriority=function(t){return this._.isEmpty()?this:new a(this._,t,this.g)},a.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this._.get(t);return null===e?s:e},a.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},a.prototype.hasChild=function(t){return null!==this._.get(t)},a.prototype.updateImmediateChild=function(t,e){if(u.assert(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);var n,r=new h.NamedNode(t,e),i=void 0,o=void 0;return o=e.isEmpty()?(i=this._.remove(t),this.g.removeFromIndexes(r,this._)):(i=this._.insert(t,e),this.g.addToIndexes(r,this._)),n=i.isEmpty()?s:this.y,new a(i,n,o)},a.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;u.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},a.prototype.isEmpty=function(){return this._.isEmpty()},a.prototype.numChildren=function(){return this._.count()},a.prototype.val=function(n){if(this.isEmpty())return null;var r={},i=0,o=0,s=!0;if(this.forEachChild(p.PRIORITY_INDEX,function(t,e){r[t]=e.val(n),i++,s&&a.e.test(t)?o=Math.max(o,+t):s=!1}),!n&&s&&o<2*i){var t=[];for(var e in r)t[e]=r[e];return t}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},a.prototype.hash=function(){if(null===this.m){var r="";this.getPriority().isEmpty()||(r+="priority:"+l.priorityHashText(this.getPriority().val())+":"),this.forEachChild(p.PRIORITY_INDEX,function(t,e){var n=e.hash();""!==n&&(r+=":"+t+":"+n)}),this.m=""===r?"":o.sha1(r)}return this.m},a.prototype.getPredecessorChildName=function(t,e,n){var r=this.C(n);if(r){var i=r.getPredecessorKey(new h.NamedNode(t,e));return i?i.name:null}return this._.getPredecessorKey(t)},a.prototype.getFirstChildName=function(t){var e=this.C(t);if(e){var n=e.minKey();return n&&n.name}return this._.minKey()},a.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new h.NamedNode(e,this._.get(e)):null},a.prototype.getLastChildName=function(t){var e=this.C(t);if(e){var n=e.maxKey();return n&&n.name}return this._.maxKey()},a.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new h.NamedNode(e,this._.get(e)):null},a.prototype.forEachChild=function(t,e){var n=this.C(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this._.inorderTraversal(e)},a.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},a.prototype.getIteratorFrom=function(t,e){var n=this.C(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this._.getIteratorFrom(t.name,h.NamedNode.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},a.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},a.prototype.getReverseIteratorFrom=function(t,e){var n=this.C(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this._.getReverseIteratorFrom(t.name,h.NamedNode.Wrap),i=r.peek();null!=i&&0<e.compare(i,t);)r.getNext(),i=r.peek();return r},a.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===e.MAX_NODE?-1:0},a.prototype.withIndex=function(t){if(t===f.KEY_INDEX||this.g.hasIndex(t))return this;var e=this.g.addIndex(t,this._);return new a(this._,this.y,e)},a.prototype.isIndexed=function(t){return t===f.KEY_INDEX||this.g.hasIndex(t)},a.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this._.count()!==e._.count())return!1;for(var n=this.getIterator(p.PRIORITY_INDEX),r=e.getIterator(p.PRIORITY_INDEX),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1},a.prototype.C=function(t){return t===f.KEY_INDEX?null:this.g.get(""+t)},a.e=/^(0|[1-9]\d*)$/,a}(),g=function(t){function e(){return t.call(this,new c.SortedMap(v.NAME_COMPARATOR),y.EMPTY_NODE,d.IndexMap.Default)||this}return i(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return y.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(e.ChildrenNode=y);e.MaxNode=g,e.MAX_NODE=new g,Object.defineProperties(h.NamedNode,{MIN:{value:new h.NamedNode(o.MIN_NAME,y.EMPTY_NODE)},MAX:{value:new h.NamedNode(o.MAX_NAME,e.MAX_NODE)}}),f.KeyIndex.__EMPTY_NODE=y.EMPTY_NODE,a.LeafNode.__childrenNodeConstructor=y,l.setMaxNode(e.MAX_NODE),p.setMaxNode(e.MAX_NODE)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function n(t,e){this.name=t,this.node=e}return n.Wrap=function(t,e){return new n(t,e)},n}();e.NamedNode=r},,function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var u=e(2),c=e(0),s=e(1),h=e(0),l=e(0);a.N=/[\[\].#$\/\u0000-\u001F\u007F]/,a.P=/[\[\].#$\u0000-\u001F\u007F]/,a.S=10485760,a.isValidKey=function(t){return"string"==typeof t&&0!==t.length&&!a.N.test(t)},a.isValidPathString=function(t){return"string"==typeof t&&0!==t.length&&!a.P.test(t)},a.isValidRootPathString=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),a.isValidPathString(t)},a.isValidPriority=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!s.isInvalidJSONNumber(t)||t&&"object"==typeof t&&c.contains(t,".sv")},a.validateFirebaseDataArg=function(t,e,n,r,i){i&&void 0===n||a.validateFirebaseData(h.errorPrefix(t,e,i),n,r)},a.validateFirebaseData=function(n,t,e){var r=e instanceof u.Path?new u.ValidationPath(e,n):e;if(void 0===t)throw Error(n+"contains undefined "+r.toErrorString());if("function"==typeof t)throw Error(n+"contains a function "+r.toErrorString()+" with contents = "+t);if(s.isInvalidJSONNumber(t))throw Error(n+"contains "+t+" "+r.toErrorString());if("string"==typeof t&&t.length>a.S/3&&l.stringLength(t)>a.S)throw Error(n+"contains a string greater than "+a.S+" utf8 bytes "+r.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(c.forEach(t,function(t,e){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!a.isValidKey(t)))throw Error(n+" contains an invalid key ("+t+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(t),a.validateFirebaseData(n,e,r),r.pop()}),i&&o)throw Error(n+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},a.validateFirebaseMergePaths=function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!a.isValidKey(i[o]))throw Error(t+"contains an invalid key ("+i[o]+") in path "+r+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(u.Path.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw Error(t+"contains a path "+s+" that is ancestor of another path "+r);s=r}},a.validateFirebaseMergeDataArg=function(t,e,n,r,i){if(!i||void 0!==n){var o=h.errorPrefix(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw Error(o+" must be an object containing the children to replace.");var s=[];c.forEach(n,function(t,e){var n=new u.Path(t);if(a.validateFirebaseData(o,e,r.child(n)),".priority"===n.getBack()&&!a.isValidPriority(e))throw Error(o+"contains an invalid value for '"+n+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)}),a.validateFirebaseMergePaths(o,s)}},a.validatePriority=function(t,e,n,r){if(!r||void 0!==n){if(s.isInvalidJSONNumber(n))throw Error(h.errorPrefix(t,e,r)+"is "+n+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!a.isValidPriority(n))throw Error(h.errorPrefix(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},a.validateEventType=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error(h.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},a.validateKey=function(t,e,n,r){if(!(r&&void 0===n||a.isValidKey(n)))throw Error(h.errorPrefix(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},a.validatePathString=function(t,e,n,r){if(!(r&&void 0===n||a.isValidPathString(n)))throw Error(h.errorPrefix(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},a.validateRootPathString=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),a.validatePathString(t,e,n,r)},a.validateWritablePath=function(t,e){if(".info"===e.getFront())throw Error(t+" failed = Can't modify data under /.info/")},a.validateUrl=function(t,e,n){var r=""+n.path;if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!a.isValidKey(n.repoInfo.namespace)||0!==r.length&&!a.isValidRootPathString(r))throw Error(h.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},a.validateCredential=function(t,e,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw Error(h.errorPrefix(t,e,r)+"must be a valid credential (a string).")},a.validateBoolean=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw Error(h.errorPrefix(t,e,r)+"must be a boolean.")},a.validateString=function(t,e,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw Error(h.errorPrefix(t,e,r)+"must be a valid string.")},a.validateObject=function(t,e,n,r){if(!(r&&void 0===n||n&&"object"==typeof n&&null!==n))throw Error(h.errorPrefix(t,e,r)+"must be a valid object.")},a.validateObjectContainsKey=function(t,e,n,r,i,o){if(!n||"object"!=typeof n||!c.contains(n,r)){if(i)return;throw Error(h.errorPrefix(t,e,i)+'must contain the key "'+r+'"')}if(o){var s=c.safeGet(n,r);if("number"===o&&"number"!=typeof s||"string"===o&&"string"!=typeof s||"boolean"===o&&"boolean"!=typeof s||"function"===o&&"function"!=typeof s||"object"===o&&"object"!=typeof s&&s)throw i?Error(h.errorPrefix(t,e,i)+'contains invalid value for key "'+r+'" (must be of type "'+o+'")'):Error(h.errorPrefix(t,e,i)+'must contain the key "'+r+'" with type "'+o+'"')}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(0);(r=e.OperationType||(e.OperationType={}))[r.OVERWRITE=0]="OVERWRITE",r[r.MERGE=1]="MERGE",r[r.ACK_USER_WRITE=2]="ACK_USER_WRITE",r[r.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var o=function(){function e(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,i.assert(!r||e,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}();e.OperationSource=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function r(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return r.valueChange=function(t){return new r(r.VALUE,t)},r.childAddedChange=function(t,e){return new r(r.CHILD_ADDED,e,t)},r.childRemovedChange=function(t,e){return new r(r.CHILD_REMOVED,e,t)},r.childChangedChange=function(t,e,n){return new r(r.CHILD_CHANGED,e,t,n)},r.childMovedChange=function(t,e){return new r(r.CHILD_MOVED,e,t)},r.CHILD_ADDED="child_added",r.CHILD_REMOVED="child_removed",r.CHILD_CHANGED="child_changed",r.CHILD_MOVED="child_moved",r.VALUE="value",r}();e.Change=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o,s=n(15),a=n(5),u=n(1),c=n(0),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return o},set:function(t){o=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return u.nameCompare(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw c.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return a.NamedNode.MIN},e.prototype.maxPost=function(){return new a.NamedNode(u.MAX_NAME,o)},e.prototype.makePost=function(t,e){return c.assert("string"==typeof t,"KeyIndex indexValue must always be a string."),new a.NamedNode(t,o)},e.prototype.toString=function(){return".key"},e}(s.Index);e.KeyIndex=h,e.KEY_INDEX=new h},function(t,e,n){"use strict";function h(t,e){if(void 0===e&&(e=null),null===t)return l.ChildrenNode.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),v.assert(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var n=t;return new p.LeafNode(n,h(e))}if(t instanceof Array||!b){var r=l.ChildrenNode.EMPTY_NODE,i=t;return d.forEach(i,function(t,e){if(d.contains(i,t)&&"."!==t.substring(0,1)){var n=h(e);!n.isLeafNode()&&n.isEmpty()||(r=r.updateImmediateChild(t,n))}}),r.updatePriority(h(e))}var o=[],s=!1,a=t;if(d.forEach(a,function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=h(a[t]);n.isEmpty()||(s=s||!n.getPriority().isEmpty(),o.push(new f.NamedNode(t,n)))}}),0==o.length)return l.ChildrenNode.EMPTY_NODE;var u=y.buildChildSet(o,g.NAME_ONLY_COMPARATOR,function(t){return t.name},g.NAME_COMPARATOR);if(s){var c=y.buildChildSet(o,E.PRIORITY_INDEX.getCompare());return new l.ChildrenNode(u,h(e),new m.IndexMap({".priority":c},{".priority":E.PRIORITY_INDEX}))}return new l.ChildrenNode(u,h(e),m.IndexMap.Default)}Object.defineProperty(e,"__esModule",{value:!0});var l=n(4),p=n(16),f=n(5),d=n(0),v=n(0),y=n(40),g=n(41),m=n(39),E=n(3),b=!0;e.nodeFromJSON=h,E.setNodeFromJSON(h)},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(80),i=n(81),o=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new r.DOMStorageWrapper(e)}}catch(t){}return new i.MemoryStorage};e.PersistentStorage=o("localStorage"),e.SessionStorage=o("sessionStorage")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PROTOCOL_VERSION="5",e.VERSION_PARAM="v",e.TRANSPORT_SESSION_PARAM="s",e.REFERER_PARAM="r",e.FORGE_REF="f",e.FORGE_DOMAIN="firebaseio.com",e.LAST_SESSION_PARAM="ls",e.WEBSOCKET="websocket",e.LONG_POLLING="long_polling"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=n(1),r=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new i.NamedNode(o.MIN_NAME,t),r=new i.NamedNode(o.MIN_NAME,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return i.NamedNode.MIN},t}();e.Index=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,s=n(0),i=n(1),a=n(37),o=function(){function o(t,e){void 0===e&&(e=o.__childrenNodeConstructor.EMPTY_NODE),this.T=t,this.y=e,this.m=null,s.assert(void 0!==this.T&&null!==this.T,"LeafNode shouldn't be created with null/undefined value."),a.validatePriorityNode(this.y)}return Object.defineProperty(o,"__childrenNodeConstructor",{get:function(){return r},set:function(t){r=t},enumerable:!0,configurable:!0}),o.prototype.isLeafNode=function(){return!0},o.prototype.getPriority=function(){return this.y},o.prototype.updatePriority=function(t){return new o(this.T,t)},o.prototype.getImmediateChild=function(t){return".priority"===t?this.y:o.__childrenNodeConstructor.EMPTY_NODE},o.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.y:o.__childrenNodeConstructor.EMPTY_NODE},o.prototype.hasChild=function(){return!1},o.prototype.getPredecessorChildName=function(t,e){return null},o.prototype.updateImmediateChild=function(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:o.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.y)},o.prototype.updateChild=function(t,e){var n=t.getFront();return null===n?e:e.isEmpty()&&".priority"!==n?this:(s.assert(".priority"!==n||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,o.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),e)))},o.prototype.isEmpty=function(){return!1},o.prototype.numChildren=function(){return 0},o.prototype.forEachChild=function(t,e){return!1},o.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},o.prototype.hash=function(){if(null===this.m){var t="";this.y.isEmpty()||(t+="priority:"+a.priorityHashText(this.y.val())+":");var e=typeof this.T;t+=e+":",t+="number"==e?i.doubleToIEEE754String(this.T):this.T,this.m=i.sha1(t)}return this.m},o.prototype.getValue=function(){return this.T},o.prototype.compareTo=function(t){return t===o.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof o.__childrenNodeConstructor?-1:(s.assert(t.isLeafNode(),"Unknown node type"),this.w(t))},o.prototype.w=function(t){var e=typeof t.T,n=typeof this.T,r=o.VALUE_TYPE_ORDER.indexOf(e),i=o.VALUE_TYPE_ORDER.indexOf(n);return s.assert(0<=r,"Unknown leaf type: "+e),s.assert(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.T<t.T?-1:this.T===t.T?0:1:i-r},o.prototype.withIndex=function(){return this},o.prototype.isIndexed=function(){return!0},o.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.T===e.T&&this.y.equals(e.y)}return!1},o.VALUE_TYPE_ORDER=["object","boolean","number","string"],o}();e.LeafNode=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.I=r,this.R=i,this.O=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.I?t.left:t.right;else{if(0===o){this.O.push(t);break}this.O.push(t),t=this.I?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.O.length)return null;var t,e=this.O.pop();if(t=this.R?this.R(e.key,e.value):{key:e.key,value:e.value},this.I)for(e=e.left;!e.isEmpty();)this.O.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.O.push(e),e=e.left;return t},t.prototype.hasNext=function(){return 0<this.O.length},t.prototype.peek=function(){if(0===this.O.length)return null;var t=this.O[this.O.length-1];return this.R?this.R(t.key,t.value):{key:t.key,value:t.value}},t}();e.SortedMapIterator=r;var i=function(){function o(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:o.RED,this.left=null!=r?r:s.EMPTY_NODE,this.right=null!=i?i:s.EMPTY_NODE}return o.prototype.copy=function(t,e,n,r,i){return new o(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},o.prototype.count=function(){return this.left.count()+1+this.right.count()},o.prototype.isEmpty=function(){return!1},o.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},o.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},o.prototype.A=function(){return this.left.isEmpty()?this:this.left.A()},o.prototype.minKey=function(){return this.A().key},o.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},o.prototype.insert=function(t,e,n){var r,i;return(i=(r=n(t,(i=this).key))<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).D()},o.prototype.M=function(){if(this.left.isEmpty())return s.EMPTY_NODE;var t=this;return t.left.L()||t.left.left.L()||(t=t.F()),(t=t.copy(null,null,null,t.left.M(),null)).D()},o.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.L()||n.left.left.L()||(n=n.F()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.L()&&(n=n.x()),n.right.isEmpty()||n.right.L()||n.right.left.L()||(n=n.k()),0===e(t,n.key)){if(n.right.isEmpty())return s.EMPTY_NODE;r=n.right.A(),n=n.copy(r.key,r.value,null,null,n.right.M())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.D()},o.prototype.L=function(){return this.color},o.prototype.D=function(){var t=this;return t.right.L()&&!t.left.L()&&(t=t.W()),t.left.L()&&t.left.left.L()&&(t=t.x()),t.left.L()&&t.right.L()&&(t=t.j()),t},o.prototype.F=function(){var t=this.j();return t.right.left.L()&&(t=(t=(t=t.copy(null,null,null,null,t.right.x())).W()).j()),t},o.prototype.k=function(){var t=this.j();return t.left.left.L()&&(t=(t=t.x()).j()),t},o.prototype.W=function(){var t=this.copy(null,null,o.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},o.prototype.x=function(){var t=this.copy(null,null,o.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},o.prototype.j=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},o.prototype.V=function(){var t=this.Q();return Math.pow(2,t)<=this.count()+1},o.prototype.Q=function(){var t;if(this.L()&&this.left.L())throw Error("Red node has red child("+this.key+","+this.value+")");if(this.right.L())throw Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.Q())!==this.right.Q())throw Error("Black depths differ");return t+(this.L()?0:1)},o.RED=!0,o.BLACK=!1,o}();e.LLRBNode=i;var o=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new i(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.Q=function(){return 0},t.prototype.L=function(){return!1},t}();e.LLRBEmptyNode=o;var s=function(){function n(t,e){void 0===e&&(e=n.EMPTY_NODE),this.U=t,this.B=e}return n.prototype.insert=function(t,e){return new n(this.U,this.B.insert(t,e,this.U).copy(null,null,i.BLACK,null,null))},n.prototype.remove=function(t){return new n(this.U,this.B.remove(t,this.U).copy(null,null,i.BLACK,null,null))},n.prototype.get=function(t){for(var e,n=this.B;!n.isEmpty();){if(0===(e=this.U(t,n.key)))return n.value;e<0?n=n.left:0<e&&(n=n.right)}return null},n.prototype.getPredecessorKey=function(t){for(var e,n=this.B,r=null;!n.isEmpty();){if(0===(e=this.U(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:0<e&&(n=(r=n).right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},n.prototype.isEmpty=function(){return this.B.isEmpty()},n.prototype.count=function(){return this.B.count()},n.prototype.minKey=function(){return this.B.minKey()},n.prototype.maxKey=function(){return this.B.maxKey()},n.prototype.inorderTraversal=function(t){return this.B.inorderTraversal(t)},n.prototype.reverseTraversal=function(t){return this.B.reverseTraversal(t)},n.prototype.getIterator=function(t){return new r(this.B,null,this.U,!1,t)},n.prototype.getIteratorFrom=function(t,e){return new r(this.B,t,this.U,!1,e)},n.prototype.getReverseIteratorFrom=function(t,e){return new r(this.B,t,this.U,!0,e)},n.prototype.getReverseIterator=function(t){return new r(this.B,null,this.U,!0,t)},n.EMPTY_NODE=new o,n}();e.SortedMap=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=n(43),p=n(11),f=n(2),o=n(44),a=n(86),u=n(97),c=n(0),d=n(1),v=n(0),h=n(98),y=n(25),g=n(100),i=n(49),m=n(101),E=n(50),b=n(106),r=n(32),s=function(){function t(t,e,n){var s=this;this.H=t,this.app=n,this.dataUpdateCount=0,this.G=null,this.K=new m.EventQueue,this.Y=1,this.X=null,this.z=new o.SparseSnapshotTree,this.J=null;var r=new h.AuthTokenProvider(n);if(this.$=y.StatsManager.getCollection(t),e||d.beingCrawled())this.Z=new b.ReadonlyRestClient(this.H,this.ee.bind(this),r),setTimeout(this.te.bind(this,!0),0);else{var i=n.options.databaseAuthVariableOverride;if(null!=i){if("object"!=typeof i)throw Error("Only objects are supported for option databaseAuthVariableOverride");try{c.stringify(i)}catch(t){throw Error("Invalid authOverride provided: "+t)}}this.J=new E.PersistentConnection(this.H,this.ee.bind(this),this.te.bind(this),this.ne.bind(this),r,i),this.Z=this.J}r.addTokenChangeListener(function(t){s.Z.refreshAuthToken(t)}),this.re=y.StatsManager.getOrCreateReporter(t,function(){return new g.StatsReporter(s.$,s.Z)}),this.ie(),this.oe=new u.SnapshotHolder,this.ae=new a.SyncTree({startListening:function(t,e,n,r){var i=[],o=s.oe.getNode(t.path);return o.isEmpty()||(i=s.ae.applyServerOverwrite(t.path,o),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),this.se("connected",!1),this.ue=new a.SyncTree({startListening:function(r,t,e,i){return s.Z.listen(r,e,t,function(t,e){var n=i(t,e);s.K.raiseEventsForChangedPath(r.path,n)}),[]},stopListening:function(t,e){s.Z.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.H.secure?"https://":"http://")+this.H.host},t.prototype.name=function(){return this.H.namespace},t.prototype.serverTime=function(){var t=this.oe.getNode(new f.Path(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return l.generateWithValues({timestamp:this.serverTime()})},t.prototype.ee=function(t,e,n,r){this.dataUpdateCount++;var i=new f.Path(t);e=this.X?this.X(t,e):e;var o=[];if(r)if(n){var s=v.map(e,function(t){return p.nodeFromJSON(t)});o=this.ue.applyTaggedQueryMerge(i,s,r)}else{var a=p.nodeFromJSON(e);o=this.ue.applyTaggedQueryOverwrite(i,a,r)}else if(n){var u=v.map(e,function(t){return p.nodeFromJSON(t)});o=this.ue.applyServerMerge(i,u)}else{var c=p.nodeFromJSON(e);o=this.ue.applyServerOverwrite(i,c)}var h=i;0<o.length&&(h=this.le(i)),this.K.raiseEventsForChangedPath(h,o)},t.prototype.he=function(t){this.X=t},t.prototype.te=function(t){this.se("connected",t),!1===t&&this.ce()},t.prototype.ne=function(t){var n=this;d.each(t,function(t,e){n.se(e,t)})},t.prototype.se=function(t,e){var n=new f.Path("/.info/"+t),r=p.nodeFromJSON(e);this.oe.updateSnapshot(n,r);var i=this.ae.applyServerOverwrite(n,r);this.K.raiseEventsForChangedPath(n,i)},t.prototype.pe=function(){return this.Y++},t.prototype.setWithPriority=function(i,t,e,o){var s=this;this.de("set",{path:""+i,value:t,priority:e});var n=this.generateServerValues(),r=p.nodeFromJSON(t,e),a=l.resolveDeferredValueSnapshot(r,n),u=this.pe(),c=this.ue.applyUserOverwrite(i,a,u,!0);this.K.queueEvents(c),this.Z.put(""+i,r.val(!0),function(t,e){var n="ok"===t;n||d.warn("set at "+i+" failed: "+t);var r=s.ue.ackUserWrite(u,!n);s.K.raiseEventsForChangedPath(i,r),s.callOnCompleteCallback(o,t,e)});var h=this.fe(i);this.le(h),this.K.raiseEventsForChangedPath(h,[])},t.prototype.update=function(o,t,s){var a=this;this.de("update",{path:""+o,value:t});var r=!0,i=this.generateServerValues(),u={};if(v.forEach(t,function(t,e){r=!1;var n=p.nodeFromJSON(e);u[t]=l.resolveDeferredValueSnapshot(n,i)}),r)d.log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(s,"ok");else{var c=this.pe(),e=this.ue.applyUserMerge(o,u,c);this.K.queueEvents(e),this.Z.merge(""+o,t,function(t,e){var n="ok"===t;n||d.warn("update at "+o+" failed: "+t);var r=a.ue.ackUserWrite(c,!n),i=0<r.length?a.le(o):o;a.K.raiseEventsForChangedPath(i,r),a.callOnCompleteCallback(s,t,e)}),v.forEach(t,function(t){var e=a.fe(o.child(t));a.le(e)}),this.K.raiseEventsForChangedPath(o,[])}},t.prototype.ce=function(){var r=this;this.de("onDisconnectEvents");var t=this.generateServerValues(),e=l.resolveDeferredValueTree(this.z,t),i=[];e.forEachTree(f.Path.Empty,function(t,e){i=i.concat(r.ue.applyServerOverwrite(t,e));var n=r.fe(t);r.le(n)}),this.z=new o.SparseSnapshotTree,this.K.raiseEventsForChangedPath(f.Path.Empty,i)},t.prototype.onDisconnectCancel=function(n,r){var i=this;this.Z.onDisconnectCancel(""+n,function(t,e){"ok"===t&&i.z.forget(n),i.callOnCompleteCallback(r,t,e)})},t.prototype.onDisconnectSet=function(n,t,r){var i=this,o=p.nodeFromJSON(t);this.Z.onDisconnectPut(""+n,o.val(!0),function(t,e){"ok"===t&&i.z.remember(n,o),i.callOnCompleteCallback(r,t,e)})},t.prototype.onDisconnectSetWithPriority=function(n,t,e,r){var i=this,o=p.nodeFromJSON(t,e);this.Z.onDisconnectPut(""+n,o.val(!0),function(t,e){"ok"===t&&i.z.remember(n,o),i.callOnCompleteCallback(r,t,e)})},t.prototype.onDisconnectUpdate=function(r,n,i){var o=this;if(v.isEmpty(n))return d.log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(i,"ok");this.Z.onDisconnectMerge(""+r,n,function(t,e){"ok"===t&&v.forEach(n,function(t,e){var n=p.nodeFromJSON(e);o.z.remember(r.child(t),n)}),o.callOnCompleteCallback(i,t,e)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.ae.addEventRegistration(t,e):this.ue.addEventRegistration(t,e),this.K.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.ae.removeEventRegistration(t,e):this.ue.removeEventRegistration(t,e),this.K.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.J&&this.J.interrupt("repo_interrupt")},t.prototype.resume=function(){this.J&&this.J.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;e=t?(this.G||(this.G=new i.StatsListener(this.$)),this.G.get()):this.$.get();var r=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);v.forEach(e,function(t,e){for(var n=t.length;n<r+2;n++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.$.incrementCounter(t),this.re.includeStat(t)},t.prototype.de=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.J&&(n=this.J.id+":"),d.log.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(r,i,o){r&&d.exceptionGuard(function(){if("ok"==i)r(null);else{var t=(i||"error").toUpperCase(),e=t;o&&(e+=": "+o);var n=Error(e);n.code=t,r(n)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new r.Database(this))},enumerable:!0,configurable:!0}),t}();e.Repo=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this._e=t,this.ye=e,this.ve=n}return t.prototype.isFullyInitialized=function(){return this.ye},t.prototype.isFiltered=function(){return this.ve},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.ve;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.ve||this._e.hasChild(t)},t.prototype.getNode=function(){return this._e},t}();e.CacheNode=r},,function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(35),s=n(82),a=n(1),u=n(83),c=n(36),h=n(18),l=n(2),p=n(107),f=n(7),d=n(0),v=n(0),y=n(47),g=function(n){function e(t,e){if(!(t instanceof h.Repo))throw Error("new Reference() no longer supported - use app.database().");return n.call(this,t,e,p.QueryParams.DEFAULT,!1)||this}return i(e,n),e.prototype.getKey=function(){return d.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return d.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof t?t+="":t instanceof l.Path||(null===this.path.getFront()?f.validateRootPathString("Reference.child",1,t,!1):f.validatePathString("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){d.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){d.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){d.validateArgCount("Reference.set",1,2,arguments.length),f.validateWritablePath("Reference.set",this.path),f.validateFirebaseDataArg("Reference.set",1,t,this.path,!1),d.validateCallback("Reference.set",2,e,!0);var n=new v.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(d.validateArgCount("Reference.update",1,2,arguments.length),f.validateWritablePath("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,a.warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}f.validateFirebaseMergeDataArg("Reference.update",1,t,this.path,!1),d.validateCallback("Reference.update",2,e,!0);var i=new v.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(d.validateArgCount("Reference.setWithPriority",2,3,arguments.length),f.validateWritablePath("Reference.setWithPriority",this.path),f.validateFirebaseDataArg("Reference.setWithPriority",1,t,this.path,!1),f.validatePriority("Reference.setWithPriority",2,e,!1),d.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new v.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return d.validateArgCount("Reference.remove",0,1,arguments.length),f.validateWritablePath("Reference.remove",this.path),d.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,r,e){if(d.validateArgCount("Reference.transaction",1,3,arguments.length),f.validateWritablePath("Reference.transaction",this.path),d.validateCallback("Reference.transaction",1,t,!1),d.validateCallback("Reference.transaction",2,r,!0),f.validateBoolean("Reference.transaction",3,e,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===e&&(e=!0);var i=new v.Deferred;"function"==typeof r&&i.promise.catch(function(){});return this.repo.startTransaction(this.path,t,function(t,e,n){t?i.reject(t):i.resolve(new s.TransactionResult(e,n)),"function"==typeof r&&r(t,e,n)},e),i.promise},e.prototype.setPriority=function(t,e){d.validateArgCount("Reference.setPriority",1,2,arguments.length),f.validateWritablePath("Reference.setPriority",this.path),f.validatePriority("Reference.setPriority",1,t,!1),d.validateCallback("Reference.setPriority",2,e,!0);var n=new v.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){d.validateArgCount("Reference.push",0,2,arguments.length),f.validateWritablePath("Reference.push",this.path),f.validateFirebaseDataArg("Reference.push",1,t,this.path,!0),d.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=u.nextPushId(r),o=this.child(i),s=this.child(i);return n=null!=t?o.set(t,e).then(function(){return s}):Promise.resolve(s),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},e.prototype.onDisconnect=function(){return f.validateWritablePath("Reference.onDisconnect",this.path),new o.OnDisconnect(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(c.Query);e.Reference=g,c.Query.__referenceConstructor=g,y.SyncPoint.__referenceConstructor=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(7),s=n(2),a=n(3),i=function(){function i(t,e,n){this._e=t,this.ge=e,this.me=n}return i.prototype.val=function(){return o.validateArgCount("DataSnapshot.val",0,0,arguments.length),this._e.val()},i.prototype.exportVal=function(){return o.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this._e.val(!0)},i.prototype.toJSON=function(){return o.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},i.prototype.exists=function(){return o.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this._e.isEmpty()},i.prototype.child=function(t){o.validateArgCount("DataSnapshot.child",0,1,arguments.length),t+="",r.validatePathString("DataSnapshot.child",1,t,!1);var e=new s.Path(t),n=this.ge.child(e);return new i(this._e.getChild(e),n,a.PRIORITY_INDEX)},i.prototype.hasChild=function(t){o.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),r.validatePathString("DataSnapshot.hasChild",1,t,!1);var e=new s.Path(t);return!this._e.getChild(e).isEmpty()},i.prototype.getPriority=function(){return o.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this._e.getPriority().val()},i.prototype.forEach=function(n){var r=this;return o.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),o.validateCallback("DataSnapshot.forEach",1,n,!1),!this._e.isLeafNode()&&!!this._e.forEachChild(this.me,function(t,e){return n(new i(e,r.ge.child(t),a.PRIORITY_INDEX))})},i.prototype.hasChildren=function(){return o.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this._e.isLeafNode()&&!this._e.isEmpty()},Object.defineProperty(i.prototype,"key",{get:function(){return this.ge.getKey()},enumerable:!0,configurable:!0}),i.prototype.numChildren=function(){return o.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this._e.numChildren()},i.prototype.getRef=function(){return o.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ge},Object.defineProperty(i.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),i}();e.DataSnapshot=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(17),s=n(2),a=n(1),u=n(0),o=function(){function o(t,e){void 0===e&&(r||(r=new i.SortedMap(a.stringCompare)),e=r),this.value=t,this.children=e}return o.fromObject=function(t){var n=o.Empty;return u.forEach(t,function(t,e){n=n.set(new s.Path(t),e)}),n},o.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},o.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:s.Path.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null===r)return null;var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new s.Path(n).child(i.path),value:i.value}:null},o.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},o.prototype.subtree=function(t){if(t.isEmpty())return this;var e=t.getFront(),n=this.children.get(e);return null!==n?n.subtree(t.popFront()):o.Empty},o.prototype.set=function(t,e){if(t.isEmpty())return new o(e,this.children);var n=t.getFront(),r=(this.children.get(n)||o.Empty).set(t.popFront(),e),i=this.children.insert(n,r);return new o(this.value,i)},o.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?o.Empty:new o(null,this.children);var e=t.getFront(),n=this.children.get(e);if(n){var r=n.remove(t.popFront()),i=void 0;return i=r.isEmpty()?this.children.remove(e):this.children.insert(e,r),null===this.value&&i.isEmpty()?o.Empty:new o(this.value,i)}return this},o.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},o.prototype.setTree=function(t,e){if(t.isEmpty())return e;var n,r=t.getFront(),i=(this.children.get(r)||o.Empty).setTree(t.popFront(),e);return n=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new o(this.value,n)},o.prototype.fold=function(t){return this.Ce(s.Path.Empty,t)},o.prototype.Ce=function(n,r){var i={};return this.children.inorderTraversal(function(t,e){i[t]=e.Ce(n.child(t),r)}),r(n,this.value,i)},o.prototype.findOnPath=function(t,e){return this.Ee(t,s.Path.Empty,e)},o.prototype.Ee=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.Ee(t.popFront(),e.child(i),n):null},o.prototype.foreachOnPath=function(t,e){return this.Ne(t,s.Path.Empty,e)},o.prototype.Ne=function(t,e,n){if(t.isEmpty())return this;this.value&&n(e,this.value);var r=t.getFront(),i=this.children.get(r);return i?i.Ne(t.popFront(),e.child(r),n):o.Empty},o.prototype.foreach=function(t){this.Pe(s.Path.Empty,t)},o.prototype.Pe=function(n,r){this.children.inorderTraversal(function(t,e){e.Pe(n.child(t),r)}),this.value&&r(n,this.value)},o.prototype.foreachChild=function(n){this.children.inorderTraversal(function(t,e){e.value&&n(t,e.value)})},o.Empty=new o(null),o}();e.ImmutableTree=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),u=n(9),r=n(4),o=n(3),i=function(){function t(t){this.me=t}return t.prototype.updateChild=function(t,e,n,r,i,o){a.assert(t.isIndexed(this.me),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(u.Change.childRemovedChange(e,s)):a.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(u.Change.childAddedChange(e,n)):o.trackChildChange(u.Change.childChangedChange(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.me))},t.prototype.updateFullNode=function(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(o.PRIORITY_INDEX,function(t,e){n.hasChild(t)||i.trackChildChange(u.Change.childRemovedChange(t,e))}),n.isLeafNode()||n.forEachChild(o.PRIORITY_INDEX,function(t,e){if(r.hasChild(t)){var n=r.getImmediateChild(t);n.equals(e)||i.trackChildChange(u.Change.childChangedChange(t,e,n))}else i.trackChildChange(u.Change.childAddedChange(t,e))})),n.withIndex(this.me)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?r.ChildrenNode.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.me},t}();e.IndexedFilter=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(99),i=function(){function t(){}return t.getCollection=function(t){var e=""+t;return this.be[e]||(this.be[e]=new r.StatsCollection),this.be[e]},t.getOrCreateReporter=function(t,e){var n=""+t;return this.Se[n]||(this.Se[n]=e()),this.Se[n]},t.be={},t.Se={},t}();e.StatsManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(18),s=n(1),a=n(33),u=n(7);n(109);var r,c=function(){function t(){this.Te={},this.we=!1}return t.getInstance=function(){return r||(r=new t),r},t.prototype.interrupt=function(){for(var t in this.Te)for(var e in this.Te[t])this.Te[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.Te)for(var e in this.Te[t])this.Te[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options.databaseURL;void 0===n&&s.fatal("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().");var r=a.parseRepoInfo(n),i=r.repoInfo;return u.validateUrl("Invalid Firebase Database URL",1,r),r.path.isEmpty()||s.fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,t).database},t.prototype.deleteRepo=function(t){var e=i.safeGet(this.Te,t.app.name);e&&i.safeGet(e,t.H.toURLString())===t||s.fatal("Database "+t.app.name+"("+t.H+") has already been deleted."),t.interrupt(),delete e[t.H.toURLString()]},t.prototype.createRepo=function(t,e){var n=i.safeGet(this.Te,e.name);n||(n={},this.Te[e.name]=n);var r=i.safeGet(n,t.toURLString());return r&&s.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new o.Repo(t,this.we,e),n[t.toURLString()]=r},t.prototype.forceRestClient=function(t){this.we=t},t}();e.RepoManager=c},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(33),r=n(2),s=n(21),a=n(18),u=n(26),c=n(0),h=n(7),l=function(){function t(t){(this.Ie=t)instanceof a.Repo||i.fatal("Don't call new Database() directly - please use firebase.database()."),this.B=new s.Reference(t,r.Path.Empty),this.INTERNAL=new p(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.Ie.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.Re("ref"),c.validateArgCount("database.ref",0,1,arguments.length),void 0!==t?this.B.child(t):this.B},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.Re(e),c.validateArgCount(e,1,1,arguments.length);var n=o.parseRepoInfo(t);h.validateUrl(e,1,n);var r=n.repoInfo;return r.host!==this.Ie.H.host&&i.fatal(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.Ie.H.host+")"),this.ref(""+n.path)},t.prototype.Re=function(t){null===this.Ie&&i.fatal("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){c.validateArgCount("database.goOffline",0,0,arguments.length),this.Re("goOffline"),this.Ie.interrupt()},t.prototype.goOnline=function(){c.validateArgCount("database.goOnline",0,0,arguments.length),this.Re("goOnline"),this.Ie.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}();e.Database=l;var p=function(){function t(t){this.database=t}return t.prototype.delete=function(){return this.database.Re("delete"),u.RepoManager.getInstance().deleteRepo(this.database.Ie),this.database.Ie=null,this.database.B=null,this.database.INTERNAL=null,this.database=null,Promise.resolve()},t}();e.DatabaseInternals=p},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=e(2),s=e(34),a=e(1);i.parseRepoInfo=function(t){var e=i.parseURL(t),n=e.subdomain;"firebase"===e.domain&&a.fatal(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||a.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||a.warnIfPageIsSecure();var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new s.RepoInfo(e.host,e.secure,n,r),path:new o.Path(e.pathString)}},i.parseURL=function(t){var e="",n="",r="",i="",o=!0,s="https",a=443;if("string"==typeof t){var u=t.indexOf("//");0<=u&&(s=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length),e=t.substring(0,c),i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(c));var h=e.split(".");3===h.length?(n=h[1],r=h[0].toLowerCase()):2===h.length&&(n=h[0]),0<=(u=e.indexOf(":"))&&(o="https"===s||"wss"===s,a=parseInt(e.substring(u+1),10))}return{host:e,port:a,domain:n,subdomain:r,secure:o,scheme:s,pathString:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(0),s=n(13),a=n(14),r=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=s.PersistentStorage.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&s.PersistentStorage.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(i.assert("string"==typeof t,"typeof type must == string"),i.assert("object"==typeof e,"typeof params must == object"),t===a.WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==a.LONG_POLLING)throw Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return o.forEach(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();e.RepoInfo=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(7),a=n(1),u=n(0),r=function(){function t(t,e){this.Ie=t,this.Oe=e}return t.prototype.cancel=function(t){o.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),o.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new u.Deferred;return this.Ie.onDisconnectCancel(this.Oe,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){o.validateArgCount("OnDisconnect.remove",0,1,arguments.length),s.validateWritablePath("OnDisconnect.remove",this.Oe),o.validateCallback("OnDisconnect.remove",1,t,!0);var e=new u.Deferred;return this.Ie.onDisconnectSet(this.Oe,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){o.validateArgCount("OnDisconnect.set",1,2,arguments.length),s.validateWritablePath("OnDisconnect.set",this.Oe),s.validateFirebaseDataArg("OnDisconnect.set",1,t,this.Oe,!1),o.validateCallback("OnDisconnect.set",2,e,!0);var n=new u.Deferred;return this.Ie.onDisconnectSet(this.Oe,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){o.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),s.validateWritablePath("OnDisconnect.setWithPriority",this.Oe),s.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,t,this.Oe,!1),s.validatePriority("OnDisconnect.setWithPriority",2,e,!1),o.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new u.Deferred;return this.Ie.onDisconnectSetWithPriority(this.Oe,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(o.validateArgCount("OnDisconnect.update",1,2,arguments.length),s.validateWritablePath("OnDisconnect.update",this.Oe),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,a.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}s.validateFirebaseMergeDataArg("OnDisconnect.update",1,t,this.Oe,!1),o.validateCallback("OnDisconnect.update",2,e,!0);var i=new u.Deferred;return this.Ie.onDisconnectUpdate(this.Oe,t,i.wrapCallback(e)),i.promise},t}();e.OnDisconnect=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(0),s=n(10),a=n(3),u=n(38),h=n(42),l=n(1),i=n(2),p=n(7),f=n(0),d=n(84),v=n(0),c=function(){function c(t,e,n,r){this.repo=t,this.path=e,this.Ae=n,this.De=r}return Object.defineProperty(c,"__referenceConstructor",{get:function(){return o.assert(r,"Reference.ts has not been loaded"),r},set:function(t){r=t},enumerable:!0,configurable:!0}),c.Me=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===s.KEY_INDEX){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=l.MIN_NAME)throw Error(r);if("string"!=typeof e)throw Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!=l.MAX_NAME)throw Error(r);if("string"!=typeof n)throw Error(i)}}else if(t.getIndex()===a.PRIORITY_INDEX){if(null!=e&&!p.isValidPriority(e)||null!=n&&!p.isValidPriority(n))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(o.assert(t.getIndex()instanceof h.PathIndex||t.getIndex()===u.VALUE_INDEX,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},c.Le=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},c.prototype.Fe=function(t){if(!0===this.De)throw Error(t+": You can't combine multiple orderBy calls.")},c.prototype.getQueryParams=function(){return this.Ae},c.prototype.getRef=function(){return f.validateArgCount("Query.ref",0,0,arguments.length),new c.__referenceConstructor(this.repo,this.path)},c.prototype.on=function(t,e,n,r){f.validateArgCount("Query.on",2,4,arguments.length),p.validateEventType("Query.on",1,t,!1),f.validateCallback("Query.on",2,e,!1);var i=c.xe("Query.on",n,r);if("value"===t)this.onValueEvent(e,i.cancel,i.context);else{var o={};o[t]=e,this.onChildEvent(o,i.cancel,i.context)}return e},c.prototype.onValueEvent=function(t,e,n){var r=new d.ValueEventRegistration(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},c.prototype.onChildEvent=function(t,e,n){var r=new d.ChildEventRegistration(t,e,n);this.repo.addEventCallbackForQuery(this,r)},c.prototype.off=function(t,e,n){f.validateArgCount("Query.off",0,3,arguments.length),p.validateEventType("Query.off",1,t,!0),f.validateCallback("Query.off",2,e,!0),f.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var o=e||null;r=new d.ValueEventRegistration(o,null,n||null)}else t&&(e&&((i={})[t]=e),r=new d.ChildEventRegistration(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},c.prototype.once=function(e,n,t,r){var i=this;f.validateArgCount("Query.once",1,4,arguments.length),p.validateEventType("Query.once",1,e,!1),f.validateCallback("Query.once",2,n,!0);var o=c.xe("Query.once",t,r),s=!0,a=new v.Deferred;a.promise.catch(function(){});var u=function(t){s&&(s=!1,i.off(e,u),n&&n.bind(o.context)(t),a.resolve(t))};return this.on(e,u,function(t){i.off(e,u),o.cancel&&o.cancel.bind(o.context)(t),a.reject(t)}),a.promise},c.prototype.limitToFirst=function(t){if(f.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.Ae.hasLimit())throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new c(this.repo,this.path,this.Ae.limitToFirst(t),this.De)},c.prototype.limitToLast=function(t){if(f.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.Ae.hasLimit())throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new c(this.repo,this.path,this.Ae.limitToLast(t),this.De)},c.prototype.orderByChild=function(t){if(f.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===t)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');p.validatePathString("Query.orderByChild",1,t,!1),this.Fe("Query.orderByChild");var e=new i.Path(t);if(e.isEmpty())throw Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new h.PathIndex(e),r=this.Ae.orderBy(n);return c.Me(r),new c(this.repo,this.path,r,!0)},c.prototype.orderByKey=function(){f.validateArgCount("Query.orderByKey",0,0,arguments.length),this.Fe("Query.orderByKey");var t=this.Ae.orderBy(s.KEY_INDEX);return c.Me(t),new c(this.repo,this.path,t,!0)},c.prototype.orderByPriority=function(){f.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.Fe("Query.orderByPriority");var t=this.Ae.orderBy(a.PRIORITY_INDEX);return c.Me(t),new c(this.repo,this.path,t,!0)},c.prototype.orderByValue=function(){f.validateArgCount("Query.orderByValue",0,0,arguments.length),this.Fe("Query.orderByValue");var t=this.Ae.orderBy(u.VALUE_INDEX);return c.Me(t),new c(this.repo,this.path,t,!0)},c.prototype.startAt=function(t,e){void 0===t&&(t=null),f.validateArgCount("Query.startAt",0,2,arguments.length),p.validateFirebaseDataArg("Query.startAt",1,t,this.path,!0),p.validateKey("Query.startAt",2,e,!0);var n=this.Ae.startAt(t,e);if(c.Le(n),c.Me(n),this.Ae.hasStart())throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(e=t=null),new c(this.repo,this.path,n,this.De)},c.prototype.endAt=function(t,e){void 0===t&&(t=null),f.validateArgCount("Query.endAt",0,2,arguments.length),p.validateFirebaseDataArg("Query.endAt",1,t,this.path,!0),p.validateKey("Query.endAt",2,e,!0);var n=this.Ae.endAt(t,e);if(c.Le(n),c.Me(n),this.Ae.hasEnd())throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new c(this.repo,this.path,n,this.De)},c.prototype.equalTo=function(t,e){if(f.validateArgCount("Query.equalTo",1,2,arguments.length),p.validateFirebaseDataArg("Query.equalTo",1,t,this.path,!1),p.validateKey("Query.equalTo",2,e,!0),this.Ae.hasStart())throw Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.Ae.hasEnd())throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},c.prototype.toString=function(){return f.validateArgCount("Query.toString",0,0,arguments.length),""+this.repo+this.path.toUrlEncodedString()},c.prototype.toJSON=function(){return f.validateArgCount("Query.toJSON",0,1,arguments.length),""+this},c.prototype.queryObject=function(){return this.Ae.getQueryObject()},c.prototype.queryIdentifier=function(){var t=this.queryObject(),e=l.ObjectToUniqueKey(t);return"{}"===e?"default":e},c.prototype.isEqual=function(t){if(f.validateArgCount("Query.isEqual",1,1,arguments.length),!(t instanceof c))throw Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var e=this.repo===t.repo,n=this.path.equals(t.path),r=this.queryIdentifier()===t.queryIdentifier();return e&&n&&r},c.xe=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,f.validateCallback(t,3,r.cancel,!0),r.context=n,f.validateContextObject(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw Error(f.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(c.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),c}();e.Query=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(0),o=n(1),s=n(0);e.setMaxNode=function(t){r=t},e.priorityHashText=function(t){return"number"==typeof t?"number:"+o.doubleToIEEE754String(t):"string:"+t},e.validatePriorityNode=function(t){if(t.isLeafNode()){var e=t.val();i.assert("string"==typeof e||"number"==typeof e||"object"==typeof e&&s.contains(e,".sv"),"Priority must be a string or number.")}else i.assert(t===r||t.isEmpty(),"priority of unexpected type.");i.assert(t===r||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),s=n(5),a=n(1),u=n(11),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?a.nameCompare(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return s.NamedNode.MIN},e.prototype.maxPost=function(){return s.NamedNode.MAX},e.prototype.makePost=function(t,e){var n=u.nodeFromJSON(t);return new s.NamedNode(e,n)},e.prototype.toString=function(){return".value"},e}(o.Index);e.ValueIndex=c,e.VALUE_INDEX=new c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,p=n(0),f=n(40),d=n(0),v=n(5),i=n(3),h=n(10),y={},o=function(){function l(t,e){this.ke=t,this.We=e}return Object.defineProperty(l,"Default",{get:function(){return p.assert(i.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),r=r||new l({".priority":y},{".priority":i.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),l.prototype.get=function(t){var e=d.safeGet(this.ke,t);if(!e)throw Error("No index defined for "+t);return e===y?null:e},l.prototype.hasIndex=function(t){return d.contains(this.We,""+t)},l.prototype.addIndex=function(t,e){p.assert(t!==h.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n=[],r=!1,i=e.getIterator(v.NamedNode.Wrap),o=i.getNext();o;)r=r||t.isDefinedOn(o.node),n.push(o),o=i.getNext();var s;s=r?f.buildChildSet(n,t.getCompare()):y;var a=""+t,u=d.clone(this.We);u[a]=t;var c=d.clone(this.ke);return c[a]=s,new l(c,u)},l.prototype.addToIndexes=function(u,c){var h=this;return new l(d.map(this.ke,function(t,e){var n=d.safeGet(h.We,e);if(p.assert(n,"Missing index implementation for "+e),t===y){if(n.isDefinedOn(u.node)){for(var r=[],i=c.getIterator(v.NamedNode.Wrap),o=i.getNext();o;)o.name!=u.name&&r.push(o),o=i.getNext();return r.push(u),f.buildChildSet(r,n.getCompare())}return y}var s=c.get(u.name),a=t;return s&&(a=a.remove(new v.NamedNode(u.name,s))),a.insert(u,u.node)}),this.We)},l.prototype.removeFromIndexes=function(n,r){return new l(d.map(this.ke,function(t){if(t===y)return t;var e=r.get(n.name);return e?t.remove(new v.NamedNode(n.name,e)):t}),this.We)},l}();e.IndexMap=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=n(17),r=n(17),i=Math.log(2),o=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/i,10)),this.je=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.Ve=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.Ve&1<<this.je);return this.je--,t},t}();e.buildChildSet=function(c,t,h,e){c.sort(t);var l=function(t,e){var n,r,i=e-t;if(0==i)return null;if(1==i)return n=c[t],r=h?h(n):n,new p.LLRBNode(r,n.node,p.LLRBNode.BLACK,null,null);var o=parseInt(i/2,10)+t,s=l(t,o),a=l(o+1,e);return n=c[o],r=h?h(n):n,new p.LLRBNode(r,n.node,p.LLRBNode.BLACK,s,a)},n=function(t){for(var e=null,n=null,a=c.length,r=function(t,e){var n=a-t,r=a;a-=t;var i=l(1+n,r),o=c[n],s=h?h(o):o;u(new p.LLRBNode(s,o.node,e,null,i))},u=function(t){e=(e?e.left=t:n=t,t)},i=0;i<t.count;++i){var o=t.nextBitIsOne(),s=Math.pow(2,t.count-(i+1));o?r(s,p.LLRBNode.BLACK):(r(s,p.LLRBNode.BLACK),r(s,p.LLRBNode.RED))}return n}(new o(c.length));return new r.SortedMap(e||t,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.NAME_ONLY_COMPARATOR=function(t,e){return r.nameCompare(t.name,e.name)},e.NAME_COMPARATOR=function(t,e){return r.nameCompare(t,e)}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(1),a=n(15),u=n(4),c=n(5),h=n(11),l=function(n){function t(t){var e=n.call(this)||this;return e.Qe=t,o.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),e}return i(t,n),t.prototype.extractChild=function(t){return t.getChild(this.Qe)},t.prototype.isDefinedOn=function(t){return!t.getChild(this.Qe).isEmpty()},t.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?s.nameCompare(t.name,e.name):i},t.prototype.makePost=function(t,e){var n=h.nodeFromJSON(t),r=u.ChildrenNode.EMPTY_NODE.updateChild(this.Qe,n);return new c.NamedNode(e,r)},t.prototype.maxPost=function(){var t=u.ChildrenNode.EMPTY_NODE.updateChild(this.Qe,u.MAX_NODE);return new c.NamedNode(s.MAX_NAME,t)},t.prototype.toString=function(){return this.Qe.slice().join("/")},t}(a.Index);e.PathIndex=l},function(t,u,e){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var n=e(0),i=e(2),o=e(44),c=e(16),h=e(11),l=e(3);u.generateWithValues=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},u.resolveDeferredValue=function(t,e){return t&&"object"==typeof t?(n.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},u.resolveDeferredValueTree=function(t,n){var r=new o.SparseSnapshotTree;return t.forEachTree(new i.Path(""),function(t,e){r.remember(t,u.resolveDeferredValueSnapshot(e,n))}),r},u.resolveDeferredValueSnapshot=function(t,r){var i,e=t.getPriority().val(),n=u.resolveDeferredValue(e,r);if(t.isLeafNode()){var o=t,s=u.resolveDeferredValue(o.getValue(),r);return s!==o.getValue()||n!==o.getPriority().val()?new c.LeafNode(s,h.nodeFromJSON(n)):t}var a=t;return n!==(i=a).getPriority().val()&&(i=i.updatePriority(new c.LeafNode(n))),a.forEachChild(l.PRIORITY_INDEX,function(t,e){var n=u.resolveDeferredValueSnapshot(e,r);n!==e&&(i=i.updateImmediateChild(t,n))}),i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),s=n(3),a=n(45),r=function(){function i(){this.T=null,this._=null}return i.prototype.find=function(t){if(null!=this.T)return this.T.getChild(t);if(t.isEmpty()||null==this._)return null;var e=t.getFront();return t=t.popFront(),this._.contains(e)?this._.get(e).find(t):null},i.prototype.remember=function(t,e){if(t.isEmpty())this.T=e,this._=null;else if(null!==this.T)this.T=this.T.updateChild(t,e);else{null==this._&&(this._=new a.CountedSet);var n=t.getFront();this._.contains(n)||this._.add(n,new i);var r=this._.get(n);t=t.popFront(),r.remember(t,e)}},i.prototype.forget=function(t){if(t.isEmpty())return this.T=null,!(this._=null);if(null!==this.T){if(this.T.isLeafNode())return!1;var e=this.T;this.T=null;var n=this;return e.forEachChild(s.PRIORITY_INDEX,function(t,e){n.remember(new o.Path(t),e)}),this.forget(t)}if(null===this._)return!0;var r=t.getFront();return t=t.popFront(),this._.contains(r)&&this._.get(r).forget(t)&&this._.remove(r),!!this._.isEmpty()&&!(this._=null)},i.prototype.forEachTree=function(r,i){null!==this.T?i(r,this.T):this.forEachChild(function(t,e){var n=new o.Path(r+"/"+t);e.forEachTree(n,i)})},i.prototype.forEachChild=function(n){null!==this._&&this._.each(function(t,e){n(t,e)})},i}();e.SparseSnapshotTree=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return r.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return r.isEmpty(this.set)},t.prototype.count=function(){return r.getCount(this.set)},t.prototype.each=function(n){r.forEach(this.set,function(t,e){return n(t,e)})},t.prototype.keys=function(){var e=[];return r.forEach(this.set,function(t){e.push(t)}),e},t}();e.CountedSet=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(2),o=function(){function e(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=r.OperationType.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,i.Path.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}();e.Overwrite=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,h=n(19),l=n(4),s=n(0),p=n(0),f=n(48),d=n(90),i=function(){function c(){this.qe={}}return Object.defineProperty(c,"__referenceConstructor",{get:function(){return s.assert(r,"Reference.ts has not been loaded"),r},set:function(t){s.assert(!r,"__referenceConstructor has already been defined"),r=t},enumerable:!0,configurable:!0}),c.prototype.isEmpty=function(){return p.isEmpty(this.qe)},c.prototype.applyOperation=function(n,r,i){var t=n.source.queryId;if(null!==t){var e=p.safeGet(this.qe,t);return s.assert(null!=e,"SyncTree gave us an op for an invalid query."),e.applyOperation(n,r,i)}var o=[];return p.forEach(this.qe,function(t,e){o=o.concat(e.applyOperation(n,r,i))}),o},c.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=p.safeGet(this.qe,o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;u=!!a||(a=r instanceof l.ChildrenNode?n.calcCompleteEventChildren(r):l.ChildrenNode.EMPTY_NODE,!1);var c=new f.ViewCache(new h.CacheNode(a,u,!1),new h.CacheNode(r,i,!1));s=new d.View(t,c),this.qe[o]=s}return s.addEventRegistration(e),s.getInitialEvents(e)},c.prototype.removeEventRegistration=function(t,n,r){var e=t.queryIdentifier(),i=[],o=[],s=this.hasCompleteView();if("default"===e){var a=this;p.forEach(this.qe,function(t,e){o=o.concat(e.removeEventRegistration(n,r)),e.isEmpty()&&(delete a.qe[t],e.getQuery().getQueryParams().loadsAllData()||i.push(e.getQuery()))})}else{var u=p.safeGet(this.qe,e);u&&(o=o.concat(u.removeEventRegistration(n,r)),u.isEmpty()&&(delete this.qe[e],u.getQuery().getQueryParams().loadsAllData()||i.push(u.getQuery())))}return s&&!this.hasCompleteView()&&i.push(new c.__referenceConstructor(t.repo,t.path)),{removed:i,events:o}},c.prototype.getQueryViews=function(){var e=this;return Object.keys(this.qe).map(function(t){return e.qe[t]}).filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},c.prototype.getCompleteServerCache=function(n){var r=null;return p.forEach(this.qe,function(t,e){r=r||e.getCompleteServerCache(n)}),r},c.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return p.safeGet(this.qe,e)},c.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},c.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},c.prototype.getCompleteView=function(){return p.findValue(this.qe,function(t){return t.getQuery().getQueryParams().loadsAllData()})||null},c}();e.SyncPoint=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=n(19),r=function(){function r(t,e){this.Ue=t,this.Be=e}return r.prototype.updateEventSnap=function(t,e,n){return new r(new o.CacheNode(t,e,n),this.Be)},r.prototype.updateServerSnap=function(t,e,n){return new r(this.Ue,new o.CacheNode(t,e,n))},r.prototype.getEventCache=function(){return this.Ue},r.prototype.getCompleteEventSnap=function(){return this.Ue.isFullyInitialized()?this.Ue.getNode():null},r.prototype.getServerCache=function(){return this.Be},r.prototype.getCompleteServerSnap=function(){return this.Be.isFullyInitialized()?this.Be.getNode():null},r.Empty=new r(new o.CacheNode(i.ChildrenNode.EMPTY_NODE,!1,!1),new o.CacheNode(i.ChildrenNode.EMPTY_NODE,!1,!1)),r}();e.ViewCache=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){this.He=t,this.Ge=null}return t.prototype.get=function(){var t=this.He.get(),n=r.clone(t);return this.Ge&&r.forEach(this.Ge,function(t,e){n[t]=n[t]-e}),this.Ge=t,n},t}();e.StatsListener=i},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),s=n(0),u=n(0),l=n(0),p=n(1),c=n(2),f=n(102),d=n(103),v=n(0),y=n(52),g=n(0),m=n(0),a=n(55),h=function(a){function h(t,e,n,r,i,o){var s=a.call(this)||this;if(s.H=t,s.ee=e,s.te=n,s.ne=r,s.Ke=i,s.Ye=o,s.id=h.Xe++,s.de=p.logWrapper("p:"+s.id+":"),s.ze={},s.Je={},s.$e=[],s.Ze=0,s.et=[],s.tt=!1,s.nt=1e3,s.rt=3e5,s.it=null,s.lastSessionId=null,s.ot=null,s.at=!1,s.st={},s.ut=0,s.lt=null,s.ht=null,s.ct=!1,s.pt=0,s.dt=!0,s.ft=null,s._t=null,o&&!m.isNodeSdk())throw Error("Auth override specified in options, but not supported on non Node.js platforms");return s.yt(0),f.VisibilityMonitor.getInstance().on("visible",s.vt,s),-1===t.host.indexOf("fblocal")&&d.OnlineMonitor.getInstance().on("online",s.gt,s),s}return i(h,a),h.prototype.sendRequest=function(t,e,n){var r=++this.ut,i={r:r,a:t,b:e};this.de(u.stringify(i)),l.assert(this.tt,"sendRequest call when we're not connected not allowed."),this.lt.sendRequest(i),n&&(this.st[r]=n)},h.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=""+t.path;this.de("Listen called for "+o+" "+i),this.Je[o]=this.Je[o]||{},l.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),l.assert(!this.Je[o][i],"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.Je[o][i]=s,this.tt&&this.mt(s)},h.prototype.mt=function(r){var i=this,o=r.query,s=""+o.path,a=o.queryIdentifier();this.de("Listen on "+s+" for "+a);var t={p:s};r.tag&&(t.q=o.queryObject(),t.t=r.tag),t.h=r.hashFn(),this.sendRequest("q",t,function(t){var e=t.d,n=t.s;h.Ct(e,o),(i.Je[s]&&i.Je[s][a])===r&&(i.de("listen response",t),"ok"!==n&&i.Et(s,a),r.onComplete&&r.onComplete(n,e))})},h.Ct=function(t,e){if(t&&"object"==typeof t&&s.contains(t,"w")){var n=s.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex()+'"',i=""+e.path;p.warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},h.prototype.refreshAuthToken=function(t){this.ht=t,this.de("Auth token refreshed"),this.ht?this.tryAuth():this.tt&&this.sendRequest("unauth",{},function(){}),this.Nt(t)},h.prototype.Nt=function(t){(t&&40===t.length||v.isAdmin(t))&&(this.de("Admin auth credential detected.  Reducing max reconnect time."),this.rt=3e4)},h.prototype.tryAuth=function(){var r=this;if(this.tt&&this.ht){var i=this.ht,t=v.isValidFormat(i)?"auth":"gauth",e={cred:i};null===this.Ye?e.noauth=!0:"object"==typeof this.Ye&&(e.authvar=this.Ye),this.sendRequest(t,e,function(t){var e=t.s,n=t.d||"error";r.ht===i&&("ok"===e?r.pt=0:r.Pt(e,n))})}},h.prototype.unlisten=function(t,e){var n=""+t.path,r=t.queryIdentifier();this.de("Unlisten called for "+n+" "+r),l.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.Et(n,r)&&this.tt&&this.bt(n,r,t.queryObject(),e)},h.prototype.bt=function(t,e,n,r){this.de("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},h.prototype.onDisconnectPut=function(t,e,n){this.tt?this.St("o",t,e,n):this.et.push({pathString:t,action:"o",data:e,onComplete:n})},h.prototype.onDisconnectMerge=function(t,e,n){this.tt?this.St("om",t,e,n):this.et.push({pathString:t,action:"om",data:e,onComplete:n})},h.prototype.onDisconnectCancel=function(t,e){this.tt?this.St("oc",t,null,e):this.et.push({pathString:t,action:"oc",data:null,onComplete:e})},h.prototype.St=function(t,e,n,r){var i={p:e,d:n};this.de("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},h.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},h.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},h.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.$e.push({action:t,request:o,onComplete:r}),this.Ze++;var s=this.$e.length-1;this.tt?this.Tt(s):this.de("Buffering put: "+e)},h.prototype.Tt=function(e){var n=this,r=this.$e[e].action,t=this.$e[e].request,i=this.$e[e].onComplete;this.$e[e].queued=this.tt,this.sendRequest(r,t,function(t){n.de(r+" response",t),delete n.$e[e],n.Ze--,0===n.Ze&&(n.$e=[]),i&&i(t.s,t.d)})},h.prototype.reportStats=function(t){var n=this;if(this.tt){var e={c:t};this.de("reportStats",e),this.sendRequest("s",e,function(t){if("ok"!==t.s){var e=t.d;n.de("reportStats","Error sending stats: "+e)}})}},h.prototype.wt=function(t){if("r"in t){this.de("from server: "+u.stringify(t));var e=t.r,n=this.st[e];n&&(delete this.st[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.It(t.a,t.b)}},h.prototype.It=function(t,e){this.de("handleServerMessage",t,e),"d"===t?this.ee(e.p,e.d,!1,e.t):"m"===t?this.ee(e.p,e.d,!0,e.t):"c"===t?this.Rt(e.p,e.q):"ac"===t?this.Pt(e.s,e.d):"sd"===t?this.Ot(e):p.error("Unrecognized action received from server: "+u.stringify(t)+"\nAre you using the latest client?")},h.prototype.At=function(t,e){this.de("connection ready"),this.tt=!0,this._t=(new Date).getTime(),this.Dt(t),this.lastSessionId=e,this.dt&&this.Mt(),this.Lt(),this.dt=!1,this.te(!0)},h.prototype.yt=function(t){var e=this;l.assert(!this.lt,"Scheduling a connect when we're already connected/ing?"),this.ot&&clearTimeout(this.ot),this.ot=setTimeout(function(){e.ot=null,e.Ft()},Math.floor(t))},h.prototype.vt=function(t){t&&!this.at&&this.nt===this.rt&&(this.de("Window became visible.  Reducing delay."),this.nt=1e3,this.lt||this.yt(0)),this.at=t},h.prototype.gt=function(t){t?(this.de("Browser went online."),this.nt=1e3,this.lt||this.yt(0)):(this.de("Browser went offline.  Killing connection."),this.lt&&this.lt.close())},h.prototype.xt=function(){if(this.de("data client disconnected"),this.tt=!1,this.lt=null,this.kt(),this.st={},this.Wt()){if(this.at){if(this._t)3e4<(new Date).getTime()-this._t&&(this.nt=1e3),this._t=null}else this.de("Window isn't visible.  Delaying reconnect."),this.nt=this.rt,this.ft=(new Date).getTime();var t=(new Date).getTime()-this.ft,e=Math.max(0,this.nt-t);e=Math.random()*e,this.de("Trying to reconnect in "+e+"ms"),this.yt(e),this.nt=Math.min(this.rt,1.3*this.nt)}this.te(!1)},h.prototype.Ft=function(){if(this.Wt()){this.de("Making a connection attempt"),this.ft=(new Date).getTime(),this._t=null;var e=this.wt.bind(this),n=this.At.bind(this),r=this.xt.bind(this),i=this.id+":"+h.jt++,o=this,s=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,r())};this.lt={close:c,sendRequest:function(t){l.assert(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)}};var t=this.ct;this.ct=!1,this.Ke.getToken(t).then(function(t){a?p.log("getToken() completed but was canceled"):(p.log("getToken() completed. Creating connection."),o.ht=t&&t.accessToken,u=new y.Connection(i,o.H,e,n,r,function(t){p.warn(t+" ("+o.H+")"),o.interrupt("server_kill")},s))}).then(null,function(t){o.de("Failed to get token: "+t),a||(g.CONSTANTS.NODE_ADMIN&&p.warn(t),c())})}},h.prototype.interrupt=function(t){p.log("Interrupting connection for reason: "+t),this.ze[t]=!0,this.lt?this.lt.close():(this.ot&&(clearTimeout(this.ot),this.ot=null),this.tt&&this.xt())},h.prototype.resume=function(t){p.log("Resuming connection for reason: "+t),delete this.ze[t],s.isEmpty(this.ze)&&(this.nt=1e3,this.lt||this.yt(0))},h.prototype.Dt=function(t){var e=t-(new Date).getTime();this.ne({serverTimeOffset:e})},h.prototype.kt=function(){for(var t=0;t<this.$e.length;t++){var e=this.$e[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.$e[t],this.Ze--)}0===this.Ze&&(this.$e=[])},h.prototype.Rt=function(t,e){var n;n=e?e.map(function(t){return p.ObjectToUniqueKey(t)}).join("$"):"default";var r=this.Et(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},h.prototype.Et=function(t,e){var n,r=""+new c.Path(t);return void 0!==this.Je[r]?(n=this.Je[r][e],delete this.Je[r][e],0===s.getCount(this.Je[r])&&delete this.Je[r]):n=void 0,n},h.prototype.Pt=function(t,e){p.log("Auth token revoked: "+t+"/"+e),this.ht=null,this.ct=!0,this.lt.close(),"invalid_token"!==t&&"permission_denied"!==t||3<=++this.pt&&(this.nt=3e4,this.Ke.notifyForInvalidToken())},h.prototype.Ot=function(t){this.it?this.it(t):"msg"in t&&"undefined"!=typeof console&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},h.prototype.Lt=function(){var n=this;this.tryAuth(),s.forEach(this.Je,function(t,e){s.forEach(e,function(t,e){n.mt(e)})});for(var t=0;t<this.$e.length;t++)this.$e[t]&&this.Tt(t);for(;this.et.length;){var e=this.et.shift();this.St(e.action,e.pathString,e.data,e.onComplete)}},h.prototype.Mt=function(){var t={},e="js";g.CONSTANTS.NODE_ADMIN?e="admin_node":g.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+o.default.SDK_VERSION.replace(/\./g,"-")]=1,m.isMobileCordova()?t["framework.cordova"]=1:m.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},h.prototype.Wt=function(){var t=d.OnlineMonitor.getInstance().currentlyOnline();return s.isEmpty(this.ze)&&t},h.Xe=0,h.jt=0,h}(a.ServerActions);e.PersistentConnection=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){this.Vt=t,this.Qt={},r.assert(Array.isArray(t)&&0<t.length,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.Qt[t]))for(var r=this.Qt[t].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.qt(t),this.Qt[t]=this.Qt[t]||[],this.Qt[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.qt(t);for(var r=this.Qt[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.qt=function(e){r.assert(this.Vt.find(function(t){return t===e}),"Unknown event: "+e)},t}();e.EventEmitter=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),r=n(13),i=n(14),u=n(104),o=function(){function t(t,e,n,r,i,o,s){this.id=t,this.H=e,this.Ut=n,this.At=r,this.z=i,this.Bt=o,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.Ht=0,this.de=a.logWrapper("c:"+this.id+":"),this.Gt=new u.TransportManager(e),this.de("Connection created"),this.Kt()}return t.prototype.Kt=function(){var t=this,e=this.Gt.initialTransport();this.Yt=new e(this.Xt(),this.H,void 0,this.lastSessionId),this.zt=e.responsesRequiredToBeHealthy||0;var n=this.Jt(this.Yt),r=this.$t(this.Yt);this.Zt=this.Yt,this.en=this.Yt,this.tn=null,this.nn=!1,setTimeout(function(){t.Yt&&t.Yt.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;0<i&&(this.rn=a.setTimeoutNonBlocking(function(){t.rn=null,t.nn||(t.Yt&&102400<t.Yt.bytesReceived?(t.de("Connection exceeded healthy timeout but has received "+t.Yt.bytesReceived+" bytes.  Marking connection healthy."),t.nn=!0,t.Yt.markConnectionHealthy()):t.Yt&&10240<t.Yt.bytesSent?t.de("Connection exceeded healthy timeout but has sent "+t.Yt.bytesSent+" bytes.  Leaving connection alive."):(t.de("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.Xt=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.$t=function(e){var n=this;return function(t){e===n.Yt?n.in(t):e===n.tn?(n.de("Secondary connection lost."),n.an()):n.de("closing an old connection")}},t.prototype.Jt=function(e){var n=this;return function(t){2!=n.Ht&&(e===n.en?n.sn(t):e===n.tn?n.un(t):n.de("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.ln(e)},t.prototype.tryCleanupConnection=function(){this.Zt===this.tn&&this.en===this.tn&&(this.de("cleaning up and promoting a connection: "+this.tn.connId),this.Yt=this.tn,this.tn=null)},t.prototype.hn=function(t){if("t"in t){var e=t.t;"a"===e?this.cn():"r"===e?(this.de("Got a reset on secondary, closing it"),this.tn.close(),this.Zt!==this.tn&&this.en!==this.tn||this.close()):"o"===e&&(this.de("got pong on secondary."),this.pn--,this.cn())}},t.prototype.un=function(t){var e=a.requireKey("t",t),n=a.requireKey("d",t);if("c"==e)this.hn(n);else{if("d"!=e)throw Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.cn=function(){this.pn<=0?(this.de("Secondary connection is healthy."),this.nn=!0,this.tn.markConnectionHealthy(),this.dn()):(this.de("sending ping on secondary."),this.tn.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.dn=function(){this.tn.start(),this.de("sending client ack on secondary"),this.tn.send({t:"c",d:{t:"a",d:{}}}),this.de("Ending transmission on primary"),this.Yt.send({t:"c",d:{t:"n",d:{}}}),this.Zt=this.tn,this.tryCleanupConnection()},t.prototype.sn=function(t){var e=a.requireKey("t",t),n=a.requireKey("d",t);"c"==e?this.fn(n):"d"==e&&this.wt(n)},t.prototype.wt=function(t){this._n(),this.Ut(t)},t.prototype._n=function(){this.nn||--this.zt<=0&&(this.de("Primary connection is healthy."),this.nn=!0,this.Yt.markConnectionHealthy())},t.prototype.fn=function(t){var e=a.requireKey("t",t);if("d"in t){var n=t.d;if("h"===e)this.yn(n);else if("n"===e){this.de("recvd end transmission on primary"),this.en=this.tn;for(var r=0;r<this.pendingDataMessages.length;++r)this.wt(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.vn(n):"r"===e?this.gn(n):"e"===e?a.error("Server Error: "+n):"o"===e?(this.de("got pong on primary."),this._n(),this.mn()):a.error("Unknown control packet command: "+e)}},t.prototype.yn=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.H.updateHost(r),0==this.Ht&&(this.Yt.start(),this.Cn(this.Yt,e),i.PROTOCOL_VERSION!==n&&a.warn("Protocol version mismatch detected"),this.En())},t.prototype.En=function(){var t=this.Gt.upgradeTransport();t&&this.Nn(t)},t.prototype.Nn=function(t){var e=this;this.tn=new t(this.Xt(),this.H,this.sessionId),this.pn=t.responsesRequiredToBeHealthy||0;var n=this.Jt(this.tn),r=this.$t(this.tn);this.tn.open(n,r),a.setTimeoutNonBlocking(function(){e.tn&&(e.de("Timed out trying to upgrade."),e.tn.close())},Math.floor(6e4))},t.prototype.gn=function(t){this.de("Reset packet received.  New host: "+t),this.H.updateHost(t),1===this.Ht?this.close():(this.Pn(),this.Kt())},t.prototype.Cn=function(t,e){var n=this;this.de("Realtime connection established."),this.Yt=t,this.Ht=1,this.At&&(this.At(e,this.sessionId),this.At=null),0===this.zt?(this.de("Primary connection is healthy."),this.nn=!0):a.setTimeoutNonBlocking(function(){n.mn()},Math.floor(5e3))},t.prototype.mn=function(){this.nn||1!==this.Ht||(this.de("sending ping on primary."),this.ln({t:"c",d:{t:"p",d:{}}}))},t.prototype.an=function(){var t=this.tn;this.tn=null,this.Zt!==t&&this.en!==t||this.close()},t.prototype.in=function(t){this.Yt=null,t||0!==this.Ht?1===this.Ht&&this.de("Realtime connection lost."):(this.de("Realtime connection failed."),this.H.isCacheableHost()&&(r.PersistentStorage.remove("host:"+this.H.host),this.H.internalHost=this.H.host)),this.close()},t.prototype.vn=function(t){this.de("Connection shutdown command received. Shutting down..."),this.Bt&&(this.Bt(t),this.Bt=null),this.z=null,this.close()},t.prototype.ln=function(t){if(1!==this.Ht)throw"Connection is not connected";this.Zt.send(t)},t.prototype.close=function(){2!==this.Ht&&(this.de("Closing realtime connection."),this.Ht=2,this.Pn(),this.z&&(this.z(),this.z=null))},t.prototype.Pn=function(){this.de("Shutting down all connections"),this.Yt&&(this.Yt.close(),this.Yt=null),this.tn&&(this.tn.close(),this.tn=null),this.rn&&(clearTimeout(this.rn),this.rn=null)},t}();e.Connection=o},function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var u=e(1),c=e(45),i=e(25),n=e(105),s=e(14),o=e(0),h=e(0);a.FIREBASE_LONGPOLL_START_PARAM="start",a.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",a.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",a.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",a.FIREBASE_LONGPOLL_ID_PARAM="id",a.FIREBASE_LONGPOLL_PW_PARAM="pw",a.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",a.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",a.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",a.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",a.FIREBASE_LONGPOLL_DATA_PARAM="d",a.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",a.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var r=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.bn=!1,this.de=u.logWrapper(t),this.$=i.StatsManager.getCollection(e),this.urlFn=function(t){return e.connectionURL(s.LONG_POLLING,t)}}return t.prototype.open=function(t,e){var o=this;this.curSegmentNum=0,this.z=e,this.myPacketOrderer=new n.PacketReceiver(t),this.Sn=!1,this.Tn=setTimeout(function(){o.de("Timed out trying to connect."),o.wn(),o.Tn=null},Math.floor(3e4)),u.executeWhenDOMReady(function(){if(!o.Sn){o.scriptTagHolder=new l(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1],i=t[2];if(t[3],t[4],o.In(t),o.scriptTagHolder)if(o.Tn&&(clearTimeout(o.Tn),o.Tn=null),o.bn=!0,n==a.FIREBASE_LONGPOLL_START_PARAM)o.id=r,o.password=i;else{if(n!==a.FIREBASE_LONGPOLL_CLOSE_COMMAND)throw Error("Unrecognized command received: "+n);r?(o.scriptTagHolder.sendNewPolls=!1,o.myPacketOrderer.closeAfter(r,function(){o.wn()})):o.wn()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1];o.In(t),o.myPacketOrderer.handleResponse(n,r)},function(){o.wn()},o.urlFn);var t={};t[a.FIREBASE_LONGPOLL_START_PARAM]="t",t[a.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),o.scriptTagHolder.uniqueCallbackIdentifier&&(t[a.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=o.scriptTagHolder.uniqueCallbackIdentifier),t[s.VERSION_PARAM]=s.PROTOCOL_VERSION,o.transportSessionId&&(t[s.TRANSPORT_SESSION_PARAM]=o.transportSessionId),o.lastSessionId&&(t[s.LAST_SESSION_PARAM]=o.lastSessionId),!h.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(t[s.REFERER_PARAM]=s.FORGE_REF);var e=o.urlFn(t);o.de("Connecting via long-poll to "+e),o.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.Rn=!0},t.forceDisallow=function(){t.On=!0},t.isAvailable=function(){return t.Rn||!t.On&&"undefined"!=typeof document&&null!=document.createElement&&!u.isChromeExtensionContentScript()&&!u.isWindowsStoreApp()&&!h.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.An=function(){this.Sn=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.Tn&&(clearTimeout(this.Tn),this.Tn=null)},t.prototype.wn=function(){this.Sn||(this.de("Longpoll is closing itself"),this.An(),this.z&&(this.z(this.bn),this.z=null))},t.prototype.close=function(){this.Sn||(this.de("Longpoll is being closed."),this.An())},t.prototype.send=function(t){var e=o.stringify(t);this.bytesSent+=e.length,this.$.incrementCounter("bytes_sent",e.length);for(var n=o.base64Encode(e),r=u.splitStringBySize(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!h.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={};n[a.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",n[a.FIREBASE_LONGPOLL_ID_PARAM]=t,n[a.FIREBASE_LONGPOLL_PW_PARAM]=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.In=function(t){var e=o.stringify(t).length;this.bytesReceived+=e,this.$.incrementCounter("bytes_received",e)},t}();a.BrowserPollConnection=r;var l=function(){function s(t,e,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new c.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,h.isNodeSdk())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=u.LUIDGenerator(),window[a.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=t,window[a.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=e,this.myIFrame=s.Dn();var i="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(i='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(t){u.log("frame writing exception"),t.stack&&u.log(t.stack),u.log(t)}}}return s.Dn=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||u.log("No IE domain setting required")}catch(t){var n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},s.prototype.close=function(){var t=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0))),h.isNodeSdk()&&this.myID){var e={};e[a.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",e[a.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,e[a.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var n=this.urlFn(e);s.nodeRestRequest(n)}var r=this.onDisconnect;r&&(this.onDisconnect=null,r())},s.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.Mn(););},s.prototype.Mn=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var t={};t[a.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,t[a.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,t[a.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;0<this.pendingSegs.length&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&"+a.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+r+"="+i.seg+"&"+a.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+r+"="+i.ts+"&"+a.FIREBASE_LONGPOLL_DATA_PARAM+r+"="+i.d,r++}return e+=n,this.Ln(e,this.currentSerial),!0}return!1},s.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.Mn()},s.prototype.Ln=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=function(){n.outstandingRequests.remove(e),n.Mn()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},s.prototype.addTag=function(t,n){var r=this;h.isNodeSdk()?this.doNodeLongPoll(t,n):setTimeout(function(){try{if(!r.sendNewPolls)return;var e=r.myIFrame.doc.createElement("script");e.type="text/javascript",e.async=!0,e.src=t,e.onload=e.onreadystatechange=function(){var t=e.readyState;t&&"loaded"!==t&&"complete"!==t||(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),n())},e.onerror=function(){u.log("Long-poll script failed to load: "+t),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(e)}catch(t){}},Math.floor(1))},s}();a.FirebaseIFrameScriptHolder=l},function(t,e,r){"use strict";(function(u){Object.defineProperty(e,"__esModule",{value:!0});var c=r(6),n=r(0),o=r(1),s=r(25),h=r(14),l=r(0),p=r(13),a=r(0),f=r(0),d=null;"undefined"!=typeof MozWebSocket?d=MozWebSocket:"undefined"!=typeof WebSocket&&(d=WebSocket),e.setWebSocketImpl=function(t){d=t};var t=function(){function i(t,e,n,r){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.de=o.logWrapper(this.connId),this.$=s.StatsManager.getCollection(e),this.connURL=i.Fn(e,n,r)}return i.Fn=function(t,e,n){var r={};return r[h.VERSION_PARAM]=h.PROTOCOL_VERSION,!f.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(h.FORGE_DOMAIN)&&(r[h.REFERER_PARAM]=h.FORGE_REF),e&&(r[h.TRANSPORT_SESSION_PARAM]=e),n&&(r[h.LAST_SESSION_PARAM]=n),t.connectionURL(h.WEBSOCKET,r)},i.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.de("Websocket connecting to "+this.connURL),this.bn=!1,p.PersistentStorage.set("previous_websocket_failure",!0);try{if(f.isNodeSdk()){var r=l.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+h.PROTOCOL_VERSION+"/"+c.default.SDK_VERSION+"/"+u.platform+"/"+r}},o=u.env,s=0==this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new d(this.connURL,[],i)}else this.mySock=new d(this.connURL)}catch(t){this.de("Error instantiating WebSocket.");var a=t.message||t.data;return a&&this.de(a),void this.wn()}this.mySock.onopen=function(){n.de("Websocket connected."),n.bn=!0},this.mySock.onclose=function(){n.de("Websocket connection was disconnected."),n.mySock=null,n.wn()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.de("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.de(e),n.wn()}},i.prototype.start=function(){},i.forceDisallow=function(){i.On=!0},i.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);e&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0)}return!t&&null!==d&&!i.On},i.previouslyFailed=function(){return p.PersistentStorage.isInMemoryStorage||!0===p.PersistentStorage.get("previous_websocket_failure")},i.prototype.markConnectionHealthy=function(){p.PersistentStorage.remove("previous_websocket_failure")},i.prototype.xn=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=a.jsonEval(e);this.onMessage(n)}},i.prototype.kn=function(t){this.totalFrames=t,this.frames=[]},i.prototype.Wn=function(t){if(n.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=+t;if(!isNaN(e))return this.kn(e),null}return this.kn(1),t},i.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.$.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.xn(e);else{var n=this.Wn(e);null!==n&&this.xn(n)}}},i.prototype.send=function(t){this.resetKeepAlive();var e=a.stringify(t);this.bytesSent+=e.length,this.$.incrementCounter("bytes_sent",e.length);var n=o.splitStringBySize(e,16384);1<n.length&&this.jn(n.length+"");for(var r=0;r<n.length;r++)this.jn(n[r])},i.prototype.An=function(){this.Sn=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},i.prototype.wn=function(){this.Sn||(this.de("WebSocket is closing itself"),this.An(),this.onDisconnect&&(this.onDisconnect(this.bn),this.onDisconnect=null))},i.prototype.close=function(){this.Sn||(this.de("WebSocket is being closed"),this.An())},i.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.jn("0"),t.resetKeepAlive()},Math.floor(45e3))},i.prototype.jn=function(t){try{this.mySock.send(t)}catch(t){this.de("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.wn.bind(this),0)}},i.responsesRequiredToBeHealthy=2,i.healthyTimeout=3e4,i}();e.WebSocketConnection=t}).call(e,r(27))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}();e.ServerActions=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),o=n(3),s=n(5),a=n(4),i=function(){function e(t){this.Vn=new r.IndexedFilter(t.getIndex()),this.me=t.getIndex(),this.Qn=e.qn(t),this.Un=e.Bn(t)}return e.prototype.getStartPost=function(){return this.Qn},e.prototype.getEndPost=function(){return this.Un},e.prototype.matches=function(t){return this.me.compare(this.getStartPost(),t)<=0&&this.me.compare(t,this.getEndPost())<=0},e.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new s.NamedNode(e,n))||(n=a.ChildrenNode.EMPTY_NODE),this.Vn.updateChild(t,e,n,r,i,o)},e.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=a.ChildrenNode.EMPTY_NODE);var r=e.withIndex(this.me);r=r.updatePriority(a.ChildrenNode.EMPTY_NODE);var i=this;return e.forEachChild(o.PRIORITY_INDEX,function(t,e){i.matches(new s.NamedNode(t,e))||(r=r.updateImmediateChild(t,a.ChildrenNode.EMPTY_NODE))}),this.Vn.updateFullNode(t,r,n)},e.prototype.updatePriority=function(t,e){return t},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.Vn},e.prototype.getIndex=function(){return this.me},e.qn=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},e.Bn=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},e}();e.RangedFilter=i},,,,,,,,,,,,,,,,,,,,,,function(t,e,n){t.exports=n(79)},function(n,t,e){"use strict";function r(t){var e=t.INTERNAL.registerService("database",function(t,e,n){return c.RepoManager.getInstance().databaseFromApp(t,n)},{Reference:a.Reference,Query:s.Query,Database:o.Database,enableLogging:u.enableLogging,INTERNAL:h,ServerValue:f,TEST_ACCESS:l},null,!0);p.isNodeSdk()&&(n.exports=e)}Object.defineProperty(t,"__esModule",{value:!0});var i=e(6),o=e(32);t.Database=o.Database;var s=e(36);t.Query=s.Query;var a=e(21);t.Reference=a.Reference;var u=e(1);t.enableLogging=u.enableLogging;var c=e(26),h=e(111),l=e(112),p=e(0),f=o.Database.ServerValue;t.ServerValue=f,(t.registerDatabase=r)(i.default);var d=e(22);t.DataSnapshot=d.DataSnapshot;var v=e(35);t.OnDisconnect=v.OnDisconnect},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){this.Hn=t,this.Gn="firebase:"}return t.prototype.set=function(t,e){null==e?this.Hn.removeItem(this.Kn(t)):this.Hn.setItem(this.Kn(t),r.stringify(e))},t.prototype.get=function(t){var e=this.Hn.getItem(this.Kn(t));return null==e?null:r.jsonEval(e)},t.prototype.remove=function(t){this.Hn.removeItem(this.Kn(t))},t.prototype.Kn=function(t){return this.Gn+t},t.prototype.toString=function(){return""+this.Hn},t}();e.DOMStorageWrapper=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(){this.Yn={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.Yn[t]:this.Yn[t]=e},t.prototype.get=function(t){return r.contains(this.Yn,t)?this.Yn[t]:null},t.prototype.remove=function(t){delete this.Yn[t]},t}();e.MemoryStorage=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return r.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();e.TransactionResult=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,s,a,u=n(0);e.nextPushId=(o="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",s=0,a=[],function(t){var e=t===s;s=t;var n,r=Array(8);for(n=7;0<=n;n--)r[n]=o.charAt(t%64),t=Math.floor(t/64);u.assert(0===t,"Cannot push at time == 0");var i=r.join("");if(e){for(n=11;0<=n&&63===a[n];n--)a[n]=0;a[n]++}else for(n=0;n<12;n++)a[n]=Math.floor(64*Math.random());for(n=0;n<12;n++)i+=o.charAt(a[n]);return u.assert(20===i.length,"nextPushId: Length should be 20."),i})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(22),s=n(85),a=n(0),u=n(0),r=function(){function e(t,e,n){this.Xn=t,this.zn=e,this.Jn=n}return e.prototype.respondsTo=function(t){return"value"===t},e.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new s.DataEvent("value",this,new o.DataSnapshot(t.snapshotNode,e.getRef(),n))},e.prototype.getEventRunner=function(t){var e=this.Jn;if("cancel"===t.getEventType()){u.assert(this.zn,"Raising a cancel event on a listener with no cancel callback");var n=this.zn;return function(){n.call(e,t.error)}}var r=this.Xn;return function(){r.call(e,t.snapshot)}},e.prototype.createCancelEvent=function(t,e){return this.zn?new s.CancelEvent(this,t,e):null},e.prototype.matches=function(t){return t instanceof e&&(!t.Xn||!this.Xn||t.Xn===this.Xn&&t.Jn===this.Jn)},e.prototype.hasAnyCallback=function(){return null!==this.Xn},e}();e.ValueEventRegistration=r;var i=function(){function i(t,e,n){this.$n=t,this.zn=e,this.Jn=n}return i.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,a.contains(this.$n,e)},i.prototype.createCancelEvent=function(t,e){return this.zn?new s.CancelEvent(this,t,e):null},i.prototype.createEvent=function(t,e){u.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new s.DataEvent(t.type,this,new o.DataSnapshot(t.snapshotNode,n,r),t.prevName)},i.prototype.getEventRunner=function(t){var e=this.Jn;if("cancel"===t.getEventType()){u.assert(this.zn,"Raising a cancel event on a listener with no cancel callback");var n=this.zn;return function(){n.call(e,t.error)}}var r=this.$n[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},i.prototype.matches=function(n){if(n instanceof i){if(!this.$n||!n.$n)return!0;if(this.Jn===n.Jn){var t=a.getCount(n.$n);if(t===a.getCount(this.$n)){if(1!==t)return a.every(this.$n,function(t,e){return n.$n[t]===e});var e=a.getAnyKey(n.$n),r=a.getAnyKey(this.$n);return!(r!==e||n.$n[e]&&this.$n[r]&&n.$n[e]!==this.$n[r])}}}return!1},i.prototype.hasAnyCallback=function(){return null!==this.$n},i}();e.ChildEventRegistration=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath()+":"+this.eventType+":"+r.stringify(this.snapshot.exportVal())},t}();e.DataEvent=i;var o=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path+":cancel"},t}();e.CancelEvent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=n(0),o=n(1),i=n(87),d=n(4),h=n(0),l=n(23),u=n(88),p=n(89),v=n(8),c=n(46),y=n(2),m=n(47),r=n(95),s=function(){function g(t){this.Zn=t,this.er=l.ImmutableTree.Empty,this.tr=new r.WriteTree,this.nr={},this.rr={}}return g.prototype.applyUserOverwrite=function(t,e,n,r){return this.tr.addOverwrite(t,e,n,r),r?this.ir(new c.Overwrite(v.OperationSource.User,t,e)):[]},g.prototype.applyUserMerge=function(t,e,n){this.tr.addMerge(t,e,n);var r=l.ImmutableTree.fromObject(e);return this.ir(new p.Merge(v.OperationSource.User,t,r))},g.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.tr.getWrite(t);if(this.tr.removeWrite(t)){var r=l.ImmutableTree.Empty;return null!=n.snap?r=r.set(y.Path.Empty,!0):h.forEach(n.children,function(t,e){r=r.set(new y.Path(t),e)}),this.ir(new i.AckUserWrite(n.path,r,e))}return[]},g.prototype.applyServerOverwrite=function(t,e){return this.ir(new c.Overwrite(v.OperationSource.Server,t,e))},g.prototype.applyServerMerge=function(t,e){var n=l.ImmutableTree.fromObject(e);return this.ir(new p.Merge(v.OperationSource.Server,t,n))},g.prototype.applyListenComplete=function(t){return this.ir(new u.ListenComplete(v.OperationSource.Server,t))},g.prototype.applyTaggedQueryOverwrite=function(t,e,n){var r=this.or(n);if(null==r)return[];var i=g.ar(r),o=i.path,s=i.queryId,a=y.Path.relativePath(o,t),u=new c.Overwrite(v.OperationSource.forServerTaggedQuery(s),a,e);return this.sr(o,u)},g.prototype.applyTaggedQueryMerge=function(t,e,n){var r=this.or(n);if(r){var i=g.ar(r),o=i.path,s=i.queryId,a=y.Path.relativePath(o,t),u=l.ImmutableTree.fromObject(e),c=new p.Merge(v.OperationSource.forServerTaggedQuery(s),a,u);return this.sr(o,c)}return[]},g.prototype.applyTaggedListenComplete=function(t,e){var n=this.or(e);if(n){var r=g.ar(n),i=r.path,o=r.queryId,s=y.Path.relativePath(i,t),a=new u.ListenComplete(v.OperationSource.forServerTaggedQuery(o),s);return this.sr(i,a)}return[]},g.prototype.addEventRegistration=function(t,e){var r=t.path,i=null,o=!1;this.er.foreachOnPath(r,function(t,e){var n=y.Path.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()});var n,s=this.er.get(r);s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(y.Path.Empty)):(s=new m.SyncPoint,this.er=this.er.set(r,s)),null!=i?n=!0:(n=!1,i=d.ChildrenNode.EMPTY_NODE,this.er.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(y.Path.Empty);n&&(i=i.updateImmediateChild(t,n))}));var a=s.viewExistsForQuery(t);if(!a&&!t.getQueryParams().loadsAllData()){var u=g.ur(t);f.assert(!(u in this.rr),"View does not exist, but we have a tag");var c=g.lr();this.rr[u]=c,this.nr["_"+c]=u}var h=this.tr.childWrites(r),l=s.addEventRegistration(t,e,h,i,n);if(!a&&!o){var p=s.viewForQuery(t);l=l.concat(this.hr(t,p))}return l},g.prototype.removeEventRegistration=function(t,e,n){var r=this,i=t.path,o=this.er.get(i),s=[];if(o&&("default"===t.queryIdentifier()||o.viewExistsForQuery(t))){var a=o.removeEventRegistration(t,e,n);o.isEmpty()&&(this.er=this.er.remove(i));var u=a.removed;s=a.events;var c=-1!==u.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.er.findOnPath(i,function(t,e){return e.hasCompleteView()});if(c&&!h){var l=this.er.subtree(i);if(!l.isEmpty())for(var p=this.cr(l),f=0;f<p.length;++f){var d=p[f],v=d.getQuery(),y=this.pr(d);this.Zn.startListening(g.dr(v),this.fr(v),y.hashFn,y.onComplete)}}!h&&0<u.length&&!n&&(c?this.Zn.stopListening(g.dr(t),null):u.forEach(function(t){var e=r.rr[g.ur(t)];r.Zn.stopListening(g.dr(t),e)})),this._r(u)}return s},g.prototype.calcCompleteEventCache=function(i,t){var e=this.tr,n=this.er.findOnPath(i,function(t,e){var n=y.Path.relativePath(t,i),r=e.getCompleteServerCache(n);if(r)return r});return e.calcCompleteEventCache(i,n,t,!0)},g.prototype.cr=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),h.forEach(n,function(t,e){r=r.concat(e)}),r})},g.prototype._r=function(t){for(var e=0;e<t.length;++e){var n=t[e];if(!n.getQueryParams().loadsAllData()){var r=g.ur(n),i=this.rr[r];delete this.rr[r],delete this.nr["_"+i]}}},g.dr=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},g.prototype.hr=function(t,e){var n=t.path,r=this.fr(t),i=this.pr(e),o=this.Zn.startListening(g.dr(t),r,i.hashFn,i.onComplete),s=this.er.subtree(n);if(r)f.assert(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var a=s.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),h.forEach(n,function(t,e){r=r.concat(e)}),r}),u=0;u<a.length;++u){var c=a[u];this.Zn.stopListening(g.dr(c),this.fr(c))}return o},g.prototype.pr=function(t){var n=this,r=t.getQuery(),i=this.fr(r);return{hashFn:function(){return(t.getServerCache()||d.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return i?n.applyTaggedListenComplete(r.path,i):n.applyListenComplete(r.path);var e=o.errorForServerCode(t,r);return n.removeEventRegistration(r,null,e)}}},g.ur=function(t){return t.path+"$"+t.queryIdentifier()},g.ar=function(t){var e=t.indexOf("$");return f.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new y.Path(t.substr(0,e))}},g.prototype.or=function(t){return this.nr["_"+t]},g.prototype.fr=function(t){var e=g.ur(t);return h.safeGet(this.rr,e)},g.lr=function(){return g.yr++},g.prototype.sr=function(t,e){var n=this.er.get(t);f.assert(n,"Missing sync point for query tag that we're tracking");var r=this.tr.childWrites(t);return n.applyOperation(e,r,null)},g.prototype.ir=function(t){return this.vr(t,this.er,null,this.tr.childWrites(y.Path.Empty))},g.prototype.vr=function(t,e,n,r){if(t.path.isEmpty())return this.gr(t,e,n,r);var i=e.get(y.Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(y.Path.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,h=r.child(s);o=o.concat(this.vr(a,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},g.prototype.gr=function(o,t,s,a){var u=this,e=t.get(y.Path.Empty);null==s&&null!=e&&(s=e.getCompleteServerCache(y.Path.Empty));var c=[];return t.children.inorderTraversal(function(t,e){var n=s?s.getImmediateChild(t):null,r=a.child(t),i=o.operationForChild(t);i&&(c=c.concat(u.gr(i,e,n,r)))}),e&&(c=c.concat(e.applyOperation(o,a,s))),c},g.yr=1,g}();e.SyncTree=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(8),s=function(){function n(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=o.OperationType.ACK_USER_WRITE,this.source=o.OperationSource.User}return n.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return r.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var e=this.affectedTree.subtree(new i.Path(t));return new n(i.Path.Empty,e,this.revert)}return r.assert(this.path.getFront()===t,"operationForChild called for unrelated child."),new n(this.path.popFront(),this.affectedTree,this.revert)},n}();e.AckUserWrite=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(8),o=function(){function e(t,e){this.source=t,this.path=e,this.type=i.OperationType.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,r.Path.Empty):new e(this.source,this.path.popFront())},e}();e.ListenComplete=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(46),o=n(2),s=n(0),a=function(){function n(t,e,n){this.source=t,this.path=e,this.children=n,this.type=r.OperationType.MERGE}return n.prototype.operationForChild=function(t){if(this.path.isEmpty()){var e=this.children.subtree(new o.Path(t));return e.isEmpty()?null:e.value?new i.Overwrite(this.source,o.Path.Empty,e.value):new n(this.source,o.Path.Empty,e)}return s.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new n(this.source,this.path.popFront(),this.children)},n.prototype.toString=function(){return"Operation("+this.path+": "+this.source+" merge: "+this.children+")"},n}();e.Merge=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=n(24),p=n(91),f=n(4),d=n(19),v=n(48),y=n(94),a=n(0),o=n(8),r=n(9),i=n(3),s=function(){function t(t,e){this.mr=t,this.Cr=[];var n=this.mr.getQueryParams(),r=new l.IndexedFilter(n.getIndex()),i=n.getNodeFilter();this.Er=new p.ViewProcessor(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(f.ChildrenNode.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(f.ChildrenNode.EMPTY_NODE,s.getNode(),null),c=new d.CacheNode(a,o.isFullyInitialized(),r.filtersNodes()),h=new d.CacheNode(u,s.isFullyInitialized(),i.filtersNodes());this.Nr=new v.ViewCache(h,c),this.Pr=new y.EventGenerator(this.mr)}return t.prototype.getQuery=function(){return this.mr},t.prototype.getServerCache=function(){return this.Nr.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.Nr.getCompleteServerSnap();return e&&(this.mr.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.Cr.length},t.prototype.addEventRegistration=function(t){this.Cr.push(t)},t.prototype.removeEventRegistration=function(t,n){var r=[];if(n){a.assert(null==t,"A cancel should cancel all event registrations.");var i=this.mr.path;this.Cr.forEach(function(t){n=n;var e=t.createCancelEvent(n,i);e&&r.push(e)})}if(t){for(var e=[],o=0;o<this.Cr.length;++o){var s=this.Cr[o];if(s.matches(t)){if(t.hasAnyCallback()){e=e.concat(this.Cr.slice(o+1));break}}else e.push(s)}this.Cr=e}else this.Cr=[];return r},t.prototype.applyOperation=function(t,e,n){t.type===o.OperationType.MERGE&&null!==t.source.queryId&&(a.assert(this.Nr.getCompleteServerSnap(),"We should always have a full cache before handling merges"),a.assert(this.Nr.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.Nr,i=this.Er.applyOperation(r,t,e,n);return this.Er.assertIndexed(i.viewCache),a.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.Nr=i.viewCache,this.br(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.Nr.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(i.PRIORITY_INDEX,function(t,e){n.push(r.Change.childAddedChange(t,e))}),e.isFullyInitialized()&&n.push(r.Change.valueChange(e.getNode())),this.br(n,e.getNode(),t)},t.prototype.br=function(t,e,n){var r=n?[n]:this.Cr;return this.Pr.generateEventsForChanges(t,e,r)},t}();e.View=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=n(8),m=n(0),f=n(92),s=n(9),E=n(4),h=n(10),d=n(23),v=n(2),y=n(93),g=function(t,e){this.viewCache=t,this.changes=e};e.ProcessorResult=g;var r=function(){function l(t){this.Sr=t}return l.prototype.assertIndexed=function(t){m.assert(t.getEventCache().getNode().isIndexed(this.Sr.getIndex()),"Event snap not indexed"),m.assert(t.getServerCache().getNode().isIndexed(this.Sr.getIndex()),"Server snap not indexed")},l.prototype.applyOperation=function(t,e,n,r){var i,o,s=new f.ChildChangeAccumulator;if(e.type===p.OperationType.OVERWRITE){var a=e;i=a.source.fromUser?this.Tr(t,a.path,a.snap,n,r,s):(m.assert(a.source.fromServer,"Unknown source."),o=a.source.tagged||t.getServerCache().isFiltered()&&!a.path.isEmpty(),this.wr(t,a.path,a.snap,n,r,o,s))}else if(e.type===p.OperationType.MERGE){var u=e;i=u.source.fromUser?this.Ir(t,u.path,u.children,n,r,s):(m.assert(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.getServerCache().isFiltered(),this.Rr(t,u.path,u.children,n,r,o,s))}else if(e.type===p.OperationType.ACK_USER_WRITE){var c=e;i=c.revert?this.Or(t,c.path,n,r,s):this.Ar(t,c.path,c.affectedTree,n,r,s)}else{if(e.type!==p.OperationType.LISTEN_COMPLETE)throw m.assertionError("Unknown operation type: "+e.type);i=this.Dr(t,e.path,n,s)}var h=s.getChanges();return l.Mr(t,i,h),new g(i,h)},l.Mr=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(0<n.length||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(s.Change.valueChange(e.getCompleteEventSnap()))}},l.prototype.Lr=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var s=void 0,a=void 0;if(e.isEmpty())if(m.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var u=t.getCompleteServerSnap(),c=u instanceof E.ChildrenNode?u:E.ChildrenNode.EMPTY_NODE,h=n.calcCompleteEventChildren(c);s=this.Sr.updateFullNode(t.getEventCache().getNode(),h,i)}else{var l=n.calcCompleteEventCache(t.getCompleteServerSnap());s=this.Sr.updateFullNode(t.getEventCache().getNode(),l,i)}else{var p=e.getFront();if(".priority"==p){m.assert(1==e.getLength(),"Can't have a priority with additional path components");var f=o.getNode();a=t.getServerCache().getNode();var d=n.calcEventCacheAfterServerOverwrite(e,f,a);s=null!=d?this.Sr.updatePriority(f,d):o.getNode()}else{var v=e.popFront(),y=void 0;if(o.isCompleteForChild(p)){a=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),a);y=null!=g?o.getNode().getImmediateChild(p).updateChild(v,g):o.getNode().getImmediateChild(p)}else y=n.calcCompleteChild(p,t.getServerCache());s=null!=y?this.Sr.updateChild(o.getNode(),p,y,v,r,i):o.getNode()}}return t.updateEventSnap(s,o.isFullyInitialized()||e.isEmpty(),this.Sr.filtersNodes())},l.prototype.wr=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.Sr:this.Sr.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),h,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&1<e.getLength())return t;var p=e.popFront(),f=u.getNode().getImmediateChild(l).updateChild(p,n);a=".priority"==l?c.updatePriority(u.getNode(),f):c.updateChild(u.getNode(),l,f,p,y.NO_COMPLETE_CHILD_SOURCE,null)}var d=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),v=new y.WriteTreeCompleteChildSource(r,d,i);return this.Lr(d,e,r,v,s)},l.prototype.Tr=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new y.WriteTreeCompleteChildSource(r,t,i);if(e.isEmpty())a=this.Sr.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.Sr.filtersNodes());else{var h=e.getFront();if(".priority"===h)a=this.Sr.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),p=u.getNode().getImmediateChild(h),f=void 0;if(l.isEmpty())f=n;else{var d=c.getCompleteChild(h);f=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):E.ChildrenNode.EMPTY_NODE}if(p.equals(f))s=t;else{var v=this.Sr.updateChild(u.getNode(),h,f,l,c,o);s=t.updateEventSnap(v,u.isFullyInitialized(),this.Sr.filtersNodes())}}}return s},l.Fr=function(t,e){return t.getEventCache().isCompleteForChild(e)},l.prototype.Ir=function(r,i,t,o,s,a){var u=this,c=r;return t.foreach(function(t,e){var n=i.child(t);l.Fr(r,n.getFront())&&(c=u.Tr(c,n,e,o,s,a))}),t.foreach(function(t,e){var n=i.child(t);l.Fr(r,n.getFront())||(c=u.Tr(c,n,e,o,s,a))}),c},l.prototype.xr=function(n,t){return t.foreach(function(t,e){n=n.updateChild(t,e)}),n},l.prototype.Rr=function(o,t,e,s,a,u,c){var h=this;if(o.getServerCache().getNode().isEmpty()&&!o.getServerCache().isFullyInitialized())return o;var n,l=o;n=t.isEmpty()?e:d.ImmutableTree.Empty.setTree(t,e);var p=o.getServerCache().getNode();return n.children.inorderTraversal(function(t,e){if(p.hasChild(t)){var n=o.getServerCache().getNode().getImmediateChild(t),r=h.xr(n,e);l=h.wr(l,new v.Path(t),r,s,a,u,c)}}),n.children.inorderTraversal(function(t,e){var n=!o.getServerCache().isCompleteForChild(t)&&null==e.value;if(!p.hasChild(t)&&!n){var r=o.getServerCache().getNode().getImmediateChild(t),i=h.xr(r,e);l=h.wr(l,new v.Path(t),i,s,a,u,c)}}),l},l.prototype.Ar=function(t,r,e,n,i,o){if(null!=n.shadowingWrite(r))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=e.value){if(r.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(r))return this.wr(t,r,a.getNode().getChild(r),n,i,s,o);if(r.isEmpty()){var u=d.ImmutableTree.Empty;return a.getNode().forEachChild(h.KEY_INDEX,function(t,e){u=u.set(new v.Path(t),e)}),this.Rr(t,r,u,n,i,s,o)}return t}var c=d.ImmutableTree.Empty;return e.foreach(function(t,e){var n=r.child(t);a.isCompleteForPath(n)&&(c=c.set(t,a.getNode().getChild(n)))}),this.Rr(t,r,c,n,i,s,o)},l.prototype.Dr=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.Lr(o,e,n,y.NO_COMPLETE_CHILD_SOURCE,r)},l.prototype.Or=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var s=new y.WriteTreeCompleteChildSource(n,t,r),a=t.getEventCache().getNode(),u=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();m.assert(h instanceof E.ChildrenNode,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(h)}c=c,u=this.Sr.updateFullNode(a,c,i)}else{var l=e.getFront(),p=n.calcCompleteChild(l,t.getServerCache());null==p&&t.getServerCache().isCompleteForChild(l)&&(p=a.getImmediateChild(l)),(u=null!=p?this.Sr.updateChild(a,l,p,e.popFront(),s,i):t.getEventCache().getNode().hasChild(l)?this.Sr.updateChild(a,l,E.ChildrenNode.EMPTY_NODE,e.popFront(),s,i):a).isEmpty()&&t.getServerCache().isFullyInitialized()&&((o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(u=this.Sr.updateFullNode(u,o,i)))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(v.Path.Empty),t.updateEventSnap(u,o,this.Sr.filtersNodes())},l}();e.ViewProcessor=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(9),a=n(0),r=function(){function t(){this.kr={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;a.assert(e==s.Change.CHILD_ADDED||e==s.Change.CHILD_CHANGED||e==s.Change.CHILD_REMOVED,"Only child changes supported for tracking"),a.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=o.safeGet(this.kr,n);if(r){var i=r.type;if(e==s.Change.CHILD_ADDED&&i==s.Change.CHILD_REMOVED)this.kr[n]=s.Change.childChangedChange(n,t.snapshotNode,r.snapshotNode);else if(e==s.Change.CHILD_REMOVED&&i==s.Change.CHILD_ADDED)delete this.kr[n];else if(e==s.Change.CHILD_REMOVED&&i==s.Change.CHILD_CHANGED)this.kr[n]=s.Change.childRemovedChange(n,r.oldSnap);else if(e==s.Change.CHILD_CHANGED&&i==s.Change.CHILD_ADDED)this.kr[n]=s.Change.childAddedChange(n,t.snapshotNode);else{if(e!=s.Change.CHILD_CHANGED||i!=s.Change.CHILD_CHANGED)throw a.assertionError("Illegal combination of changes: "+t+" occurred after "+r);this.kr[n]=s.Change.childChangedChange(n,t.snapshotNode,r.oldSnap)}}else this.kr[n]=t},t.prototype.getChanges=function(){return o.getValues(this.kr)},t}();e.ChildChangeAccumulator=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(19),i=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}();e.Wr=i,e.NO_COMPLETE_CHILD_SOURCE=new i;var o=function(){function t(t,e,n){void 0===n&&(n=null),this.jr=t,this.Nr=e,this.Vr=n}return t.prototype.getCompleteChild=function(t){var e=this.Nr.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.Vr?new r.CacheNode(this.Vr,!0,!1):this.Nr.getServerCache();return this.jr.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.Vr?this.Vr:this.Nr.getCompleteServerSnap(),i=this.jr.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}();e.WriteTreeCompleteChildSource=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),s=n(9),o=n(0),r=function(){function t(t){this.mr=t,this.me=this.mr.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===s.Change.CHILD_CHANGED&&r.me.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(s.Change.childMovedChange(t.childName,t.snapshotNode))}),this.Qr(i,s.Change.CHILD_REMOVED,t,n,e),this.Qr(i,s.Change.CHILD_ADDED,t,n,e),this.Qr(i,s.Change.CHILD_MOVED,o,n,e),this.Qr(i,s.Change.CHILD_CHANGED,t,n,e),this.Qr(i,s.Change.VALUE,t,n,e),i},t.prototype.Qr=function(r,e,t,i,o){var s=this,n=t.filter(function(t){return t.type===e});n.sort(this.qr.bind(this)),n.forEach(function(e){var n=s.Ur(e,o);i.forEach(function(t){t.respondsTo(e.type)&&r.push(t.createEvent(n,s.mr))})})},t.prototype.Ur=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.me)),t},t.prototype.qr=function(t,e){if(null==t.childName||null==e.childName)throw o.assertionError("Should only compare child_ events.");var n=new i.NamedNode(t.childName,t.snapshotNode),r=new i.NamedNode(e.childName,e.snapshotNode);return this.me.compare(n,r)},t}();e.EventGenerator=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var h=n(0),l=n(0),f=n(2),p=n(96),o=n(3),d=n(4),r=function(){function c(){this.Br=p.CompoundWrite.Empty,this.Hr=[],this.Gr=-1}return c.prototype.childWrites=function(t){return new i(t,this)},c.prototype.addOverwrite=function(t,e,n,r){l.assert(n>this.Gr,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.Hr.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.Br=this.Br.addWrite(t,e)),this.Gr=n},c.prototype.addMerge=function(t,e,n){l.assert(n>this.Gr,"Stacking an older merge on top of newer ones"),this.Hr.push({path:t,children:e,writeId:n,visible:!0}),this.Br=this.Br.addWrites(t,e),this.Gr=n},c.prototype.getWrite=function(t){for(var e=0;e<this.Hr.length;e++){var n=this.Hr[e];if(n.writeId===t)return n}return null},c.prototype.removeWrite=function(e){var n=this,t=this.Hr.findIndex(function(t){return t.writeId===e});l.assert(0<=t,"removeWrite called with nonexistent writeId.");var r=this.Hr[t];this.Hr.splice(t,1);for(var i=r.visible,o=!1,s=this.Hr.length-1;i&&0<=s;){var a=this.Hr[s];a.visible&&(t<=s&&this.Kr(a,r.path)?i=!1:r.path.contains(a.path)&&(o=!0)),s--}if(i){if(o)return this.Yr(),!0;if(r.snap)this.Br=this.Br.removeWrite(r.path);else{var u=r.children;h.forEach(u,function(t){n.Br=n.Br.removeWrite(r.path.child(t))})}return!0}return!1},c.prototype.getCompleteWriteData=function(t){return this.Br.getCompleteNode(t)},c.prototype.calcCompleteEventCache=function(e,t,n,r){if(n||r){var i=this.Br.childCompoundWrite(e);if(!r&&i.isEmpty())return t;if(r||null!=t||i.hasCompleteWrite(f.Path.Empty)){var o=c.Xr(this.Hr,function(t){return(t.visible||r)&&(!n||!~n.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},e),s=t||d.ChildrenNode.EMPTY_NODE;return o.apply(s)}return null}var a=this.Br.getCompleteNode(e);if(null!=a)return a;var u=this.Br.childCompoundWrite(e);if(u.isEmpty())return t;if(null!=t||u.hasCompleteWrite(f.Path.Empty)){s=t||d.ChildrenNode.EMPTY_NODE;return u.apply(s)}return null},c.prototype.calcCompleteEventChildren=function(t,e){var r=d.ChildrenNode.EMPTY_NODE,n=this.Br.getCompleteNode(t);if(n)return n.isLeafNode()||n.forEachChild(o.PRIORITY_INDEX,function(t,e){r=r.updateImmediateChild(t,e)}),r;if(e){var i=this.Br.childCompoundWrite(t);return e.forEachChild(o.PRIORITY_INDEX,function(t,e){var n=i.childCompoundWrite(new f.Path(t)).apply(e);r=r.updateImmediateChild(t,n)}),i.getCompleteChildren().forEach(function(t){r=r.updateImmediateChild(t.name,t.node)}),r}return this.Br.childCompoundWrite(t).getCompleteChildren().forEach(function(t){r=r.updateImmediateChild(t.name,t.node)}),r},c.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){l.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.Br.hasCompleteWrite(i))return null;var o=this.Br.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},c.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.Br.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.Br.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},c.prototype.shadowingWrite=function(t){return this.Br.getCompleteNode(t)},c.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=this.Br.childCompoundWrite(t),u=a.getCompleteNode(f.Path.Empty);if(null!=u)s=u;else{if(null==e)return[];s=a.apply(e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=o.getCompare(),l=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),p=l.getNext();p&&c.length<r;)0!==h(p,n)&&c.push(p),p=l.getNext();return c},c.prototype.Kr=function(n,r){return n.snap?n.path.contains(r):!!h.findKey(n.children,function(t,e){return n.path.child(e).contains(r)})},c.prototype.Yr=function(){this.Br=c.Xr(this.Hr,c.zr,f.Path.Empty),0<this.Hr.length?this.Gr=this.Hr[this.Hr.length-1].writeId:this.Gr=-1},c.zr=function(t){return t.visible},c.Xr=function(t,e,n){for(var r=p.CompoundWrite.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var s=o.path,a=void 0;if(o.snap)n.contains(s)?(a=f.Path.relativePath(n,s),r=r.addWrite(a,o.snap)):s.contains(n)&&(a=f.Path.relativePath(s,n),r=r.addWrite(f.Path.Empty,o.snap.getChild(a)));else{if(!o.children)throw l.assertionError("WriteRecord should have .snap or .children");if(n.contains(s))a=f.Path.relativePath(n,s),r=r.addWrites(a,o.children);else if(s.contains(n))if((a=f.Path.relativePath(s,n)).isEmpty())r=r.addWrites(f.Path.Empty,o.children);else{var u=h.safeGet(o.children,a.getFront());if(u){var c=u.getChild(a.popFront());r=r.addWrite(f.Path.Empty,c)}}}}}return r},c}();e.WriteTree=r;var i=function(){function e(t,e){this.Jr=t,this.$r=e}return e.prototype.calcCompleteEventCache=function(t,e,n){return this.$r.calcCompleteEventCache(this.Jr,t,e,n)},e.prototype.calcCompleteEventChildren=function(t){return this.$r.calcCompleteEventChildren(this.Jr,t)},e.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.$r.calcEventCacheAfterServerOverwrite(this.Jr,t,e,n)},e.prototype.shadowingWrite=function(t){return this.$r.shadowingWrite(this.Jr.child(t))},e.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.$r.calcIndexedSlice(this.Jr,t,e,n,r,i)},e.prototype.calcCompleteChild=function(t,e){return this.$r.calcCompleteChild(this.Jr,t,e)},e.prototype.child=function(t){return new e(this.Jr.child(t),this.$r)},e}();e.WriteTreeRef=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=n(23),c=n(2),i=n(0),r=n(5),o=n(3),s=n(0),a=function(){function a(t){this.$r=t}return a.prototype.addWrite=function(t,e){if(t.isEmpty())return new a(new u.ImmutableTree(e));var n=this.$r.findRootMostValueAndPath(t);if(null!=n){var r=n.path,i=n.value,o=c.Path.relativePath(r,t);return i=i.updateChild(o,e),new a(this.$r.set(r,i))}var s=new u.ImmutableTree(e);return new a(this.$r.setTree(t,s))},a.prototype.addWrites=function(n,t){var r=this;return i.forEach(t,function(t,e){r=r.addWrite(n.child(t),e)}),r},a.prototype.removeWrite=function(t){return t.isEmpty()?a.Empty:new a(this.$r.setTree(t,u.ImmutableTree.Empty))},a.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},a.prototype.getCompleteNode=function(t){var e=this.$r.findRootMostValueAndPath(t);return null!=e?this.$r.get(e.path).getChild(c.Path.relativePath(e.path,t)):null},a.prototype.getCompleteChildren=function(){var n=[],t=this.$r.value;return null!=t?t.isLeafNode()||t.forEachChild(o.PRIORITY_INDEX,function(t,e){n.push(new r.NamedNode(t,e))}):this.$r.children.inorderTraversal(function(t,e){null!=e.value&&n.push(new r.NamedNode(t,e.value))}),n},a.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var e=this.getCompleteNode(t);return new a(null!=e?new u.ImmutableTree(e):this.$r.subtree(t))},a.prototype.isEmpty=function(){return this.$r.isEmpty()},a.prototype.apply=function(t){return a.Zr(c.Path.Empty,this.$r,t)},a.Empty=new a(new u.ImmutableTree(null)),a.Zr=function(n,t,r){if(null!=t.value)return r.updateChild(n,t.value);var i=null;return t.children.inorderTraversal(function(t,e){".priority"===t?(s.assert(null!==e.value,"Priority writes must always be leaf nodes"),i=e.value):r=a.Zr(n.child(t),e,r)}),r.getChild(n).isEmpty()||null===i||(r=r.updateChild(n.child(".priority"),i)),r},a}();e.CompoundWrite=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=function(){function t(){this.ei=r.ChildrenNode.EMPTY_NODE}return t.prototype.getNode=function(t){return this.ei.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.ei=this.ei.updateChild(t,e)},t}();e.SnapshotHolder=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t){this.ti=t}return t.prototype.getToken=function(t){return this.ti.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(r.log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.ti.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.ti.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.ti.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.ti.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.ti.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',r.warn(t)},t}();e.AuthTokenProvider=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(0),o=function(){function t(){this.ni={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),i.contains(this.ni,t)||(this.ni[t]=0),this.ni[t]+=e},t.prototype.get=function(){return r.deepCopy(this.ni)},t}();e.StatsCollection=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(1),r=n(49),i=function(){function t(t,e){this.Z=e,this.ri={},this.G=new r.StatsListener(t);var n=1e4+2e4*Math.random();s.setTimeoutNonBlocking(this.ii.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.ri[t]=!0},t.prototype.ii=function(){var n=this,t=this.G.get(),r={},i=!1;o.forEach(t,function(t,e){0<e&&o.contains(n.ri,t)&&(r[t]=e,i=!0)}),i&&this.Z.reportStats(r),s.setTimeoutNonBlocking(this.ii.bind(this),Math.floor(2*Math.random()*3e5))},t}();e.StatsReporter=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(){this.oi=[],this.ai=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.oi.push(e),e=null),null===e&&(e=new o(i)),e.add(r)}e&&this.oi.push(e)},t.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.si(function(t){return t.equals(e)})},t.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.si(function(t){return t.contains(e)||e.contains(t)})},t.prototype.si=function(t){this.ai++;for(var e=!0,n=0;n<this.oi.length;n++){var r=this.oi[n];r&&(t(r.getPath())?(this.oi[n].raise(),this.oi[n]=null):e=!1)}e&&(this.oi=[]),this.ai--},t}();e.EventQueue=i;var o=function(){function t(t){this.Oe=t,this.ui=[]}return t.prototype.add=function(t){this.ui.push(t)},t.prototype.raise=function(){for(var t=0;t<this.ui.length;t++){var e=this.ui[t];if(null!==e){this.ui[t]=null;var n=e.getEventRunner();r.logger&&r.log("event: "+e),r.exceptionGuard(n)}}},t.prototype.getPath=function(){return this.Oe},t}();e.EventList=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(51),s=n(0),a=function(r){function t(){var e,t,n=r.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),n.at=!0,t&&document.addEventListener(t,function(){var t=!document[e];t!==n.at&&(n.at=t,n.trigger("visible",t))},!1),n}return i(t,r),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(t){return s.assert("visible"===t,"Unknown event type: "+t),[this.at]},t}(o.EventEmitter);e.VisibilityMonitor=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(51),a=n(0),u=function(e){function t(){var t=e.call(this,["online"])||this;return t.li=!0,"undefined"==typeof window||void 0===window.addEventListener||a.isMobileCordova()||(window.addEventListener("online",function(){t.li||(t.li=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.li&&(t.li=!1,t.trigger("online",!1))},!1)),t}return i(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(t){return o.assert("online"===t,"Unknown event type: "+t),[this.li]},t.prototype.currentlyOnline=function(){return this.li},t}(s.EventEmitter);e.OnlineMonitor=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(53),o=n(54),s=n(1),i=function(){function i(t){this.hi(t)}return Object.defineProperty(i,"ALL_TRANSPORTS",{get:function(){return[r.BrowserPollConnection,o.WebSocketConnection]},enumerable:!0,configurable:!0}),i.prototype.hi=function(t){var e=o.WebSocketConnection&&o.WebSocketConnection.isAvailable(),n=e&&!o.WebSocketConnection.previouslyFailed();if(t.webSocketOnly&&(e||s.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.ci=[o.WebSocketConnection];else{var r=this.ci=[];s.each(i.ALL_TRANSPORTS,function(t,e){e&&e.isAvailable()&&r.push(e)})}},i.prototype.initialTransport=function(){if(0<this.ci.length)return this.ci[0];throw Error("No transports available")},i.prototype.upgradeTransport=function(){return 1<this.ci.length?this.ci[1]:null},i}();e.TransportManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(){function t(t){this.Ut=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var e=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var t=0;t<e.length;++t)!function(t){e[t]&&i.exceptionGuard(function(){n.Ut(e[t])})}(t);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}(););},t}();e.PacketReceiver=r},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),u=n(1),h=n(0),l=n(0),p=n(0),i=function(i){function c(t,e,n){var r=i.call(this)||this;return r.H=t,r.ee=e,r.Ke=n,r.de=u.logWrapper("p:rest:"),r.Je={},r}return o(c,i),c.prototype.reportStats=function(t){throw Error("Method not implemented.")},c.pi=function(t,e){return void 0!==e?"tag$"+e:(s.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),""+t.path)},c.prototype.listen=function(t,e,r,i){var o=this,s=""+t.path;this.de("Listen called for "+s+" "+t.queryIdentifier());var a=c.pi(t,r),u={};this.Je[a]=u;var n=t.getQueryParams().toRestQueryStringParameters();this.di(s+".json",n,function(t,e){var n=e;(404===t&&(t=n=null),null===t&&o.ee(s,n,!1,r),l.safeGet(o.Je,a)===u)&&i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)})},c.prototype.unlisten=function(t,e){var n=c.pi(t,e);delete this.Je[n]},c.prototype.refreshAuthToken=function(t){},c.prototype.di=function(i,o,s){var a=this;void 0===o&&(o={}),o.format="export",this.Ke.getToken(!1).then(function(t){var e=t&&t.accessToken;e&&(o.auth=e);var n=(a.H.secure?"https://":"http://")+a.H.host+i+"?"+p.querystring(o);a.de("Sending REST request for "+n);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(s&&4===r.readyState){a.de("REST Response for "+n+" received. status:",r.status,"response:",r.responseText);var t=null;if(200<=r.status&&r.status<300){try{t=h.jsonEval(r.responseText)}catch(t){u.warn("Failed to parse JSON response for "+n+": "+r.responseText)}s(null,t)}else 401!==r.status&&404!==r.status&&u.warn("Got unsuccessful REST response for "+n+" Status: "+r.status),s(r.status);s=null}},r.open("GET",n,!0),r.send()})},c}(n(55).ServerActions);e.ReadonlyRestClient=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(1),s=n(10),a=n(3),u=n(38),c=n(42),h=n(24),l=n(108),p=n(56),f=n(0),r=function(){function r(){this.fi=!1,this._i=!1,this.yi=!1,this.vi=!1,this.gi=!1,this.mi=0,this.Ci="",this.Ei=null,this.Ni="",this.Pi=null,this.bi="",this.me=a.PRIORITY_INDEX}return r.prototype.hasStart=function(){return this._i},r.prototype.isViewFromLeft=function(){return""===this.Ci?this._i:this.Ci===r.Si.VIEW_FROM_LEFT},r.prototype.getIndexStartValue=function(){return i.assert(this._i,"Only valid if start has been set"),this.Ei},r.prototype.getIndexStartName=function(){return i.assert(this._i,"Only valid if start has been set"),this.yi?this.Ni:o.MIN_NAME},r.prototype.hasEnd=function(){return this.vi},r.prototype.getIndexEndValue=function(){return i.assert(this.vi,"Only valid if end has been set"),this.Pi},r.prototype.getIndexEndName=function(){return i.assert(this.vi,"Only valid if end has been set"),this.gi?this.bi:o.MAX_NAME},r.prototype.hasLimit=function(){return this.fi},r.prototype.hasAnchoredLimit=function(){return this.fi&&""!==this.Ci},r.prototype.getLimit=function(){return i.assert(this.fi,"Only valid if limit has been set"),this.mi},r.prototype.getIndex=function(){return this.me},r.prototype.Ti=function(){var t=new r;return t.fi=this.fi,t.mi=this.mi,t._i=this._i,t.Ei=this.Ei,t.yi=this.yi,t.Ni=this.Ni,t.vi=this.vi,t.Pi=this.Pi,t.gi=this.gi,t.bi=this.bi,t.me=this.me,t.Ci=this.Ci,t},r.prototype.limit=function(t){var e=this.Ti();return e.fi=!0,e.mi=t,e.Ci="",e},r.prototype.limitToFirst=function(t){var e=this.Ti();return e.fi=!0,e.mi=t,e.Ci=r.Si.VIEW_FROM_LEFT,e},r.prototype.limitToLast=function(t){var e=this.Ti();return e.fi=!0,e.mi=t,e.Ci=r.Si.VIEW_FROM_RIGHT,e},r.prototype.startAt=function(t,e){var n=this.Ti();return n._i=!0,void 0===t&&(t=null),n.Ei=t,null!=e?(n.yi=!0,n.Ni=e):(n.yi=!1,n.Ni=""),n},r.prototype.endAt=function(t,e){var n=this.Ti();return n.vi=!0,void 0===t&&(t=null),n.Pi=t,void 0!==e?(n.gi=!0,n.bi=e):(n.gi=!1,n.bi=""),n},r.prototype.orderBy=function(t){var e=this.Ti();return e.me=t,e},r.prototype.getQueryObject=function(){var t=r.Si,e={};if(this._i&&(e[t.INDEX_START_VALUE]=this.Ei,this.yi&&(e[t.INDEX_START_NAME]=this.Ni)),this.vi&&(e[t.INDEX_END_VALUE]=this.Pi,this.gi&&(e[t.INDEX_END_NAME]=this.bi)),this.fi){e[t.LIMIT]=this.mi;var n=this.Ci;""===n&&(n=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),e[t.VIEW_FROM]=n}return this.me!==a.PRIORITY_INDEX&&(e[t.INDEX]=""+this.me),e},r.prototype.loadsAllData=function(){return!(this._i||this.vi||this.fi)},r.prototype.isDefault=function(){return this.loadsAllData()&&this.me==a.PRIORITY_INDEX},r.prototype.getNodeFilter=function(){return this.loadsAllData()?new h.IndexedFilter(this.getIndex()):this.hasLimit()?new l.LimitedFilter(this):new p.RangedFilter(this)},r.prototype.toRestQueryStringParameters=function(){var t,e=r.wi,n={};return this.isDefault()||(t=this.me===a.PRIORITY_INDEX?e.PRIORITY_INDEX:this.me===u.VALUE_INDEX?e.VALUE_INDEX:this.me===s.KEY_INDEX?e.KEY_INDEX:(i.assert(this.me instanceof c.PathIndex,"Unrecognized index type!"),""+this.me),n[e.ORDER_BY]=f.stringify(t),this._i&&(n[e.START_AT]=f.stringify(this.Ei),this.yi&&(n[e.START_AT]+=","+f.stringify(this.Ni))),this.vi&&(n[e.END_AT]=f.stringify(this.Pi),this.gi&&(n[e.END_AT]+=","+f.stringify(this.bi))),this.fi&&(this.isViewFromLeft()?n[e.LIMIT_TO_FIRST]=this.mi:n[e.LIMIT_TO_LAST]=this.mi)),n},r.Si={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},r.wi={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},r.DEFAULT=new r,r}();e.QueryParams=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(56),v=n(4),y=n(5),g=n(0),m=n(9),i=function(){function t(t){this.Ii=new r.RangedFilter(t),this.me=t.getIndex(),this.mi=t.getLimit(),this.Ri=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.Ii.matches(new y.NamedNode(e,n))||(n=v.ChildrenNode.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.mi?this.Ii.getIndexedFilter().updateChild(t,e,n,r,i,o):this.Oi(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=v.ChildrenNode.EMPTY_NODE.withIndex(this.me);else if(2*this.mi<e.numChildren()&&e.isIndexed(this.me)){r=v.ChildrenNode.EMPTY_NODE.withIndex(this.me);var i=void 0;i=this.Ri?e.getReverseIteratorFrom(this.Ii.getEndPost(),this.me):e.getIteratorFrom(this.Ii.getStartPost(),this.me);for(var o=0;i.hasNext()&&o<this.mi;){var s=i.getNext();if(!(this.Ri?this.me.compare(this.Ii.getStartPost(),s)<=0:this.me.compare(s,this.Ii.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.me)).updatePriority(v.ChildrenNode.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;i=void 0;if(this.Ri){i=r.getReverseIterator(this.me),a=this.Ii.getEndPost(),u=this.Ii.getStartPost();var h=this.me.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.me),a=this.Ii.getStartPost(),u=this.Ii.getEndPost(),c=this.me.getCompare();o=0;for(var l=!1;i.hasNext();){s=i.getNext();!l&&c(a,s)<=0&&(l=!0),l&&o<this.mi&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,v.ChildrenNode.EMPTY_NODE)}}return this.Ii.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.Ii.getIndexedFilter()},t.prototype.getIndex=function(){return this.me},t.prototype.Oi=function(t,e,n,r,i){var o;if(this.Ri){var s=this.me.getCompare();o=function(t,e){return s(e,t)}}else o=this.me.getCompare();var a=t;g.assert(a.numChildren()==this.mi,"");var u=new y.NamedNode(e,n),c=this.Ri?a.getFirstChild(this.me):a.getLastChild(this.me),h=this.Ii.matches(u);if(a.hasChild(e)){for(var l=a.getImmediateChild(e),p=r.getChildAfterChild(this.me,c,this.Ri);null!=p&&(p.name==e||a.hasChild(p.name));)p=r.getChildAfterChild(this.me,p,this.Ri);var f=null==p?1:o(p,u);if(h&&!n.isEmpty()&&0<=f)return null!=i&&i.trackChildChange(m.Change.childChangedChange(e,n,l)),a.updateImmediateChild(e,n);null!=i&&i.trackChildChange(m.Change.childRemovedChange(e,l));var d=a.updateImmediateChild(e,v.ChildrenNode.EMPTY_NODE);return null!=p&&this.Ii.matches(p)?(null!=i&&i.trackChildChange(m.Change.childAddedChange(p.name,p.node)),d.updateImmediateChild(p.name,p.node)):d}return n.isEmpty()?t:h&&0<=o(c,u)?(null!=i&&(i.trackChildChange(m.Change.childRemovedChange(c.name,c.node)),i.trackChildChange(m.Change.childAddedChange(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(c.name,v.ChildrenNode.EMPTY_NODE)):t},t}();e.LimitedFilter=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var b,r,C=n(0),_=n(21),N=n(22),w=n(2),i=n(110),S=n(3),O=n(1),P=n(43),I=n(7),T=n(0),A=n(11),g=n(4),R=n(18);(r=b=e.TransactionStatus||(e.TransactionStatus={}))[r.RUN=0]="RUN",r[r.SENT=1]="SENT",r[r.COMPLETED=2]="COMPLETED",r[r.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",r[r.NEEDS_ABORT=4]="NEEDS_ABORT",R.Repo.Ai=25,R.Repo.prototype.ie=function(){this.Di=new i.Tree},R.Repo.prototype.startTransaction=function(t,e,n,r){this.de("transaction on "+t);var i=function(){},o=new _.Reference(this,t);o.on("value",i);var s={path:t,update:e,onComplete:n,status:null,order:O.LUIDGenerator(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=this.Mi(t);s.currentInputSnapshot=a;var u=s.update(a.val());if(void 0===u){if(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete){var c=new N.DataSnapshot(s.currentInputSnapshot,new _.Reference(this,s.path),S.PRIORITY_INDEX);s.onComplete(null,!1,c)}}else{I.validateFirebaseData("transaction failed: Data returned ",u,s.path),s.status=b.RUN;var h=this.Di.subTree(t),l=h.getValue()||[];l.push(s),h.setValue(l);var p=void 0;"object"==typeof u&&null!==u&&T.contains(u,".priority")?(p=T.safeGet(u,".priority"),C.assert(I.isValidPriority(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(this.ue.calcCompleteEventCache(t)||g.ChildrenNode.EMPTY_NODE).getPriority().val(),p=p;var f=this.generateServerValues(),d=A.nodeFromJSON(u,p),v=P.resolveDeferredValueSnapshot(d,f);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=v,s.currentWriteId=this.pe();var y=this.ue.applyUserOverwrite(t,v,s.currentWriteId,s.applyLocally);this.K.raiseEventsForChangedPath(t,y),this.Li()}},R.Repo.prototype.Mi=function(t,e){return this.ue.calcCompleteEventCache(t,e)||g.ChildrenNode.EMPTY_NODE},R.Repo.prototype.Li=function(t){var e=this;if(void 0===t&&(t=this.Di),t||this.Fi(t),null!==t.getValue()){var n=this.xi(t);C.assert(0<n.length,"Sending zero length transaction queue"),n.every(function(t){return t.status===b.RUN})&&this.ki(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.Li(t)})},R.Repo.prototype.ki=function(a,u){for(var c=this,t=u.map(function(t){return t.currentWriteId}),e=this.Mi(a,t),n=e,r=e.hash(),i=0;i<u.length;i++){var o=u[i];C.assert(o.status===b.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),o.status=b.SENT,o.retryCount++;var s=w.Path.relativePath(a,o.path);n=n.updateChild(s,o.currentOutputSnapshotRaw)}var h=n.val(!0),l=a;this.Z.put(""+l,h,function(t){c.de("transaction put response",{path:""+l,status:t});var e=[];if("ok"===t){for(var n=[],r=0;r<u.length;r++){if(u[r].status=b.COMPLETED,e=e.concat(c.ue.ackUserWrite(u[r].currentWriteId)),u[r].onComplete){var i=u[r].currentOutputSnapshotResolved,o=new _.Reference(c,u[r].path),s=new N.DataSnapshot(i,o,S.PRIORITY_INDEX);n.push(u[r].onComplete.bind(null,null,!0,s))}u[r].unwatcher()}c.Fi(c.Di.subTree(a)),c.Li(),c.K.raiseEventsForChangedPath(a,e);for(r=0;r<n.length;r++)O.exceptionGuard(n[r])}else{if("datastale"===t)for(r=0;r<u.length;r++)u[r].status===b.SENT_NEEDS_ABORT?u[r].status=b.NEEDS_ABORT:u[r].status=b.RUN;else{O.warn("transaction at "+l+" failed: "+t);for(r=0;r<u.length;r++)u[r].status=b.NEEDS_ABORT,u[r].abortReason=t}c.le(a)}},r)},R.Repo.prototype.le=function(t){var e=this.Wi(t),n=e.path(),r=this.xi(e);return this.ji(r,n),n},R.Repo.prototype.ji=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter(function(t){return t.status===b.RUN}).map(function(t){return t.currentWriteId}),o=0;o<t.length;o++){var s=t[o],a=w.Path.relativePath(e,s.path),u=!1,c=void 0;if(C.assert(null!==a,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===b.NEEDS_ABORT)u=!0,c=s.abortReason,r=r.concat(this.ue.ackUserWrite(s.currentWriteId,!0));else if(s.status===b.RUN)if(s.retryCount>=R.Repo.Ai)u=!0,c="maxretry",r=r.concat(this.ue.ackUserWrite(s.currentWriteId,!0));else{var h=this.Mi(s.path,i);s.currentInputSnapshot=h;var l=t[o].update(h.val());if(void 0!==l){I.validateFirebaseData("transaction failed: Data returned ",l,s.path);var p=A.nodeFromJSON(l);"object"==typeof l&&null!=l&&T.contains(l,".priority")||(p=p.updatePriority(h.getPriority()));var f=s.currentWriteId,d=this.generateServerValues(),v=P.resolveDeferredValueSnapshot(p,d);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=v,s.currentWriteId=this.pe(),i.splice(i.indexOf(f),1),r=(r=r.concat(this.ue.applyUserOverwrite(s.path,v,s.currentWriteId,s.applyLocally))).concat(this.ue.ackUserWrite(f,!0))}else u=!0,c="nodata",r=r.concat(this.ue.ackUserWrite(s.currentWriteId,!0))}if(this.K.raiseEventsForChangedPath(e,r),r=[],u&&(t[o].status=b.COMPLETED,E=t[o].unwatcher,setTimeout(E,Math.floor(0)),t[o].onComplete))if("nodata"===c){var y=new _.Reference(this,t[o].path),g=t[o].currentInputSnapshot,m=new N.DataSnapshot(g,y,S.PRIORITY_INDEX);n.push(t[o].onComplete.bind(null,null,!1,m))}else n.push(t[o].onComplete.bind(null,Error(c),!1,null))}this.Fi(this.Di);for(o=0;o<n.length;o++)O.exceptionGuard(n[o]);this.Li()}var E},R.Repo.prototype.Wi=function(t){for(var e,n=this.Di;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},R.Repo.prototype.xi=function(t){var e=[];return this.Vi(t,e),e.sort(function(t,e){return t.order-e.order}),e},R.Repo.prototype.Vi=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.Vi(t,e)})},R.Repo.prototype.Fi=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==b.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(0<n.length?n:null)}t.forEachChild(function(t){e.Fi(t)})},R.Repo.prototype.fe=function(t){var e=this,n=this.Wi(t).path(),r=this.Di.subTree(t);return r.forEachAncestor(function(t){e.Qi(t)}),this.Qi(r),r.forEachDescendant(function(t){e.Qi(t)}),n},R.Repo.prototype.Qi=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)e[o].status===b.SENT_NEEDS_ABORT||(e[o].status===b.SENT?(C.assert(i===o-1,"All SENT items should be at beginning of queue."),e[i=o].status=b.SENT_NEEDS_ABORT,e[o].abortReason="set"):(C.assert(e[o].status===b.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.ue.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete&&n.push(e[o].onComplete.bind(null,Error("set"),!1,null))));-1===i?t.setValue(null):e.length=i+1,this.K.raiseEventsForChangedPath(t.path(),r);for(o=0;o<n.length;o++)O.exceptionGuard(n[o])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(2),s=n(0),a=function(){this.children={},this.childCount=0,this.value=null};e.TreeNode=a;var i=function(){function i(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new a),this.qi=t,this.Ui=e,this._e=n}return i.prototype.subTree=function(t){for(var e,n=t instanceof o.Path?t:new o.Path(t),r=this;null!==(e=n.getFront());)r=new i(e,r,s.safeGet(r._e.children,e)||new a),n=n.popFront();return r},i.prototype.getValue=function(){return this._e.value},i.prototype.setValue=function(t){r.assert(void 0!==t,"Cannot set value to undefined"),this._e.value=t,this.Bi()},i.prototype.clear=function(){this._e.value=null,this._e.children={},this._e.childCount=0,this.Bi()},i.prototype.hasChildren=function(){return 0<this._e.childCount},i.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},i.prototype.forEachChild=function(n){var r=this;s.forEach(this._e.children,function(t,e){n(new i(t,r,e))})},i.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,n)}),t&&n&&e(this)},i.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},i.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},i.prototype.path=function(){return new o.Path(null===this.Ui?this.qi:this.Ui.path()+"/"+this.qi)},i.prototype.name=function(){return this.qi},i.prototype.parent=function(){return this.Ui},i.prototype.Bi=function(){null!==this.Ui&&this.Ui.Hi(this.qi,this)},i.prototype.Hi=function(t,e){var n=e.isEmpty(),r=s.contains(this._e.children,t);n&&r?(delete this._e.children[t],this._e.childCount--,this.Bi()):n||r||(this._e.children[t]=e._e,this._e.childCount++,this.Bi())},i}();e.Tree=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(54),i=n(53);e.forceLongPolling=function(){r.WebSocketConnection.forceDisallow(),i.BrowserPollConnection.forceAllow()},e.forceWebSockets=function(){i.BrowserPollConnection.forceDisallow()},e.isWebSocketsAvailable=function(){return r.WebSocketConnection.isAvailable()},e.setSecurityDebugCallback=function(t,e){t.repo.J.it=e},e.stats=function(t,e){t.repo.stats(e)},e.statsIncrementCounter=function(t,e){t.repo.statsIncrementCounter(e)},e.dataUpdateCount=function(t){return t.repo.dataUpdateCount},e.interceptServerData=function(t,e){return t.repo.he(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(34),s=n(50),i=n(26),o=n(52);e.DataConnection=s.PersistentConnection,s.PersistentConnection.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},s.PersistentConnection.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},e.RealTimeConnection=o.Connection,e.hijackHash=function(i){var o=s.PersistentConnection.prototype.put;return s.PersistentConnection.prototype.put=function(t,e,n,r){void 0!==r&&(r=i()),o.call(this,t,e,n,r)},function(){s.PersistentConnection.prototype.put=o}},e.ConnectionTarget=r.RepoInfo,e.queryIdentifier=function(t){return t.queryIdentifier()},e.listens=function(t){return t.repo.J.Je},e.forceRestClient=function(t){i.RepoManager.getInstance().forceRestClient(t)}}],[78])}catch(t){throw Error("Cannot instantiate firebase-database.js - be sure to load firebase-app.js first.")}try{webpackJsonpFirebase([3],{116:function(t,e,n){n(117)},117:function(t,e,n){"use strict";function r(t){var e={Messaging:w};t.INTERNAL.registerService("messaging",function(t){return self&&"ServiceWorkerGlobalScope"in self?new O(t):new w(t)},e)}Object.defineProperty(e,"__esModule",{value:!0});var i,o,s,a=n(0),u={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},c={codes:u,map:((i={})[u.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",i[u.AVAILABLE_IN_SW]="This method is available in a service worker context.",i["should-be-overriden"]="This method should be overriden by extended classes.",i["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",i["permission-default"]="The required permissions were not granted and dismissed instead.",i["permission-blocked"]="The required permissions were not granted and blocked instead.",i["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",i["notifications-blocked"]="Notifications have been blocked.",i[u.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",i["sw-registration-expected"]="A service worker registration was the expected input.",i["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",i["invalid-saved-token"]="Unable to access details of the saved token.",i["sw-reg-redundant"]="The service worker being used for push was made redundant.",i["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$message}",i["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",i["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",i["use-sw-before-get-token"]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",i["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",i["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",i["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",i["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",i["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",i["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",i["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",i["failed-to-delete-token"]="Unable to delete the currently saved token.",i["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",i["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",i["bad-scope"]="The service worker scope must be a string with at least one character.",i["bad-vapid-key"]="The public VAPID key must be a string with at least one character.",i["bad-subscription"]="The subscription must be a valid PushSubscription.",i["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",i["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",i["failed-delete-vapid-key"]="The VAPID key could not be deleted.",i)},h=function(t){return function(t){var e=new Uint8Array(t);return window.btoa(String.fromCharCode.apply(null,e))}(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},l=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],p={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:l,SUBSCRIPTION_OPTIONS:{userVisibleOnly:!0,applicationServerKey:new Uint8Array(l)}},f="fcm_token_object_Store",d=function(){function r(){this.e=new a.ErrorFactory("messaging","Messaging",c.map),this.t=null}return r.prototype.r=function(){return this.t||(this.t=new Promise(function(e,n){var t=indexedDB.open(r.DB_NAME,1);t.onerror=function(t){n(t.target.error)},t.onsuccess=function(t){e(t.target.result)},t.onupgradeneeded=function(t){var e=t.target.result.createObjectStore(f,{keyPath:"swScope"});e.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),e.createIndex("fcmToken","fcmToken",{unique:!0})}})),this.t},r.prototype.closeDatabase=function(){var e=this;return this.t?this.t.then(function(t){t.close(),e.t=null}):Promise.resolve()},r.prototype.getTokenDetailsFromToken=function(i){return this.r().then(function(r){return new Promise(function(e,n){var t=r.transaction([f]).objectStore(f).index("fcmToken").get(i);t.onerror=function(t){n(t.target.error)},t.onsuccess=function(t){e(t.target.result)}})})},r.prototype.n=function(i){return this.r().then(function(r){return new Promise(function(e,n){var t=r.transaction([f]).objectStore(f).get(i);t.onerror=function(t){n(t.target.error)},t.onsuccess=function(t){e(t.target.result)}})})},r.prototype.o=function(s){return this.r().then(function(o){return new Promise(function(n,e){var t=o.transaction([f]).objectStore(f),r=[],i=t.openCursor();i.onerror=function(t){e(t.target.error)},i.onsuccess=function(t){var e=t.target.result;e?(e.value.fcmSenderId===s&&r.push(e.value),e.continue()):n(r)}})})},r.prototype.subscribeToFCM=function(t,e,n){var r=this,i=h(e.getKey("p256dh")),o=h(e.getKey("auth")),s="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+i+"&encryption_auth="+o;n&&(s+="&pushSet="+n);var a=new Headers;return a.append("Content-Type","application/x-www-form-urlencoded"),fetch(p.ENDPOINT+"/fcm/connect/subscribe",{method:"POST",headers:a,body:s}).then(function(t){return t.json()}).then(function(t){var e=t;if(e.error){var n=e.error.message;throw r.e.create(c.codes.TOKEN_SUBSCRIBE_FAILED,{message:n})}if(!e.token)throw r.e.create(c.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!e.pushSet)throw r.e.create(c.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:e.token,pushSet:e.pushSet}})},r.prototype.i=function(t,e){return t.endpoint===e.endpoint&&h(t.getKey("auth"))===e.auth&&h(t.getKey("p256dh"))===e.p256dh},r.prototype.s=function(t,e,n,r,i){var o={swScope:e.scope,endpoint:n.endpoint,auth:h(n.getKey("auth")),p256dh:h(n.getKey("p256dh")),fcmToken:r,fcmPushSet:i,fcmSenderId:t};return this.r().then(function(r){return new Promise(function(e,n){var t=r.transaction([f],"readwrite").objectStore(f).put(o);t.onerror=function(t){n(t.target.error)},t.onsuccess=function(t){e()}})})},r.prototype.getSavedToken=function(n,r){var i=this;return r instanceof ServiceWorkerRegistration?"string"!=typeof n||0===n.length?Promise.reject(this.e.create(c.codes.BAD_SENDER_ID)):this.o(n).then(function(t){if(0!==t.length){var e=t.findIndex(function(t){return r.scope===t.swScope&&n===t.fcmSenderId});if(-1!==e)return t[e]}}).then(function(e){if(e)return r.pushManager.getSubscription().catch(function(t){throw i.e.create(c.codes.GET_SUBSCRIPTION_FAILED)}).then(function(t){if(t&&i.i(t,e))return e.fcmToken})}):Promise.reject(this.e.create(c.codes.SW_REGISTRATION_EXPECTED))},r.prototype.createToken=function(e,n){var r,i,o=this;return"string"!=typeof e||0===e.length?Promise.reject(this.e.create(c.codes.BAD_SENDER_ID)):n instanceof ServiceWorkerRegistration?n.pushManager.getSubscription().then(function(t){return t||n.pushManager.subscribe(p.SUBSCRIPTION_OPTIONS)}).then(function(t){return r=t,o.subscribeToFCM(e,r)}).then(function(t){return i=t,o.s(e,n,r,i.token,i.pushSet)}).then(function(){return i.token}):Promise.reject(this.e.create(c.codes.SW_REGISTRATION_EXPECTED))},r.prototype.deleteToken=function(t){var o=this;return"string"!=typeof t||0===t.length?Promise.reject(this.e.create(c.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(t).then(function(i){if(!i)throw o.e.create(c.codes.DELETE_TOKEN_NOT_FOUND);return o.r().then(function(r){return new Promise(function(e,n){var t=r.transaction([f],"readwrite").objectStore(f).delete(i.swScope);t.onerror=function(t){n(t.target.error)},t.onsuccess=function(t){0!==t.target.result?e(i):n(o.e.create(c.codes.FAILED_TO_DELETE_TOKEN))}})})})},r}(),v="messagingSenderId",y=function(){function t(t){var e=this;if(this.e=new a.ErrorFactory("messaging","Messaging",c.map),!t.options[v]||"string"!=typeof t.options[v])throw this.e.create(c.codes.BAD_SENDER_ID);this.a=t.options[v],this.c=new d,this.app=t,this.INTERNAL={},this.INTERNAL.delete=function(){return e.delete}}return t.prototype.getToken=function(){var n=this,t=this.u();return"granted"!==t?"denied"===t?Promise.reject(this.e.create(c.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this._().then(function(e){return n.c.getSavedToken(n.a,e).then(function(t){return t||n.c.createToken(n.a,e)})})},t.prototype.deleteToken=function(t){var e=this;return this.c.deleteToken(t).then(function(){return e._().then(function(t){if(t)return t.pushManager.getSubscription()}).then(function(t){if(t)return t.unsubscribe()})})},t.prototype._=function(){throw this.e.create(c.codes.SHOULD_BE_INHERITED)},t.prototype.requestPermission=function(){throw this.e.create(c.codes.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw this.e.create(c.codes.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw this.e.create(c.codes.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw this.e.create(c.codes.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw this.e.create(c.codes.AVAILABLE_IN_SW)},t.prototype.delete=function(){return this.c.closeDatabase()},t.prototype.u=function(){return Notification.permission},t.prototype.getTokenManager=function(){return this.c},t}(),g={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},m=g,E={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},b=function(t,e){return(n={})[g.TYPE_OF_MSG]=t,n[g.DATA]=e,n;var n},C="/firebase-messaging-sw.js",_="/firebase-cloud-messaging-push-scope",N=this&&this.__extends||(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(n){function t(t){var e=n.call(this,t)||this;return e.d=null,e.f=Object(a.createSubscribe)(function(t){e.d=t}),e.h=null,e.p=Object(a.createSubscribe)(function(t){e.h=t}),e.l(),e}return N(t,n),t.prototype.getToken=function(){var t=this;return this.g()?this.T().then(function(){return n.prototype.getToken.call(t)}):Promise.reject(this.e.create(c.codes.UNSUPPORTED_BROWSER))},t.prototype.T=function(){var e=this;if(this.S)return this.S;var t=document.querySelector('link[rel="manifest"]');return this.S=t?fetch(t.href).then(function(t){return t.json()}).catch(function(){return Promise.resolve()}).then(function(t){if(t&&t.gcm_sender_id&&"103953800507"!==t.gcm_sender_id)throw e.e.create(c.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.S},t.prototype.requestPermission=function(){var o=this;return"granted"===Notification.permission?Promise.resolve():new Promise(function(e,n){var r=function(t){return"granted"===t?e():n("denied"===t?o.e.create(c.codes.PERMISSION_BLOCKED):o.e.create(c.codes.PERMISSION_DEFAULT))},i=Notification.requestPermission(function(t){i||r(t)});i&&i.then(r)})},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw this.e.create(c.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.b)throw this.e.create(c.codes.USE_SW_BEFORE_GET_TOKEN);this.b=t},t.prototype.onMessage=function(t,e,n){return this.f(t,e,n)},t.prototype.onTokenRefresh=function(t,e,n){return this.p(t,e,n)},t.prototype.v=function(r){var i=this,o=r.installing||r.waiting||r.active;return new Promise(function(t,e){if(o)if("activated"!==o.state)if("redundant"!==o.state){var n=function(){if("activated"===o.state)t(r);else{if("redundant"!==o.state)return;e(i.e.create(c.codes.SW_REG_REDUNDANT))}o.removeEventListener("statechange",n)};o.addEventListener("statechange",n)}else e(i.e.create(c.codes.SW_REG_REDUNDANT));else t(r);else e(i.e.create(c.codes.NO_SW_IN_REG))})},t.prototype._=function(){var e=this;return this.b?this.v(this.b):(this.b=null,navigator.serviceWorker.register(C,{scope:_}).catch(function(t){throw e.e.create(c.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(t){return e.v(t).then(function(){return(e.b=t).update(),t})}))},t.prototype.l=function(){var r=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(t){if(t.data&&t.data[m.TYPE_OF_MSG]){var e=t.data;switch(e[m.TYPE_OF_MSG]){case E.PUSH_MSG_RECEIVED:case E.NOTIFICATION_CLICKED:var n=e[m.DATA];r.d.next(n)}}},!1)},t.prototype.g=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},t}(y),S=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),O=function(n){function t(t){var e=n.call(this,t)||this;return self.addEventListener("push",function(t){return e.I(t)},!1),self.addEventListener("pushsubscriptionchange",function(t){return e.m(t)},!1),self.addEventListener("notificationclick",function(t){return e.y(t)},!1),e.N=null,e}return S(t,n),t.prototype.I=function(t){var r,i=this;try{r=t.data.json()}catch(t){return}var e=this.w().then(function(t){if(t){if(r.notification||i.N)return i.k(r)}else{var e=i.O(r);if(e){var n=e.title||"";return self.registration.showNotification(n,e)}if(i.N)return i.N(r)}});t.waitUntil(e)},t.prototype.m=function(t){var r=this,e=this.getToken().then(function(t){if(!t)throw r.e.create(c.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var e=null,n=r.getTokenManager();return n.getTokenDetailsFromToken(t).then(function(t){if(!(e=t))throw r.e.create(c.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(p.SUBSCRIPTION_OPTIONS)}).then(function(t){return n.subscribeToFCM(e.fcmSenderId,t,e.fcmPushSet)}).catch(function(t){return n.deleteToken(e.fcmToken).then(function(){throw r.e.create(c.codes.UNABLE_TO_RESUBSCRIBE,{message:t})})})});t.waitUntil(e)},t.prototype.y=function(t){var n=this;if(t.notification&&t.notification.data&&t.notification.data.FCM_MSG){t.stopImmediatePropagation(),t.notification.close();var r=t.notification.data.FCM_MSG,e=r.notification.click_action;if(e){var i=this.D(e).then(function(t){return t||self.clients.openWindow(e)}).then(function(t){if(t){r.notification,delete r.notification;var e=b(E.NOTIFICATION_CLICKED,r);return n.A(t,e)}});t.waitUntil(i)}}},t.prototype.O=function(t){if(t&&"object"==typeof t.notification){var e,n=Object.assign({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}},t.prototype.setBackgroundMessageHandler=function(t){if(t&&"function"!=typeof t)throw this.e.create(c.codes.BG_HANDLER_FUNCTION_EXPECTED);this.N=t},t.prototype.D=function(t){var r=new URL(t).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){for(var e=null,n=0;n<t.length;n++)if(new URL(t[n].url).href===r){e=t[n];break}if(e)return e.focus(),e})},t.prototype.A=function(n,r){var i=this;return new Promise(function(t,e){if(!n)return e(i.e.create(c.codes.NO_WINDOW_CLIENT_TO_MSG));n.postMessage(r),t()})},t.prototype.w=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){return t.some(function(t){return"visible"===t.visibilityState})})},t.prototype.k=function(n){var r=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){var e=b(E.PUSH_MSG_RECEIVED,n);return Promise.all(t.map(function(t){return r.A(t,e)}))})},t.prototype._=function(){return Promise.resolve(self.registration)},t}(y),P=n(6);(e.registerMessaging=r)(P.firebase)}},[116])}catch(t){throw Error("Cannot instantiate firebase-messaging.js - be sure to load firebase-app.js first.")}if(void 0===firebase)throw new Error("hosting/init-error: Firebase SDK not detected. You must include it before /__/firebase/init.js");firebase.initializeApp({apiKey:"AIzaSyBHQjxlE2uaJ0janHVGUMsXpPGggkh-XrQ",databaseURL:"https://fengerzhcom.firebaseio.com",storageBucket:"fengerzhcom.appspot.com",authDomain:"fengerzhcom.firebaseapp.com",messagingSenderId:"84597767663",projectId:"fengerzhcom"}),function(){"use strict";var t=document.querySelector(".post-content"),p=document.querySelector(".progress-bar");if(t&&p){var f=0,d=t.scrollHeight,v=p.querySelector(".completed"),y=p.querySelector(".remaining"),g=p.querySelector(".time-completed"),m=p.querySelector(".time-remaining");document.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop;if(p.style.bottom=f<t?"0%":"-100%",t<=d){var e=t/d,n=(100*e).toFixed(2),r=100-parseFloat(n);v.style.width=n.toString()+"%",y.style.width=r.toString()+"%";var i=60*parseInt(p.getAttribute("data-minutes")),o=parseInt(e*i),s=parseInt(o/60),a=parseInt(60*(o/60-s)),u=i-o,c=parseInt(u/60),h=parseInt(60*(u/60-c));s=s<10?"0"+s:s,a=a<10?"0"+a:a,c=c<10?"0"+c:c,h=h<10?"0"+h:h,g.innerText=s+":"+a,m.innerText=c+":"+h}else{v.style.width="100%",y.style.width="0%";var l=parseInt(p.getAttribute("data-minutes"));l=l<10?"0"+l:l,g.innerText="00:00",m.innerText=l+":00"}f=t})}}(),function(r){"use strict";var n=r.document.documentElement;function s(){var t=n.clientHeight,e=r.innerHeight;return t<e?e:t}function a(){return r.pageYOffset||n.scrollTop}function i(t,e){var n=t.offsetHeight,r=a(),i=r+s(),o=function(t){for(var e=0,n=0;isNaN(t.offsetTop)||(e+=t.offsetTop),isNaN(t.offsetLeft)||(n+=t.offsetLeft),t=t.offsetParent;);return{top:e,left:n}}(t).top;return o+n*(e=e||0)<=i&&r<=o+n-n*e}function o(t){if(t){var e=new Image;e.onload=function(){t.src=e.src},e.src=t.getAttribute("data-url")}}function t(t,e){this.el=t,this.options=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.defaults,e),this._init()}t.prototype={defaults:{minDuration:0,maxDuration:0,viewportFactor:0},_init:function(){this.items=Array.prototype.slice.call(document.querySelectorAll("#"+this.el.id+" > article")),this.itemsCount=this.items.length,this.itemsRenderedCount=0,this.didScroll=!1;var n=this;n.items.forEach(function(t,e){i(t)&&(n._checkTotalRendered(),classie.add(t,"shown"),o(t.querySelector(".preload")))}),r.addEventListener("scroll",function(){n._onScrollFn()},!1),r.addEventListener("resize",function(){n._resizeHandler()},!1)},_onScrollFn:function(){var t=this;this.didScroll||(this.didScroll=!0,setTimeout(function(){t._scrollPage()},60))},_scrollPage:function(){var r=this;this.items.forEach(function(n,t){classie.has(n,"shown")||classie.has(n,"animate")||!i(n,r.options.viewportFactor)||setTimeout(function(){var t=a()+s()/2;if(r.el.style.WebkitPerspectiveOrigin="50% "+t+"px",r.el.style.MozPerspectiveOrigin="50% "+t+"px",r.el.style.perspectiveOrigin="50% "+t+"px",r._checkTotalRendered(),r.options.minDuration&&r.options.maxDuration){var e=Math.random()*(r.options.maxDuration-r.options.minDuration)+r.options.minDuration+"s";n.style.WebkitAnimationDuration=e,n.style.MozAnimationDuration=e,n.style.animationDuration=e}classie.add(n,"animate"),o(n.querySelector(".preload"))},25)}),this.didScroll=!1},_resizeHandler:function(){var t=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t._scrollPage(),t.resizeTimeout=null},1e3)},_checkTotalRendered:function(){++this.itemsRenderedCount,this.itemsRenderedCount===this.itemsCount&&r.removeEventListener("scroll",this._onScrollFn)}},r.AnimOnScroll=t}(window),function(c){c.fn.simpleJekyllSearch=function(t){var i=c.extend({jsonFile:"/search.json",jsonFormat:"title,tags,categories,url,date",template:'<li><article><a href="{url}"><span class="entry-category">{categories}</span> {title} <span class="entry-date"><time datetime="{date}">{date}</time></span></a></article></li>',searchResults:".search-results",limit:"10",noResults:"<p>Puuuts! Não encontramos nada :(</p>"},t),o=i.jsonFormat.split(","),s=[],r=this,a=c(i.searchResults);function u(){a.children().remove()}i.jsonFile.length&&a.length&&c.ajax({type:"GET",url:i.jsonFile,dataType:"json",success:function(t,e,n){s=t,r.keyup(function(t){c(this).val().length?function(t){u(),a.append(c(i.searchResultsTitle)),t.length?c.each(t,function(t,e){if(t<i.limit){for(var n=i.template,t=0;t<o.length;t++){var r=new RegExp("{"+o[t]+"}","g");n=n.replace(r,e[o[t]])}a.append(c(n))}}):a.append(i.noResults)}(function(n){var r=[];return c.each(s,function(t,e){for(t=0;t<o.length;t++)void 0!==e[o[t]]&&-1!==e[o[t]].toLowerCase().indexOf(n.toLowerCase())&&(r.push(e),t=o.length)}),r}(c(this).val())):u()})},error:function(t,e,n){console.log("***ERROR in simpleJekyllSearch.js***"),console.log(t),console.log(e),console.log(n)}})}}(Zepto),function(t,e){"function"==typeof define&&define.amd?define([],e(t)):"object"==typeof exports?module.exports=e(t):t.smoothScroll=e(t)}("undefined"!=typeof global?global:this.window||this.global,function(v){"use strict";var n,e,y,g,r={},i="querySelector"in document&&"addEventListener"in v,m={selector:"[data-scroll]",selectorHeader:"[data-scroll-header]",speed:500,easing:"easeInOutCubic",offset:0,updateURL:!0,callback:function(){}},E=function(){var n={},r=!1,t=0,e=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(r=arguments[0],t++);for(var i=function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r&&"[object Object]"===Object.prototype.toString.call(t[e])?n[e]=E(!0,n[e],t[e]):n[e]=t[e])};t<e;t++){i(arguments[t])}return n},b=function(t){return null===t?0:function(t){return Math.max(t.scrollHeight,t.offsetHeight,t.clientHeight)}(t)+t.offsetTop};r.animateScroll=function(i,o,t){var e=function(t){return t&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(t):{}}(i?i.getAttribute("data-options"):null),s=E(s||m,t||{},e),a="#"===(o="#"+function(t){for(var e,n=String(t),r=n.length,i=-1,o="",s=n.charCodeAt(0);++i<r;){if(0===(e=n.charCodeAt(i)))throw new InvalidCharacterError("Invalid character: the input contains U+0000.");o+=1<=e&&e<=31||127==e||0===i&&48<=e&&e<=57||1===i&&48<=e&&e<=57&&45===s?"\\"+e.toString(16)+" ":128<=e||45===e||95===e||48<=e&&e<=57||65<=e&&e<=90||97<=e&&e<=122?n.charAt(i):"\\"+n.charAt(i)}return o}(o.substr(1)))?v.document.documentElement:v.document.querySelector(o),n=v.pageYOffset;y||(y=v.document.querySelector(s.selectorHeader)),g||(g=b(y));var r,u,c,h=function(t,e,n){var r=0;if(t.offsetParent)for(;r+=t.offsetTop,t=t.offsetParent;);return 0<=(r=r-e-n)?r:0}(a,g,parseInt(s.offset,10)),l=h-n,p=Math.max(v.document.body.scrollHeight,v.document.documentElement.scrollHeight,v.document.body.offsetHeight,v.document.documentElement.offsetHeight,v.document.body.clientHeight,v.document.documentElement.clientHeight),f=0;!function(t,e){v.history.pushState&&(e||"true"===e)&&"file:"!==v.location.protocol&&v.history.pushState(null,null,[v.location.protocol,"//",v.location.host,v.location.pathname,v.location.search,t].join(""))}(o,s.updateURL);var d=function(){u=1<(u=(f+=16)/parseInt(s.speed,10))?1:u,c=n+l*function(t,e){var n;return"easeInQuad"===t&&(n=e*e),"easeOutQuad"===t&&(n=e*(2-e)),"easeInOutQuad"===t&&(n=e<.5?2*e*e:(4-2*e)*e-1),"easeInCubic"===t&&(n=e*e*e),"easeOutCubic"===t&&(n=--e*e*e+1),"easeInOutCubic"===t&&(n=e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1),"easeInQuart"===t&&(n=e*e*e*e),"easeOutQuart"===t&&(n=1- --e*e*e*e),"easeInOutQuart"===t&&(n=e<.5?8*e*e*e*e:1-8*--e*e*e*e),"easeInQuint"===t&&(n=e*e*e*e*e),"easeOutQuint"===t&&(n=1+--e*e*e*e*e),"easeInOutQuint"===t&&(n=e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e),n||e}(s.easing,u),v.scrollTo(0,Math.floor(c)),function(t,e,n){var r=v.pageYOffset;(t==e||r==e||v.innerHeight+r>=p)&&(clearInterval(n),a.focus(),s.callback(i,o))}(c,h,r)};0===v.pageYOffset&&v.scrollTo(0,0),r=setInterval(d,16)};var o=function(t){var e=function(t,e){var n,r,i=e.charAt(0),o="classList"in document.documentElement;for("["===i&&1<(n=(e=e.substr(1,e.length-2)).split("=")).length&&(r=!0,n[1]=n[1].replace(/"/g,"").replace(/'/g,""));t&&t!==document;t=t.parentNode){if("."===i)if(o){if(t.classList.contains(e.substr(1)))return t}else if(new RegExp("(^|\\s)"+e.substr(1)+"(\\s|$)").test(t.className))return t;if("#"===i&&t.id===e.substr(1))return t;if("["===i&&t.hasAttribute(n[0])){if(!r)return t;if(t.getAttribute(n[0])===n[1])return t}if(t.tagName.toLowerCase()===e)return t}return null}(t.target,n.selector);e&&"a"===e.tagName.toLowerCase()&&(t.preventDefault(),r.animateScroll(e,e.hash,n))},s=function(t){e||(e=setTimeout(function(){e=null,g=b(y)},66))};return r.destroy=function(){n&&(v.document.removeEventListener("click",o,!1),v.removeEventListener("resize",s,!1),g=y=e=n=null)},r.init=function(t){i&&(r.destroy(),n=E(m,t||{}),y=v.document.querySelector(n.selectorHeader),g=b(y),v.document.addEventListener("click",o,!1),y&&v.addEventListener("resize",s,!1))},r}),function(){for(var t=document.links,e=0,n=t.length;e<n;e++)t[e].hostname!=window.location.hostname&&(t[e].target="_blank",t[e].rel="noopener")}(),function(e,n,t){e("#menu").click(function(){e("body").addClass("push-menu-to-right"),e("#sidebar").addClass("open"),e(".overlay").addClass("show")}),e("#mask").click(function(){e("body").removeClass("push-menu-to-right"),e("#sidebar").removeClass("open"),e(".overlay").removeClass("show")});var r={close:e(".icon-remove-sign"),searchform:e(".search-form"),canvas:e("body"),dothis:e(".dosearch")};function i(){e(".search-wrapper").toggleClass("active"),r.searchform.toggleClass("active"),r.canvas.removeClass("search-overlay")}r.dothis.on("click",function(){e(".search-wrapper").toggleClass("active"),r.searchform.toggleClass("active"),r.searchform.find("input").focus(),r.canvas.toggleClass("search-overlay"),e(".search-field").simpleJekyllSearch()}),r.close.on("click",i),document.addEventListener("keyup",function(t){27==t.keyCode&&e(".search-overlay").length&&i()}),1<=document.getElementsByClassName("home").length&&new AnimOnScroll(document.getElementById("grid"),{minDuration:.4,maxDuration:.7,viewportFactor:.2}),smoothScroll.init({selectorHeader:".bar-header",speed:500,updateURL:!1}),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js");var o=firebase.messaging();o.requestPermission().then(function(){o.getToken().then(function(t){t?1!=n.localStorage.getItem("firebaseTokenSentToServer")&&(firebase.database().ref("messagetokens").push().set(t),n.localStorage.setItem("firebaseTokenSentToServer",1)):n.localStorage.setItem("firebaseTokenSentToServer",0)}).catch(function(t){n.localStorage.setItem("firebaseTokenSentToServer",0)})}).catch(function(t){console.log("Unable to get permission to notify.",t)})}(Zepto,window);